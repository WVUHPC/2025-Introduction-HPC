<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to HPC: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png">
<link rel="manifest" href="favicons/incubator/site.webmanifest">
<link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Introduction to High-Performance Computing" src="assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Introduction to High-Performance Computing" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to HPC
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to HPC
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to HPC
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="102-cli.html">1. Command Line Interface: The Shell</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="201-editors.html">2. Terminal-based Text Editors: nano, emacs and vim</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="202-software.html">3. Software on HPC Clusters: modules, conda and containers</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="301-slurm.html">4. Workload Manager: Slurm</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="302-tmux.html">5. Terminal Multiplexing: tmux</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-102-cli"><p>Content from <a href="102-cli.html">Command Line Interface: The Shell</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/102-cli.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“How do I use the Linux terminal?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Learn the most basic UNIX/Linux commands”</li>
<li>“Learn how to navigate the filesystem”</li>
<li>“Creating, moving, and removing files/directories”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="command-line-interface">Command Line Interface<a class="anchor" aria-label="anchor" href="#command-line-interface"></a>
</h2>
<hr class="half-width">
<p>At a high level, an HPC cluster is just a bunch of computers that
appear to the user like a single entity to execute calculations. A
machine where several users can work simultaneously. The users expect to
run a variety of scientific codes. To do that, users store the data
needed as input, and at the end of the calculations, the data generated
as output is also stored or used to create plots and tables via
postprocessing tools and scripts. In HPC, compute nodes can communicate
with each other very efficiently. For some calculations that are too
demanding for a single computer, several computers could work together
on a single calculation, eventually sharing information.</p>
<p>Our daily interactions with regular computers like desktop computers
and laptops occur via various devices, such as the keyboard and mouse,
touch screen interfaces, or the microphone when using speech recognition
systems. Today, we are very used to interact with computers graphically,
tablets, and phones, the GUI is widely used to interact with them.
Everything takes place with graphics. You click on icons, touch buttons,
or drag and resize photos with your fingers.</p>
<p>However, in HPC, we need an efficient and still very light way of
communicating with the computer that acts as the front door of the
cluster, the <strong>login node</strong>. We use the
<strong>shell</strong> instead of a <strong>graphical user
interface</strong> (GUI) for interacting with the HPC cluster.</p>
<p>In the GUI, we give instructions using a keyboard, mouse, or
touchscreen. This way of interacting with a computer is intuitive and
very easy to learn but scales very poorly for large streams of
instructions, even if they are similar or identical. All that is very
convenient but that is now how we use HPC clusters.</p>
<p>Later on in this lesson, we will show how to use Open On-demand, a
web service that allows you to run interactive executions on the cluster
using a web interface and your browser. For most of this lesson, we will
use the Command Line Interface, and you need to familiarize yourself
with it.</p>
<p>For example, you need to copy the third line of each of a thousand
text files stored in a thousand different folders and paste it into a
single file line by line. Using the traditional GUI approach of mouse
clicks will take several hours to do this.</p>
<p>This is where we take advantage of the shell - a <strong>command-line
interface</strong> (CLI) to make such repetitive tasks with less effort.
It can take a single instruction and repeat it as is or with some
modification as many times as we want. The task in the example above can
be accomplished in a single line of a few instructions.</p>
<p>The heart of a command-line interface is a
<strong>read-evaluate-print loop</strong> (REPL) so, called because when
you type a command and press <kbd>Return</kbd> (also known as
<kbd>Enter</kbd>), the shell reads your command, evaluates (or
“executes”) it, prints the output of your command, loops back and waits
for you to enter another command. The REPL is essential in how we
interact with HPC clusters.</p>
<p>Even if you are using a GUI frontend such as <em>Jupyter</em> or
<em>RStudio</em>, REPL is there for us to instruct computers on what to
do next.</p>
<div class="section level3">
<h3 id="the-shell">The Shell<a class="anchor" aria-label="anchor" href="#the-shell"></a>
</h3>
<p>The Shell is a program that runs other programs rather than doing
calculations itself. Those programs can be as complicated as climate
modeling software and as simple as a program that creates a new
directory. The simple programs which are used to perform stand-alone
tasks are usually referred to as commands. The most popular Unix shell
is Bash (the Bourne Again SHell — so-called because it’s derived from a
shell written by Stephen Bourne). Bash is the default shell on most
modern implementations of Unix and in most packages that provide
Unix-like tools for Windows.</p>
<p>When the shell is first opened, you are presented with a
<strong>prompt</strong>, indicating that the shell is waiting for
input.</p>
<pre><code>~$</code></pre>
<p>The shell we will use for this lessos will be shown as
<code>~$</code>. Notice that the prompt may be customized by the user to
have more information such as date, user, host, current working
directory and many other pieces of information. For example you can see
my prompt as <code>22:16:00-gufranco@trcis001:~$</code>.</p>
<div id="the-prompt" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="the-prompt" class="callout-inner">
<h3 class="callout-title">The prompt</h3>
<div class="callout-content">
<p>When typing commands from these lessons or other sources, <em>do not
type the prompt</em>, only the commands that follow it.</p>
<pre><code>~$ ls -al</code></pre>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="why-use-the-command-line-interface">Why use the Command Line Interface?<a class="anchor" aria-label="anchor" href="#why-use-the-command-line-interface"></a>
</h3>
<p>Before the usage of <strong>Command Line Interface</strong> (CLI),
computer interaction took place with perforated cards or even switching
cables on a big console. Despite all the years of new technology and
innovation, the mouse, touchscreens and voice recognition; the CLI
remains one of the most powerful and flexible tools for interacting with
computers.</p>
<p>Because it is radically different from a GUI, the CLI can take some
effort and time to learn. A GUI presents you with choices to click on.
With a CLI, the choices are combinations of commands and parameters,
more akin to words in a language than buttons on a screen. Because the
options are not presented to you, some vocabulary is necessary in this
new “language.” But a small number of commands gets you a long way, and
we’ll cover those essential commands below.</p>
</div>
<div class="section level3">
<h3 id="flexibility-and-automation">Flexibility and automation<a class="anchor" aria-label="anchor" href="#flexibility-and-automation"></a>
</h3>
<p>The grammar of a shell allows you to combine existing tools into
powerful pipelines and handle large volumes of data automatically.
Sequences of commands can be written into a <em>script</em>, improving
the reproducibility of workflows and allowing you to repeat them
easily.</p>
<p>In addition, the command line is often the easiest way to interact
with remote machines and supercomputers. Familiarity with the shell is
essential to run a variety of specialized tools and resources including
high-performance computing systems. As clusters and cloud computing
systems become more popular for scientific data crunching, being able to
interact with the shell is becoming a necessary skill. We can build on
the command-line skills covered here to tackle a wide range of
scientific questions and computational challenges.</p>
</div>
</section><section><h2 class="section-heading" id="starting-with-the-shell">Starting with the shell<a class="anchor" aria-label="anchor" href="#starting-with-the-shell"></a>
</h2>
<hr class="half-width">
<p>If you still need to download the hands-on materials. This is the
perfect opportunity to do so</p>
<pre><code>~$ git clone https://github.com/WVUHPC/workshops_hands-on.git</code></pre>
<p>Let’s look at what is inside the <code>workshops_hands-on</code>
folder and explore it further. First, instead of clicking on the folder
name to open it and look at its contents, we have to change the folder
we are in. When working with any programming tools, <strong>folders are
called directories</strong>. We will be using folder and directory
interchangeably moving forward.</p>
<p>To look inside the <code>workshops_hands-on</code> directory, we need
to change which directory we are <em>in</em>. To do this, we can use the
<code>cd</code> command, which stands for “change directory”.</p>
<pre><code>~$ cd workshops_hands-on</code></pre>
<p>Did you notice a change in your command prompt? The “~” symbol from
before should have been replaced by the string
<code>~/workshops_hands-on$</code>. This means our <code>cd</code>
command ran successfully, and we are now <em>in</em> the new directory.
Let’s see what is in here by listing the contents:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">~$</span> ls</span></code></pre>
</div>
<p>You should see:</p>
<pre><code>Introduction_HPC  LICENSE  Parallel_Computing  README.md  Scientific_Programming  Spark</code></pre>
<div class="section level3">
<h3 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h3>
<p>Six items are listed when you run <code>ls</code>, but what types of
files are they, or are they directories or files?</p>
<p>To get more information, we can modify the default behavior of
<code>ls</code> with one or more <strong>“arguments”</strong>.</p>
<pre><code>~$ ls -F

Introduction_HPC/  LICENSE  Parallel_Computing/  README.md  Scientific_Programming/  Spark/</code></pre>
<p>Anything with a “/” after its name is a directory. Things with an
asterisk “*” after them are programs. If there are no “decorations”
after the name, it’s a regular text file.</p>
<p>You can also use the argument <code>-l</code> to show the directory
contents in a long-listing format that provides a lot more
information:</p>
<pre><code>~$ ls -l</code></pre>
<pre><code>total 64
drwxr-xr-x 13 gufranco its-rc-thorny  4096 Jul 23 22:50 Introduction_HPC
-rw-r--r--  1 gufranco its-rc-thorny 35149 Jul 23 22:50 LICENSE
drwxr-xr-x  6 gufranco its-rc-thorny  4096 Jul 23 22:50 Parallel_Computing
-rw-r--r--  1 gufranco its-rc-thorny   715 Jul 23 22:50 README.md
drwxr-xr-x  9 gufranco its-rc-thorny  4096 Jul 23 22:50 Scientific_Programming
drwxr-xr-x  2 gufranco its-rc-thorny  4096 Jul 23 22:50 Spark</code></pre>
<p>Each line of output represents a file or a directory. The directory
lines start with <code>d</code>. If you want to combine the two
arguments <code>-l</code> and <code>-F</code>, you can do so by saying
the following:</p>
<pre><code>~$ ls -lF</code></pre>
<p>Do you see the modification in the output?</p>
<div id="details" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="details" class="callout-inner">
<h3 class="callout-title">Details</h3>
<div class="callout-content">
<p>Notice that the listed directories now have <code>/</code> at the end
of their names.</p>
</div>
</div>
</div>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p><strong>Tip</strong> - <strong>All commands are essentially
programs</strong> that are able to perform specific, commonly-used
tasks.</p>
<p>Most commands will take additional arguments controlling their
behavior, and some will take a file or directory name as input. How do
we know what the available arguments that go with a particular command
are? Most commonly used shell commands have a manual available in the
shell. You can access the manual using the <code>man</code> command.
Let’s try this command with <code>ls</code>:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">$</span> man ls</span></code></pre>
</div>
<p>This will open the manual page for <code>ls</code>, and you will lose
the command prompt. It will bring you to a so-called “buffer” page, a
page you can navigate with your mouse, or if you want to use your
keyboard, we have listed some basic keystrokes: * ‘spacebar’ to go
forward * ‘b’ to go backward * Up or down arrows to go forward or
backward, respectively</p>
<p><strong>To get out of the <code>man</code> “buffer” page and to be
able to type commands again on the command prompt, press the
<code>q</code> key!</strong></p>
</div>
</div>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<ul>
<li>Open up the manual page for the <code>find</code> command. Skim
through some of the information.
<ul>
<li>Would you be able to learn this much information about many commands
by heart?</li>
<li>Do you think this format of information display is useful for
you?</li>
</ul>
</li>
<li>Quit the <code>man</code> buffer (using the key <code>q</code>) and
return to your command prompt.</li>
</ul>
<blockquote>
<p><strong>Tip</strong> - Shell commands can get extremely complicated.
No one can learn all of these arguments, of course. So you will likely
refer to the manual page frequently.</p>
<p><strong>Tip</strong> - If the manual page within the Terminal is hard
to read and traverse, the manual exists online, too. Use your
web-searching powers to get it! In addition to the arguments, you can
also find good examples online; <strong><em>Google is your
friend.</em></strong></p>
</blockquote>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<pre><code>~$ man find</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="the-unix-directory-file-structure-a-k-a--where-am-i">The Unix directory file structure (a.k.a. where am I?)<a class="anchor" aria-label="anchor" href="#the-unix-directory-file-structure-a-k-a--where-am-i"></a>
</h2>
<hr class="half-width">
<p>Let’s practice moving around a bit. Let’s go into the
<code>Introduction_HPC</code> directory and see what is there.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">$</span> cd Introduction_HPC</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-l</span></span></code></pre>
</div>
<p>Great, we have traversed some sub-directories, but where are we in
the context of our pre-designated “home” directory containing the
<code>workshops_hands-on</code> directory?!</p>
<div class="section level3">
<h3 id="the-root-directory">The “root” directory!<a class="anchor" aria-label="anchor" href="#the-root-directory"></a>
</h3>
<p>Like on any computer you have used before, the file structure within
a Unix/Linux system is hierarchical, like an upside-down tree with the
“/” directory, called “root” as the starting point of this tree-like
structure:</p>
<figure><img src="fig/File_Tree.png" alt="File Tree" class="figure mx-auto d-block"><div class="figcaption">File Tree</div>
</figure><blockquote>
<p><strong>Tip</strong> - Yes, the root folder’s actual name is just
<strong><code>/</code></strong> (a forward slash).</p>
</blockquote>
<p>That <code>/</code> or root is the ‘top’ level.</p>
<p>When you log in to a remote computer, you land on one of the branches
of that tree, i.e., your pre-designated “home” directory that usually
has your login name as its name (e.g. <code>/users/gufranco</code>).</p>
<blockquote>
<p><strong>Tip</strong> - On macOS, which is a UNIX-based OS, the root
level is also “/”.</p>
<p><strong>Tip</strong> - On a Windows OS, it is drive-specific; “C:" is
considered the default root, but it changes to”D:", if you are on
another drive.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="paths">Paths<a class="anchor" aria-label="anchor" href="#paths"></a>
</h3>
<p>Now let’s learn more about the “addresses” of directories, called
<strong>“path”</strong>, and move around the file system.</p>
<p>Let’s check to see what directory we are in. The command prompt tells
us which directory we are in, but it doesn’t give information about
where the <code>Introduction_HPC</code> directory is with respect to our
“home” directory or the <code>/</code> directory.</p>
<p>The command to check our current location is <code>pwd</code>. This
command does not take any arguments, and it returns the path or address
of your <strong>p</strong>resent <strong>w</strong>orking
<strong>d</strong>irectory (the folder you are in currently).</p>
<pre><code>~$ pwd</code></pre>
<p>In the output here, each folder is separated from its “parent” or
“child” folder by a “/”, and the output starts with the root
<code>/</code> directory. So, you are now able to determine the location
of <code>Introduction_HPC</code> directory relative to the root
directory!</p>
<p>But which is your pre-designated home folder? No matter where you
have navigated to in the file system, just typing in <code>cd</code>
will bring you to your home directory.</p>
<pre><code>~$ cd</code></pre>
<p>What is your present working directory now?</p>
<pre><code>~$ pwd</code></pre>
<p>This should now display a shorter string of directories starting with
root. This is the full address to your home directory, also referred to
as “<strong>full path</strong>”. <strong>The “full” here refers to the
fact that the path starts with the root, which means you know which
branch of the tree you are on in reference to the root.</strong></p>
<p>Take a look at your command prompt now. Does it show you the name of
this directory (your username?)?</p>
<p><em>No, it doesn’t. Instead of the directory name, it shows you a
<code>~</code>.</em></p>
<p>Why is this so?</p>
<p><em>This is because <code>~</code> = full path to the home directory
for the user.</em></p>
<p>Can we just type <code>~</code> instead of
<code>/users/username</code>?</p>
<p><em>Yes, we can!</em></p>
<div class="section level4">
<h4 id="using-paths-with-commands">Using paths with commands<a class="anchor" aria-label="anchor" href="#using-paths-with-commands"></a>
</h4>
<p>You can do much more with the idea of stringing together
<em>parent/child</em> directories. Let’s say we want to look at the
contents of the <code>Introduction_HPC</code> folder but do it from our
current directory (the home directory. We can use the list command and
follow it up with the path to the folder we want to list!</p>
<pre><code>~$ cd

~$ ls -l ~/workshops_hands-on/Introduction_HPC</code></pre>
<p>Now, what if we wanted to change directories from <code>~</code>
(home) to <code>Introduction_HPC</code> in a single step?</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">~$</span> cd ~/workshops_hands-on/Introduction_HPC</span></code></pre>
</div>
<p>Done! You have moved two levels of directories in one command.</p>
<p>What if we want to move back up and out of the
<code>Introduction_HPC</code> directory? Can we just type
<code>cd workshops_hands-on</code>? Try it and see what happens.</p>
<p><em>Unfortunately, that won’t work because when you say
<code>cd workshops_hands-on</code>, shell is looking for a folder called
<code>workshops_hands-on</code> within your current directory,
i.e. <code>Introduction_HPC</code>.</em></p>
<p>Can you think of an alternative?</p>
<p><em>You can use the full path to workshops_hands-on!</em></p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">$</span> cd ~/workshops_hands-on</span></code></pre>
</div>
<blockquote>
<p><strong>Tip</strong> What if we want to navigate to the previous
folder but can’t quite remember the full or relative path, or want to
get there quickly without typing a lot? In this case, we can use
<code>cd -</code>. When <code>-</code> is used in this context it is
referring to a special variable called <code>$OLDPWD</code> that is
stored without our having to assign it anything. We’ll learn more about
variables in a future lesson, but for now you can see how this command
works. Try typing:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="bu">cd</span> <span class="at">-</span></span></code></pre>
</div>
<p>This command will move you to the last folder you were in before your
current location, then display where you now are! If you followed the
steps up until this point it will have moved you to
<code>~/workshops_hands-on/Introduction_HPC</code>. You can use this
command again to get back to where you were before
(<code>~/workshops_hands-on</code>) to move on to the Exercises.</p>
</blockquote>
<hr>
<p><strong>Exercises</strong></p>
<ol style="list-style-type: decimal">
<li>First, move to your home directory.</li>
<li>Then, list the contents of the <code>Parallel_Computing</code>
directory within the <code>workshops_hands-on</code> directory.</li>
</ol>
<hr>
</div>
<div class="section level4">
<h4 id="tab-completion">Tab completion<a class="anchor" aria-label="anchor" href="#tab-completion"></a>
</h4>
<p>Typing out full directory names can be time-consuming and
error-prone. One way to avoid that is to use <strong>tab
completion</strong>. The <code>tab</code> key is located on the left
side of your keyboard, right above the <code>caps lock</code> key. When
you start typing out the first few characters of a directory name, then
hit the <code>tab</code> key, Shell will try to fill in the rest of the
directory name.</p>
<p>For example, first type <code>cd</code> to get back to your home
directly, then type <code>cd uni</code>, followed by pressing the
<code>tab</code> key:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">$</span> cd</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="ex">$</span> cd work<span class="op">&lt;</span>tab<span class="op">&gt;</span></span></code></pre>
</div>
<p>The shell will fill in the rest of the directory name for
<code>workshops_hands-on</code>.</p>
<p>Now, let’s go into <code>Introduction_HPC</code>, then type
<code>ls 1</code>, followed by pressing the <code>tab</code> key
once:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">$</span> cd Introduction_HPC/</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="ex">$</span> ls <span class="dv">1</span><span class="op">&lt;</span>tab<span class="op">&gt;</span></span></code></pre>
</div>
<p><strong>Nothing happens!!</strong></p>
<p>The reason is that there are multiple files in the
<code>Introduction_HPC</code> directory that start with <code>1</code>.
As a result, shell needs to know which one to fill in. When you hit
<code>tab</code> a second time again, the shell will then list all the
possible choices.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">$</span> ls <span class="dv">1</span><span class="op">&lt;</span>tab<span class="op">&gt;&lt;</span>tab<span class="op">&gt;</span></span></code></pre>
</div>
<p>Now you can select the one you are interested in listed, enter the
number, and hit the tab again to fill in the complete name of the
file.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">$</span> ls 15._Shell<span class="op">&lt;</span>tab<span class="op">&gt;</span></span></code></pre>
</div>
<blockquote>
<p><strong>NOTE:</strong> Tab completion can also fill in the names of
commands. For example, enter <code>e&lt;tab&gt;&lt;tab&gt;</code>. You
will see the name of every command that starts with an <code>e</code>.
One of those is <code>echo</code>. If you enter
<code>ech&lt;tab&gt;</code>, you will see that tab completion works.</p>
</blockquote>
<p><strong>Tab completion is your friend!</strong> It helps prevent
spelling mistakes and speeds up the process of typing in the full
command. We encourage you to use this when working on the command
line.</p>
</div>
<div class="section level4">
<h4 id="relative-paths">Relative paths<a class="anchor" aria-label="anchor" href="#relative-paths"></a>
</h4>
<p>We have talked about <strong>full</strong> paths so far, but there is
a way to specify paths to folders and files without having to worry
about the root directory. You used this before when we were learning
about the <code>cd</code> command.</p>
<p>Let’s change directories back to our home directory and once more
change directories from <code>~</code> (home) to
<code>Introduction_HPC</code> in a single step. (<em>Feel free to use
your tab-completion to complete your path!</em>)</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">$</span> cd</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="ex">$</span> cd workshops_hands-on/Introduction_HPC</span></code></pre>
</div>
<p>This time we are not using the <code>~/</code> before
<code>workshops_hands-on</code>. In this case, we are using a relative
path, relative to our current location - wherein we know that
<code>workshops_hands-on</code> is a child folder in our home folder,
and the <code>Introduction_HPC</code> folder is within
<code>workshops_hands-on</code>.</p>
<blockquote>
<p>Previously, we had used the following:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">$</span> cd ~/workshops_hands-on/Introduction_HPC</span></code></pre>
</div>
</blockquote>
<p>There is also a handy shortcut for the relative path to a parent
directory, two periods <code>..</code>. Let’s say we wanted to move from
the <code>Introduction_HPC</code> folder to its parent folder.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="bu">cd</span> ..</span></code></pre>
</div>
<p>You should now be in the <code>workshops_hands-on</code> directory
(check the command prompt or run <code>pwd</code>).</p>
<blockquote>
<p>You will learn more about the <code>..</code> shortcut later. Can you
think of an example when this shortcut to the parent directory won’t
work?</p>
<details><summary>
Answer
</summary><p>
When you are at the root directory, since there is no parent to the root
directory!
</p>
</details>
</blockquote>
<p>When using relative paths, you might need to check what the branches
are downstream of the folder you are in. There is a really handy command
(<code>tree</code>) that can help you see the structure of any
directory.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="ex">$</span> tree</span></code></pre>
</div>
<p>If you are aware of the directory structure, you can string together
a list of directories as long as you like using either
<strong>relative</strong> or <strong>full</strong> paths.</p>
</div>
<div class="section level4">
<h4 id="synopsis-of-full-versus-relative-paths">Synopsis of Full versus Relative paths<a class="anchor" aria-label="anchor" href="#synopsis-of-full-versus-relative-paths"></a>
</h4>
<p><strong>A full path always starts with a <code>/</code>, a relative
path does not.</strong></p>
<p>A relative path is like getting directions from someone on the
street. They tell you to “go right at the Stop sign, and then turn left
on Main Street”. That works great if you’re standing there together, but
not so well if you’re trying to tell someone how to get there from
another country. A full path is like GPS coordinates. It tells you
exactly where something is, no matter where you are right now.</p>
<p>You can usually use either a full path or a relative path depending
on what is most convenient. If we are in the home directory, it is more
convenient to just enter the relative path since it involves less
typing.</p>
<p>Over time, it will become easier for you to keep a mental note of the
structure of the directories that you are using and how to quickly
navigate among them.</p>
</div>
</div>
</section><section><h2 class="section-heading" id="copying-creating-moving-and-removing-data">Copying, creating, moving, and removing data<a class="anchor" aria-label="anchor" href="#copying-creating-moving-and-removing-data"></a>
</h2>
<hr class="half-width">
<p>Now we can move around within the directory structure using the
command line. But what if we want to do things like copy files or move
them from one directory to another, rename them?</p>
<p>Let’s move into the <code>Introduction_HPC</code> directory, which
contains some more folders and files:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="bu">cd</span> ~/workshops_hands-on/Introduction_HPC</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="bu">cd</span> 2._Command_Line_Interface</span></code></pre>
</div>
<div class="section level3">
<h3 id="copying">Copying<a class="anchor" aria-label="anchor" href="#copying"></a>
</h3>
<p>Let’s use the copy (<code>cp</code>) command to make a copy of one of
the files in this folder, <code>Mov10_oe_1.subset.fq</code>, and call
the copied file <code>Mov10_oe_1.subset-copy.fq</code>. The copy command
has the following syntax:</p>
<p><code>cp  path/to/item-being-copied  path/to/new-copied-item</code></p>
<p>In this case the files are in our current directory, so we just have
to specify the name of the file being copied, followed by whatever we
want to call the newly copied file.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="ex">$</span> cp OUTCAR OUTCAR_BKP</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-l</span></span></code></pre>
</div>
<p>The copy command can also be used for copying over whole directories,
but the <code>-r</code> argument has to be added after the
<code>cp</code> command. The <code>-r</code> stands for “recursively
copy everything from the directory and its sub-directories”.</p>
<p>We used it earlier when we copied over the
<code>workshops_hands-on</code> directory to our home directories
#copying-example-data-folder).</p>
</div>
<div class="section level3">
<h3 id="creating">Creating<a class="anchor" aria-label="anchor" href="#creating"></a>
</h3>
<p>Next, let’s create a directory called <code>ABINIT</code> and we can
move the copy of the input files into that directory.</p>
<p>The <code>mkdir</code> command is used to make a directory, syntax:
<code>mkdir name-of-folder-to-be-created</code>.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="ex">$</span> mkdir ABINIT</span></code></pre>
</div>
<blockquote>
<p><strong>Tip</strong> - File/directory/program names with spaces in
them do not work well in Unix. Use characters like hyphens or
underscores instead. Using underscores instead of spaces is called
“snake_case”. Alternatively, some people choose to skip spaces and
rather just capitalize the first letter of each new word
(i.e. MyNewFile). This alternative technique is called “CamelCase”.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="moving">Moving<a class="anchor" aria-label="anchor" href="#moving"></a>
</h3>
<p>We can now move our copied input files into the new directory. We can
move files around using the move command, <code>mv</code>, syntax:</p>
<p><code>mv  path/to/item-being-moved  path/to/destination</code></p>
<p>In this case, we can use relative paths and just type the name of the
file and folder.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="ex">$</span> mv 14si.pspnc INCAR t17.files t17.in ABINIT/</span></code></pre>
</div>
<p>Let’s check if the move command worked like we wanted:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="ex">$</span> ls <span class="at">-l</span> ABINIT</span></code></pre>
</div>
<p>Let us run abinit, this is a quick execution, and you have not yet
learned how to submit jobs. So, for this exceptional time, we will
execute this on the login node</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="bu">cd</span> ABINIT</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="ex">$</span> module load atomistic/abinit/9.8.4_intel22_impi22 </span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="ex">$</span> mpirun <span class="at">-np</span> 4 abinit <span class="op">&lt;</span> t17.files </span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="renaming">Renaming<a class="anchor" aria-label="anchor" href="#renaming"></a>
</h3>
<p>The <code>mv</code> command has a second functionality, it is what
you would use to rename files, too. The syntax is identical to when we
used <code>mv</code> for moving, but this time instead of giving a
directory as its destination, we just give a new name as its
destination.</p>
<p>The files t17.out can be renamed, the ABINIT could run again with
some change in the input. We want to rename that file:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="ex">$</span> mv t17.out t17.backup.out</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="ex">$</span> ls</span></code></pre>
</div>
<blockquote>
<p><strong>Tip</strong> - You can use <code>mv</code> to move a file and
rename it simultaneously!</p>
</blockquote>
<p><strong>Important notes about <code>mv</code></strong>: * When using
<code>mv</code>, the shell will <strong>not</strong> ask if you are sure
that you want to “replace existing file” or similar unless you use the
-i option. * Once replaced, it is not possible to get the replaced file
back!</p>
</div>
<div class="section level3">
<h3 id="removing">Removing<a class="anchor" aria-label="anchor" href="#removing"></a>
</h3>
<p>We did not need to create a backup of our output as we noticed this
file is no longer needed; in the interest of saving space on the
cluster, we want to delete the contents of the
<code>t17.backup.out</code>.</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="ex">$</span> rm t17.backup.out</span></code></pre>
</div>
<p>Important notes about <code>rm</code> * <code>rm</code> permanently
removes/deletes the file/folder. * There is no concept of “Trash” or
“Recycle Bin” on the command line. When you use <code>rm</code> to
remove/delete, they’re really gone. * <strong>Be careful with this
command!</strong> * You can use the <code>-i</code> argument if you want
it to ask before removing <code>rm -i file-name</code>.</p>
<p>Let’s delete the ABINIT folder too. First, we’ll have to navigate our
way to the parent directory (we can’t delete the folder we are currently
in/using).</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="ex">$</span> cd ..</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a><span class="ex">$</span> rm  ABINIT</span></code></pre>
</div>
<p>Did that work? Did you get an error?</p>
<details><summary><i>Explanation</i>
</summary><p>
By default, <code>rm</code>, will NOT delete directories, but you use
the <code>-r</code> flag if you are sure that you want to delete the
directories and everything within them. To be safe, let’s use it with
the <code>-i</code> flag.
</p>
</details><p><br></p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="ex">$</span> rm <span class="at">-ri</span> ABINIT</span></code></pre>
</div>
<ul>
<li>
<code>-r</code>: recursive, commonly used as an option when working
with directories, e.g. with <code>cp</code>.</li>
<li>
<code>-i</code>: prompt before every removal.</li>
</ul>
<hr>
<p><strong>Exercise</strong></p>
<ol style="list-style-type: decimal">
<li>Create a new folder in <code>workshops_hands-on</code> called
<code>abinit_test</code>
</li>
<li>Copy over the abinit inputs from
<code>2._Command_Line_Interface</code> to the
<code>~/workshops_hands-on/Introduction_HPC/2._Command_Line_Interface/abinit_test</code>
folder</li>
<li>Rename the <code>abinit_test</code> folder and call it
<code>exercise1</code>
</li>
</ol>
<hr>
</div>
</section><section><h2 class="section-heading" id="exiting-from-the-cluster">Exiting from the cluster<a class="anchor" aria-label="anchor" href="#exiting-from-the-cluster"></a>
</h2>
<hr class="half-width">
<p>To close the interactive session on the cluster and disconnect from
the cluster, the command is <code>exit</code>. So, you are going to have
to run the exit command twice.</p>
<pre><code>00:11:05-gufranco@trcis001:~$ exit
logout
Connection to trcis001 closed.
guilleaf@MacBook-Pro-15in-2015 ~ %</code></pre>
</section><section><h2 class="section-heading" id="unixlinux-commands-to-learn-and-use">10 Unix/Linux commands to learn and use<a class="anchor" aria-label="anchor" href="#unixlinux-commands-to-learn-and-use"></a>
</h2>
<hr class="half-width"></section><section><h2 class="section-heading" id="the-echo-and-cat-commands">The <code>echo</code> and <code>cat</code> commands<a class="anchor" aria-label="anchor" href="#the-echo-and-cat-commands"></a>
</h2>
<hr class="half-width">
<p>The <code>echo</code> command is very basic; it returns what you give
back to the terminal, kinda like an echo. Execute the command below.</p>
<pre><code>$ echo "I am learning UNIX Commands"</code></pre>
<pre><code>I am learning UNIX Commands</code></pre>
<p>{: .output}</p>
<p>This may not seem that useful right now. However, <code>echo</code>
will also print the contents of a variable to the terminal. There are
some default variables set for each user on the HPCs: <code>$HOME</code>
is the pathway to the user’s “home” directory, and <code>$SCRATCH</code>
is Similarly the pathway to the user’s “scratch” directory. More info on
what those directories are for later, but for now, we can print them to
the terminal using the <code>echo</code> command.</p>
<pre><code>$ echo $HOME</code></pre>
<pre><code>/users/&lt;username&gt;</code></pre>
<p>{: .output}</p>
<pre><code>$ echo $SCRATCH</code></pre>
<pre><code>/scratch/&lt;username&gt;</code></pre>
<p>{: .output}</p>
<p>In addition, the shell can do basic arithmetical operations, execute
this command:</p>
<pre><code>$ echo $((23+45*2))</code></pre>
<pre><code><span><span class="fl">113</span></span></code></pre>
<p>{: .output}</p>
<p>Notice that, as customary in mathematics, products take precedence
over addition. That is called the PEMDAS order of operations, ie
"Parentheses, Exponents, Multiplication and Division, and Addition and
Subtraction". Check your understanding of the PEMDAS rule with this
command:</p>
<pre><code>$ echo $(((1+2**3*(4+5)-7)/2+9))</code></pre>
<pre><code><span><span class="fl">42</span></span></code></pre>
<p>{: .output}</p>
<p>Notice that the exponential operation is expressed with the
<code>**</code> operator. The usage of <code>echo</code> is important.
Otherwise, if you execute the command without <code>echo</code>, the
shell will do the operation and will try to execute a command called
<code>42</code> that does not exist on the system. Try by yourself:</p>
<pre><code>$ $(((1+2**3*(4+5)-7)/2+9))</code></pre>
<pre><code>-bash: 42: command not found</code></pre>
<p>{: .output}</p>
<p>As you have seen before, when you execute a command on the terminal,
in most cases you see the output printed on the screen. The next thing
to learn is how to redirect the output of a command into a file. It will
be very important to submit jobs later and control where and how the
output is produced. Execute the following command:</p>
<pre><code>$ echo "I am learning UNIX Commands." &gt; report.log</code></pre>
<p>With the character <code>&gt;</code> redirects the output from
<code>echo</code> into a file called <em>report.log</em>. No output is
printed on the screen. If the file does not exist, it will be created.
If the file existed previously, it was erased, and only the new contents
were stored. In fact, <code>&gt;</code> can be used to redirect the
output of any command to a file!</p>
<p>To check that the file actually contains the line produced by
<code>echo</code>, execute:</p>
<pre><code>$ cat report.log</code></pre>
<pre><code>I am learning UNIX Commands.</code></pre>
<p>{: .output}</p>
<p>The cat (concatenate) command displays the contents of one or several
files. In the case of multiple files, the files are printed in the order
they are described in the command line, concatenating the output as per
the name of the command.</p>
<!-- **Seems unnecessary**
You can even use a nice trick to write a small text on a file. Execute
the following command, followed by the text that you want to write, at
the end execute `Ctrl-D` (`^D`), the *Control Key* followed by the `D`
key. I am annotating below the location where `^D` should be executed:

```
$ cat > report.log
I am learning UNIX Commands^D
$ cat report.log
I am learning UNIX Commands
```

-->
<p>In fact, there are hundreds of commands, most of them with a variety
of options that change the behavior of the original command. You can
feel bewildered at first by a large number of existing commands, but
most of the time, you will be using a very small number of them.
Learning those will speed up your learning curve.</p>
</section><section><h2 class="section-heading" id="folder-commands">Folder commands<a class="anchor" aria-label="anchor" href="#folder-commands"></a>
</h2>
<hr class="half-width">
<p>As mentioned, UNIX organizes data in storage devices as a tree. The
commands <code>pwd</code>, <code>cd</code> and <code>mkdir</code> will
allow you to know where you are, move your location on the tree, and
create new folders. Later, we will learn how to move folders from one
location on the tree to another.</p>
<p>The first command is <code>pwd</code>. Just execute the command on
the terminal:</p>
<pre><code>$ pwd</code></pre>
<pre><code>/users/&lt;username&gt;</code></pre>
<p>{: .output}</p>
<p>It is always very important to know where in the tree you are. Doing
research usually involves dealing with a large amount of data, and
exploring several parameters or physical conditions. Therefore,
organizing the filesystem is key.</p>
<p>When you log into a cluster, by default, you are located on your
<code>$HOME</code> folder. That is why the <code>pwd</code> command
should return that location in the first instance.</p>
<p>The following command <code>cd</code> is used to <em>change the
directory</em>. A directory is another name for <em>folder</em> and is
widely used; in UNIX, the terms are interchangeable. Other Desktop
Operating Systems like Windows and MacOS have the concept of <em>smart
folders</em> or <em>virtual folders</em>, where the <em>folder</em> that
you see on screen has no correlation with a directory in the filesystem.
In those cases, the distinction is relevant.</p>
<p>There is another important folder defined in our clusters, it’s
called the scratch folder, and each user has its own. The location of
the folder is stored in the variable <code>$SCRATCH</code>. Notice that
this is internal convection and is not observed in other HPC
clusters.</p>
<p>Use the next command to go to that folder:</p>
<pre><code>$ cd $SCRATCH
$ pwd</code></pre>
<pre><code>/scratch/&lt;username&gt;</code></pre>
<p>{: .output}</p>
<p>Notice that the location is different now; if you are using this
account for the first time, you will not have files on this folder. It
is time to learn another command to list the contents of a
<em>folder</em>, execute:</p>
<pre><code>$ ls</code></pre>
<p>Assuming that you are using your HPC account for the first time, you
will not have anything in your <code>$SCRATCH</code> folder and should
therefore see no output from <code>ls</code>. This is a good opportunity
to start your filesystem by creating one folder and moving into it,
execute:</p>
<pre><code>$ mkdir test_folder
$ cd test_folder</code></pre>
<p><code>mkdir</code> allows you to create folders in places where you
are authorized to do so, such as your <code>$HOME</code> and
<code>$SCRATCH</code> folders. Try this command:</p>
<pre><code>$ mkdir /test_folder</code></pre>
<pre><code>mkdir: cannot create directory `/test_folder': Permission denied</code></pre>
<p>{: .output}</p>
<p>There is an important difference between <code>test_folder</code> and
<code>/test_folder</code>. The former is a location in your current
directory, and the latter is a location starting on the root directory
<code>/</code>. A normal user has no rights to create folders on that
directory so <code>mkdir</code> will fail, and an error message will be
shown on your screen.</p>
<p>Notice that we named it <code>test_folder</code> instead of
<code>test folder</code>. In UNIX, there is no restriction regarding
files or directories with spaces, but using them can become a nuisance
on the command line. If you want to create the folder with spaces from
the command line, here are the options:</p>
<pre><code>$ mkdir "test folder with spaces"
$ mkdir another\ test\ folder\ with\ spaces</code></pre>
<p>In any case, you have to type extra characters to prevent the command
line application from considering those spaces as separators for several
arguments in your command. Try executing the following:</p>
<pre><code>$ mkdir another folder with spaces
$ ls</code></pre>
<pre><code>another folder with spaces  folder  spaces  test_folder  test folder with spaces  with</code></pre>
<p>{: .output}</p>
<p>Maybe is not clear what is happening here. There is an option for
<code>ls</code> that present the contents of a directory:</p>
<pre><code>$ ls -l</code></pre>
<pre><code>total 0
drwxr-xr-x 2 myname mygroup 512 Nov  2 15:44 another
drwxr-xr-x 2 myname mygroup 512 Nov  2 15:45 another folder with spaces
drwxr-xr-x 2 myname mygroup 512 Nov  2 15:44 folder
drwxr-xr-x 2 myname mygroup 512 Nov  2 15:44 spaces
drwxr-xr-x 2 myname mygroup 512 Nov  2 15:45 test_folder
drwxr-xr-x 2 myname mygroup 512 Nov  2 15:45 test folder with spaces
drwxr-xr-x 2 myname mygroup 512 Nov  2 15:44 with</code></pre>
<p>{: .output}</p>
<p>It should be clear, now what happens when the spaces are not
contained in quotes <code>"test folder with spaces"</code> or escaped as
<code>another\ folder\ with\ spaces</code>. This is the perfect
opportunity to learn how to delete empty folders. Execute:</p>
<pre><code>$ rmdir another
$ rmdir folder spaces with</code></pre>
<p>You can delete one or several folders, but all those folders must be
empty. If those folders contain files or more folders, the command will
fail and an error message will be displayed.</p>
<p>After deleting those folders created by mistake, let's check the
contents of the current directory. The command <code>ls -1</code> will
list the contents of a file one per line, something very convenient for
future scripting:</p>
<pre><code>$ ls -1</code></pre>
<pre><code>total 0
drwxr-xr-x 2 myname mygroup 512 Nov  2 15:45 another folder with spaces
drwxr-xr-x 2 myname mygroup 512 Nov  2 15:45 test_folder
drwxr-xr-x 2 myname mygroup 512 Nov  2 15:45 test folder with spaces</code></pre>
<p>{: .output}</p>
</section><section><h2 class="section-heading" id="commands-for-copy-and-move">Commands for copy and move<a class="anchor" aria-label="anchor" href="#commands-for-copy-and-move"></a>
</h2>
<hr class="half-width">
<p>The next two commands are <code>cp</code> and <code>mv</code>. They
are used to copy or move files or folders from one location to another.
In its simplest usage, those two commands take two arguments: the first
argument is the source and the last one is the destination. In the case
of more than two arguments, the destination must be a directory. The
effect will be to copy or move all the source items into the folder
indicated as the destination.</p>
<p>Before doing a few examples with <code>cp</code> and <code>mv</code>,
let's use a very handy command to create files. The command
<code>touch</code> is used to update the access and modification times
of a file or folder to the current time. If there is no such file, the
command will create a new empty file. We will use that feature to create
some empty files for the purpose of demonstrating how to use
<code>cp</code> and <code>mv</code>.</p>
<p>Let’s create a few files and directories:</p>
<pre><code>$ mkdir even odd
$ touch f01 f02 f03 f05 f07 f11</code></pre>
<p>Now, lets copy some of those existing files to complete all the
numbers up to <code>f11</code>:</p>
<pre><code>$ cp f03 f04
$ cp f05 f06
$ cp f07 f08
$ cp f07 f09
$ cp f07 f10</code></pre>
<p>This is a good opportunity to present the <code>*</code>
<em>wildcard</em>, and use it to replace an arbitrary sequence of
characters. For instance, execute this command to list all the files
created above:</p>
<pre><code>$ ls f*</code></pre>
<pre><code>f01  f02  f03  f04  f05  f06  f07  f08  f09  f10  f11</code></pre>
<p>{: .output}</p>
<p>The <em>wildcard</em> is able to replace zero or more arbitrary
characters, for example:</p>
<pre><code>$ ls f*1</code></pre>
<pre><code>f01  f11</code></pre>
<p>{: .output}</p>
<p>There is another way of representing files or directories that follow
a pattern, execute this command:</p>
<pre><code>$ ls f0[3,5,7]</code></pre>
<pre><code>f03  f05  f07</code></pre>
<p>{: .output}</p>
<p>The files selected are those whose last character is on the list
<code>[3,5,7]</code>. Similarly, a range of characters can be
represented. See:</p>
<pre><code>$ ls f0[3-7]</code></pre>
<pre><code>f03  f04  f05  f06  f07</code></pre>
<p>{: .output}</p>
<p>We will use those special characters to move files based on their
parity. Execute:</p>
<pre><code>$ mv f[0,1][1,3,5,7,9] odd
$ mv f[0,1][0,2,4,6,8] even</code></pre>
<p>The command above is equivalent to executing the explicit listing of
sources:</p>
<pre><code>$ mv f01 f03 f05 f07 f09 f11 odd
$ mv f02 f04 f06 f08 f10 even</code></pre>
</section><section><h2 class="section-heading" id="delete-files-and-folders">Delete files and Folders<a class="anchor" aria-label="anchor" href="#delete-files-and-folders"></a>
</h2>
<hr class="half-width">
<p>As we mentioned above, empty folders can be deleted with the command
<code>rmdir</code>, but that only works if there are no subfolders or
files inside the folder that you want to delete. See for example, what
happens if you try to delete the folder called <code>odd</code>:</p>
<pre><code>$ rmdir odd</code></pre>
<pre><code>rmdir: failed to remove `odd': Directory not empty</code></pre>
<p>If you want to delete odd, you can do it in two ways. The command
<code>rm</code> allows you to delete one or more files entered as
arguments. Let's delete all the files inside odd, followed by the
deletion of the folder <code>odd</code> itself:</p>
<pre><code>~$ rm odd/*
~$ rmdir odd</code></pre>
<p>Another option is to delete a folder recursively, this is a powerful
but also dangerous option. Quite unlike Windows/MacOS, recovering
deleted files through a “Trash Can” or “Recycling Bin” does not happen
in Linux; deleting is permanent. Let's delete the folder even
recursively:</p>
<pre><code>~$ rm -r even</code></pre>
</section><section><h2 class="section-heading" id="summary-of-basic-commands">Summary of Basic Commands<a class="anchor" aria-label="anchor" href="#summary-of-basic-commands"></a>
</h2>
<hr class="half-width">
<p>The purpose of this brief tutorial is to familiarize you with the
most common commands used in UNIX environments. We have shown ten
commands that you will be using very often in your interaction. These 10
basic commands and one editor from the next section are all that you
need to be ready to submit jobs on the cluster.</p>
<p>The next table summarizes those commands.</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="32%">
<col width="51%">
</colgroup>
<thead><tr class="header">
<th>Command</th>
<th align="left">Description</th>
<th align="left">Examples</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>echo</code></td>
<td align="left">Display a given message on the screen</td>
<td align="left"><code>$ echo "This is a message"</code></td>
</tr>
<tr class="even">
<td>———</td>
<td align="left">——————-</td>
<td align="left">——————————</td>
</tr>
<tr class="odd">
<td><code>cat</code></td>
<td align="left">Display the contents of a file on screen <br>
Concatenate files</td>
<td align="left"><code>$ cat my_file</code></td>
</tr>
<tr class="even">
<td>———</td>
<td align="left">——————-</td>
<td align="left">——————————</td>
</tr>
<tr class="odd">
<td><code>date</code></td>
<td align="left">Shows the current date on screen</td>
<td align="left">
<code>$ date</code> <br> Sun Jul 26 15:41:03 EDT
2020</td>
</tr>
<tr class="even">
<td>———</td>
<td align="left">——————-</td>
<td align="left">——————————</td>
</tr>
<tr class="odd">
<td><code>pwd</code></td>
<td align="left">Return the path to the current working directory</td>
<td align="left">
<code>$ pwd</code> <br> /users/username</td>
</tr>
<tr class="even">
<td>———</td>
<td align="left">——————-</td>
<td align="left">——————————</td>
</tr>
<tr class="odd">
<td><code>cd</code></td>
<td align="left">Change directory</td>
<td align="left"><code>$ cd sub_folder</code></td>
</tr>
<tr class="even">
<td>———</td>
<td align="left">——————-</td>
<td align="left">——————————</td>
</tr>
<tr class="odd">
<td><code>mkdir</code></td>
<td align="left">Create directory</td>
<td align="left"><code>$ mkdir new_folder</code></td>
</tr>
<tr class="even">
<td>———</td>
<td align="left">——————-</td>
<td align="left">——————————</td>
</tr>
<tr class="odd">
<td><code>touch</code></td>
<td align="left">Change the access and modification time of a file <br>
Create empty files</td>
<td align="left"><code>$ touch new_file</code></td>
</tr>
<tr class="even">
<td>———</td>
<td align="left">——————-</td>
<td align="left">——————————</td>
</tr>
<tr class="odd">
<td><code>cp</code></td>
<td align="left">Copy a file in another location <br> Copy several files
into a destination directory</td>
<td align="left"><code>$ cp old_file new_file</code></td>
</tr>
<tr class="even">
<td>———</td>
<td align="left">——————-</td>
<td align="left">——————————</td>
</tr>
<tr class="odd">
<td><code>mv</code></td>
<td align="left">Move a file in another location <br> Move several files
into a destination folder</td>
<td align="left"><code>$ mv old_name new_name</code></td>
</tr>
<tr class="even">
<td>———</td>
<td align="left">——————-</td>
<td align="left">——————————</td>
</tr>
<tr class="odd">
<td><code>rm</code></td>
<td align="left">Remove one or more files from the file system tree</td>
<td align="left">
<code>$ rm trash_file</code> <br><code>$ rm -r full_folder</code>
</td>
</tr>
<tr class="even">
<td>———</td>
<td align="left">——————-</td>
<td align="left">——————————</td>
</tr>
</tbody>
</table>
<blockquote>
<h2 id="exercise-1">Exercise 1</h2>
<p>Get into Thorny Flat with your training account and execute the
commands <code>ls</code>, <code>date</code>, and <code>cal</code></p>
<p>Exit from the cluster with <code>exit</code></p>
<p>So let’s try our first command, which will list the contents of the
current directory:</p>
<pre><code>[training001@srih0001 ~]$ ls -al</code></pre>
<pre><code>total 64
drwx------   4 training001 training   512 Jun 27 13:24 .
drwxr-xr-x 151 root        root     32768 Jun 27 13:18 ..
-rw-r--r--   1 training001 training    18 Feb 15  2017 .bash_logout
-rw-r--r--   1 training001 training   176 Feb 15  2017 .bash_profile
-rw-r--r--   1 training001 training   124 Feb 15  2017 .bashrc
-rw-r--r--   1 training001 training   171 Jan 22  2018 .kshrc
drwxr-xr-x   4 training001 training   512 Apr 15  2014 .mozilla
drwx------   2 training001 training   512 Jun 27 13:24 .ssh</code></pre>
<p>{: .output}</p>
<blockquote>
<h2 id="command-not-found">Command not found</h2>
<p>If the shell can’t find a program whose name is the command you
typed, it will print an error message such as:</p>
<pre><code>$ ks</code></pre>
<pre><code>ks: command not found</code></pre>
<p>{: .output}</p>
<p>Usually this means that you have mis-typed the command. {:
.callout}</p>
</blockquote>
<p>{: .challenge}</p>
</blockquote>
<blockquote>
<h2 id="exercise-2">Exercise 2</h2>
<p>Commands in Unix/Linux are very stable with some existing for decades
now. This exercise begins to give you a feeling of the different parts
of a command.</p>
<p>Execute the command <code>cal</code>, we executed the command before
but this time execute it again like this <code>cal -y</code>. You should
get an output like this:</p>
<pre><code>[training001@srih0001 ~]$ cal -y</code></pre>
<pre><code>                         2021

January               February                 March
Su Mo Tu We Th Fr Sa   Su Mo Tu We Th Fr Sa   Su Mo Tu We Th Fr Sa
1  2       1  2  3  4  5  6       1  2  3  4  5  6
3  4  5  6  7  8  9    7  8  9 10 11 12 13    7  8  9 10 11 12 13
10 11 12 13 14 15 16   14 15 16 17 18 19 20   14 15 16 17 18 19 20
17 18 19 20 21 22 23   21 22 23 24 25 26 27   21 22 23 24 25 26 27
24 25 26 27 28 29 30   28                     28 29 30 31
31
April                   May                   June
Su Mo Tu We Th Fr Sa   Su Mo Tu We Th Fr Sa   Su Mo Tu We Th Fr Sa
1  2  3                      1          1  2  3  4  5
4  5  6  7  8  9 10    2  3  4  5  6  7  8    6  7  8  9 10 11 12
11 12 13 14 15 16 17    9 10 11 12 13 14 15   13 14 15 16 17 18 19
18 19 20 21 22 23 24   16 17 18 19 20 21 22   20 21 22 23 24 25 26
25 26 27 28 29 30      23 24 25 26 27 28 29   27 28 29 30
30 31
July                  August                September
Su Mo Tu We Th Fr Sa   Su Mo Tu We Th Fr Sa   Su Mo Tu We Th Fr Sa
1  2  3    1  2  3  4  5  6  7             1  2  3  4
4  5  6  7  8  9 10    8  9 10 11 12 13 14    5  6  7  8  9 10 11
11 12 13 14 15 16 17   15 16 17 18 19 20 21   12 13 14 15 16 17 18
18 19 20 21 22 23 24   22 23 24 25 26 27 28   19 20 21 22 23 24 25
25 26 27 28 29 30 31   29 30 31               26 27 28 29 30

October               November               December
Su Mo Tu We Th Fr Sa   Su Mo Tu We Th Fr Sa   Su Mo Tu We Th Fr Sa
1  2       1  2  3  4  5  6             1  2  3  4
3  4  5  6  7  8  9    7  8  9 10 11 12 13    5  6  7  8  9 10 11
10 11 12 13 14 15 16   14 15 16 17 18 19 20   12 13 14 15 16 17 18
17 18 19 20 21 22 23   21 22 23 24 25 26 27   19 20 21 22 23 24 25
24 25 26 27 28 29 30   28 29 30               26 27 28 29 30 31
31</code></pre>
<p>{: .output}</p>
<p>Another very simple command that is very useful in HPC is
<code>date</code>. Without any arguments, it prints the current date to
the screen.</p>
<pre><code>$ date</code></pre>
<pre><code>Sun Jul 26 15:41:03 EDT 2020</code></pre>
<p>{: .output} {: .challenge}</p>
</blockquote>
<blockquote>
<h2 id="exercise-3">Exercise 3</h2>
<p>Create two folders called <code>one</code> and <code>two</code>. In
<code>one</code> create the empty file <code>none1</code> and in
<code>two</code> create &gt; the empty file <code>none2</code>.</p>
<p>Create also in those two folders, files <code>date1</code> and &gt;
<code>date2</code> by redirecting the output from the command
<code>date</code> &gt; using <code>&gt;</code>. ~~~ $ date &gt; date1
~~~</p>
<p>Check with <code>cat</code> that those files contain dates.</p>
<p>Now, create the folders <code>empty_files</code> and
<code>dates</code> and move &gt; the corresponding files
<code>none1</code> and <code>none2</code> to &gt;
<code>empty_files</code> and do the same for <code>date1</code> and
<code>date2</code>.</p>
<p>The folders <code>one</code> and <code>two</code> should be empty
now; delete &gt; them with <code>rmdir</code> Do the same with folders
<code>empty_files</code> and <code>dates</code> with
<code>rm -r</code>.</p>
<p>{: .challenge}</p>
</blockquote>
<blockquote>
<h2 id="exercise-4">Exercise 4</h2>
<p>The command line is powerful enough even to do programming. Execute
the command below and see the answer.</p>
<pre><code>[training001@srih0001 ~]$ n=1; while test $n -lt 10000; do  echo $n; n=`expr 2 \* $n`; done</code></pre>
<pre><code><span><span class="fl">1</span></span>
<span><span class="fl">2</span></span>
<span><span class="fl">4</span></span>
<span><span class="fl">8</span></span>
<span><span class="fl">16</span></span>
<span><span class="fl">32</span></span>
<span><span class="fl">64</span></span>
<span><span class="fl">128</span></span>
<span><span class="fl">256</span></span>
<span><span class="fl">512</span></span>
<span><span class="fl">1024</span></span>
<span><span class="fl">2048</span></span>
<span><span class="fl">4096</span></span>
<span><span class="fl">8192</span></span></code></pre>
<p>{: .output}</p>
<p>If you are not getting this output check the command line very
carefully. Even small changes could be interpreted by the shell as
entirely different commands so you need to be extra careful and gather
insight when commands are not doing what you want.</p>
<p>Now the challenge consists on tweaking the command line above to show
the calendar for August for the next 10 years.</p>
<blockquote>
<h2 id="hint">Hint</h2>
<p>Use the command <code>cal -h</code> to get a summary of the arguments
to show just one month for one specific year You can use
<code>expr</code> to increase <code>n</code> by one on each cycle, but
you can also use <code>n=$(n+1)</code></p>
<p>{: .challenge}</p>
</blockquote>
</blockquote>
</section><section><h2 class="section-heading" id="grabbing-files-from-the-internet">Grabbing files from the internet<a class="anchor" aria-label="anchor" href="#grabbing-files-from-the-internet"></a>
</h2>
<hr class="half-width">
<p>To download files from the internet, the absolute best tool is
<code>wget</code>. The syntax is relatively straightforwards:
<code>wget https://some/link/to/a/file.tar.gz</code></p>
<blockquote>
<h2 id="downloading-the-drosophila-genome">Downloading the Drosophila
genome</h2>
<p>The <em>Drosophila melanogaster</em> reference genome is located at
the following website: <a href="https://metazoa.ensembl.org/Drosophila_melanogaster/Info/Index" class="external-link">https://metazoa.ensembl.org/Drosophila_melanogaster/Info/Index</a>.
Download it to the cluster with <code>wget</code>.</p>
<ul>
<li><p><code>cd</code> to your genome directory</p></li>
<li>
<p>Copy this URL and paste it onto the command line:</p>
<div class="codewrapper sourceCode" id="cb97">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> wget <span class="ex">ftp://ftp.ensemblgenomes.org:21/pub/metazoa/release-51/fasta/drosophila_melanogaster/dna/Drosophila_melanogaster.BDGP6.32.dna_rm.toplevel.fa.gz</span></span></code></pre>
</div>
</li>
</ul>
<p>{: .challenge}</p>
</blockquote>
<blockquote>
<h2 id="working-with-compressed-files-using-unzip-and-gunzip">Working
with compressed files, using unzip and gunzip</h2>
<p>The file we just downloaded is gzipped (has the <code>.gz</code>
extension). You can uncompress it with
<code>gunzip filename.gz</code>.</p>
<p>File decompression reference:</p>
<ul>
<li>
<strong>.tar.gz</strong> -
<code>tar -xzvf archive-name.tar.gz</code>
</li>
<li>
<strong>.tar.bz2</strong> -
<code>tar -xjvf archive-name.tar.bz2</code>
</li>
<li>
<strong>.zip</strong> - <code>unzip archive-name.zip</code>
</li>
<li>
<strong>.rar</strong> - <code>unrar archive-name.rar</code>
</li>
<li>
<strong>.7z</strong> - <code>7z x archive-name.7z</code>
</li>
</ul>
<p>However, sometimes we will want to compress files ourselves to make
file transfers easier. The larger the file, the longer it will take to
transfer. Moreover, we can compress a whole bunch of little files into
one big file to make it easier on us (no one likes transferring 70000)
little files!</p>
<p>The two compression commands we’ll probably want to remember are the
following:</p>
<ul>
<li>Compress a single file with Gzip - <code>gzip filename</code>
</li>
<li>Compress a lot of files/folders with Gzip -
<code>tar -czvf archive-name.tar.gz folder1 file2 folder3 etc</code>
</li>
</ul>
<p>{: .callout}</p>
</blockquote>
</section><section><h2 class="section-heading" id="wildcards-shortcuts-and-other-time-saving-tricks">Wildcards, shortcuts, and other time-saving tricks<a class="anchor" aria-label="anchor" href="#wildcards-shortcuts-and-other-time-saving-tricks"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="wild-cards">Wild cards<a class="anchor" aria-label="anchor" href="#wild-cards"></a>
</h3>
<p><strong>The “*” wildcard:</strong></p>
<p>Navigate to the
<code>~/workshops_hands-on/Introduction_HPC/2._Command_Line_Interface/ABINIT</code>
directory.</p>
<p>The “*” character is a shortcut for “everything”. Thus, if you enter
<code>ls *</code>, you will see all of the contents of a given
directory. Now try this command:</p>
<div class="codewrapper sourceCode" id="cb98">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="ex">$</span> ls 2<span class="pp">*</span></span></code></pre>
</div>
<p>This lists every file that starts with a <code>2</code>. Try this
command:</p>
<div class="codewrapper sourceCode" id="cb99">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="ex">$</span> ls /usr/bin/<span class="pp">*</span>.sh</span></code></pre>
</div>
<p>This lists every file in <code>/usr/bin</code> directory that ends in
the characters <code>.sh</code>. “*” can be placed anywhere in your
pattern. For example:</p>
<div class="codewrapper sourceCode" id="cb100">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="ex">$</span> ls t17<span class="pp">*</span>.nc</span></code></pre>
</div>
<p>This lists only the files that begin with ‘t17’ and end with
<code>.nc</code>.</p>
<p>So, how does this actually work? The Shell (bash) considers an
asterisk “*” to be a wildcard character that can match one or more
occurrences of any character, including no character.</p>
<blockquote>
<p><strong>Tip</strong> - An asterisk/star is only one of the many
wildcards in Unix, but this is the most powerful one, and we will be
using this one the most for our exercises.</p>
</blockquote>
<p><strong>The “?” wildcard:</strong></p>
<p>Another wildcard that is sometimes helpful is <code>?</code>.
<code>?</code> is similar to <code>*</code> except that it is a
placeholder for exactly one position. Recall that <code>*</code> can
represent any number of following positions, including no positions. To
highlight this distinction, lets look at a few examples. First, try this
command:</p>
<div class="codewrapper sourceCode" id="cb101">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="ex">$</span> ls /bin/d<span class="pp">*</span></span></code></pre>
</div>
<p>This will display all files in <code>/bin/</code> that start with “d”
regardless of length. However, if you only wanted the things in
<code>/bin/</code> that starts with “d” and are two characters long,
then you can use:</p>
<div class="codewrapper sourceCode" id="cb102">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="ex">$</span> ls /bin/d<span class="pp">?</span></span></code></pre>
</div>
<p>Lastly, you can chain together multiple “?” marks to help specify a
length. In the example below, you would be looking for all things in
<code>/bin/</code> that start with a “d” and have a name length of three
characters.</p>
<div class="codewrapper sourceCode" id="cb103">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="ex">$</span> ls /bin/d<span class="pp">??</span></span></code></pre>
</div>
<hr>
<p><strong>Exercise</strong></p>
<p>Do each of the following using a single <code>ls</code> command
without navigating to a different directory.</p>
<ol style="list-style-type: decimal">
<li>List all of the files in <code>/bin</code> that start with the
letter ‘c’</li>
<li>List all of the files in <code>/bin</code> that contain the letter
‘a’</li>
<li>List all of the files in <code>/bin</code> that end with the letter
‘o’</li>
</ol>
<p>BONUS: Using one command to list all of the files in
<code>/bin</code> that contain either ‘a’ or ‘c’. (Hint: you might need
to use a different wildcard here. Refer to this <a href="https://www.putorius.net/standard-wildcards-globbing-patterns-in.html" class="external-link">post</a>
for some ideas.)</p>
<hr>
</div>
<div class="section level3">
<h3 id="shortcuts">Shortcuts<a class="anchor" aria-label="anchor" href="#shortcuts"></a>
</h3>
<p>There are some very useful shortcuts that you should also know
about.</p>
<div class="section level4">
<h4 id="home-directory-or">Home directory or “~”<a class="anchor" aria-label="anchor" href="#home-directory-or"></a>
</h4>
<p>Dealing with the home directory is very common. In the shell, the
tilde character “~”, is a shortcut for your home directory. Let’s first
navigate to the <code>ABINIT</code> directory (try to use tab completion
here!):</p>
<div class="codewrapper sourceCode" id="cb104">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="ex">$</span> cd</span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a><span class="ex">$</span> cd ~/workshops_hands-on/Introduction_HPC/2._Command_Line_Interface</span></code></pre>
</div>
<p>Then enter the command:</p>
<div class="codewrapper sourceCode" id="cb105">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="ex">$</span> ls ~</span></code></pre>
</div>
<p>This prints the contents of your home directory without you having to
type the full path. This is because the tilde “~” is equivalent to
“/home/username”, as we had mentioned in the previous lesson.</p>
</div>
<div class="section level4">
<h4 id="parent-directory-or---">Parent directory or “..”<a class="anchor" aria-label="anchor" href="#parent-directory-or---"></a>
</h4>
<p>Another shortcut you encountered in the previous lesson is “..”:</p>
<div class="codewrapper sourceCode" id="cb106">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="ex">$</span> ls ..</span></code></pre>
</div>
<p>The shortcut <code>..</code> always refers to the parent directory of
whatever directory you are currently in. So, <code>ls ..</code> will
print the contents of <code>unix_lesson</code>. You can also chain these
<code>..</code> together, separated by <code>/</code>:</p>
<div class="codewrapper sourceCode" id="cb107">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="ex">$</span> ls ../..</span></code></pre>
</div>
<p>This prints the contents of <code>/n/homexx/username</code>, which is
two levels above your current directory (your home directory).</p>
</div>
<div class="section level4">
<h4 id="current-directory-or--">Current directory or “.”<a class="anchor" aria-label="anchor" href="#current-directory-or--"></a>
</h4>
<p>Finally, the special directory <code>.</code> always refers to your
current directory. So, <code>ls</code> and <code>ls .</code> will do the
same thing - they print the contents of the current directory. This may
seem like a useless shortcut, but recall that we used it earlier when we
copied over the data to our home directory.</p>
<p>To summarize, the commands <code>ls ~</code> and <code>ls ~/.</code>
do exactly the same thing. These shortcuts can be convenient when you
navigate through directories!</p>
</div>
<div class="section level4">
<h4 id="command-history">Command History<a class="anchor" aria-label="anchor" href="#command-history"></a>
</h4>
<p>You can easily access previous commands by hitting the
<button>up</button> arrow key on your keyboard. This way, you can step
backward through your command history. On the other hand, the
<button>down</button> arrow key takes you forward in the command
history.</p>
<p><strong><em>Try it out! While on the command prompt, hit the
<button>up</button> arrow a few times, and then hit the
<button>down</button> arrow a few times until you are back to where you
started.</em></strong></p>
<p>You can also review your recent commands with the
<code>history</code> command. Just enter:</p>
<div class="codewrapper sourceCode" id="cb108">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="ex">$</span> history</span></code></pre>
</div>
<p>You should see a numbered list of commands, including the
<code>history</code> command you just ran!</p>
<p>Only a certain number of commands can be stored and displayed with
the <code>history</code> command by default, but you can increase or
decrease it to a different number. It is outside the scope of this
workshop, but feel free to look it up after class.</p>
<blockquote>
<p><strong>NOTE:</strong> So far, we have only run very short commands
that have very few or no arguments. It would be faster to just retype it
than to check the history. However, as you start to run analyses on the
command line, you will find that the commands are longer and more
complex, and the <code>history</code> command will be very useful!</p>
</blockquote>
</div>
<div class="section level4">
<h4 id="cancel-a-command-or-task">Cancel a command or task<a class="anchor" aria-label="anchor" href="#cancel-a-command-or-task"></a>
</h4>
<p>Sometimes as you enter a command, you realize that you don’t want to
continue or run the current line. Instead of deleting everything you
have entered (which could be very long), you could quickly cancel the
current line and start a fresh prompt with <kbd>Ctrl</kbd> +
<kbd>C</kbd>.</p>
<div class="codewrapper sourceCode" id="cb109">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="ex">$</span> <span class="co"># Run some random words, then hit "Ctrl + C". Observe what happens</span></span></code></pre>
</div>
<p>Another useful case for <kbd>Ctrl</kbd> + <kbd>C</kbd> is when a task
is running that you would like to stop. In order to illustrate this, we
will briefly introduce the <code>sleep</code> command.
<code>sleep N</code> pauses your command line from additional entries
for N seconds. If we would like to have the command line not accept
entries for 20 seconds, we could use:</p>
<div class="codewrapper sourceCode" id="cb110">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="ex">$</span> sleep 20</span></code></pre>
</div>
<p>While your <code>sleep</code> command is running, you may decide that
in fact, you do want to have your command line back. To terminate the
rest of the <code>sleep</code> command simply type:</p>
<p><kbd>Ctrl</kbd> + <kbd>C</kbd></p>
<p>This should terminate the rest of the <code>sleep</code> command.
While this use may seem a bit silly, you will likely encounter many
scenarios when you accidentally start running a task that you didn’t
mean to start, and <kbd>Ctrl</kbd> + <kbd>C</kbd> can be immensely
helpful in stopping it.</p>
<p><strong>Other handy command-related shortcuts</strong></p>
<ul>
<li>
<kbd>Ctrl</kbd> + <kbd>A</kbd> will bring you to the start of the
command you are writing.</li>
<li>
<kbd>Ctrl</kbd> + <kbd>E</kbd> will bring you to the end of the
command.</li>
</ul>
<hr>
<p><strong>Exercise</strong></p>
<ol style="list-style-type: decimal">
<li>Checking the <code>history</code> command output, how many commands
have you typed in so far?</li>
<li>Use the <button>up</button> arrow key to check the command you typed
before the <code>history</code> command. What is it? Does it make
sense?</li>
<li>Type several random characters on the command prompt. Can you bring
the cursor to the start with <button>Ctrl</button> + <button>A</button>?
Next, can you bring the cursor to the end with <button>Ctrl</button> +
<button>E</button>? Finally, what happens when you use
<button>Ctrl</button> + <button>C</button>?</li>
</ol>
<hr>
</div>
</div>
</section><section><h2 class="section-heading" id="summary-commands-options-and-keystrokes-covered">Summary: Commands, options, and keystrokes covered<a class="anchor" aria-label="anchor" href="#summary-commands-options-and-keystrokes-covered"></a>
</h2>
<hr class="half-width">
<pre><code>~           # home dir
.           # current dir
..          # parent dir
*           # wildcard
ctrl + c    # cancel current command
ctrl + a    # start of line
ctrl + e    # end of line
history</code></pre>
<hr></section><section><h2 class="section-heading" id="advanced-bash-commands-and-utilities">Advanced Bash Commands and Utilities<a class="anchor" aria-label="anchor" href="#advanced-bash-commands-and-utilities"></a>
</h2>
<hr class="half-width">
<p>As you begin working more with the Shell, you will discover that
there are mountains of different utilities at your fingertips to help
increase command-line productivity. So far, we have introduced you to
some of the basics to help you get started. In this lesson, we will
touch on more advanced topics that can be very useful as you conduct
analyses in a cluster environment.</p>
<hr></section><section><h2 class="section-heading" id="configuring-your-shell">Configuring your shell <a name="config"></a>
<a class="anchor" aria-label="anchor" href="#configuring-your-shell"></a>
</h2>
<hr class="half-width">
<p>In your home directory, there are two hidden files,
<code>.bashrc</code> and <code>.bash_profile</code>. These files contain
all the startup configuration and preferences for your command line
interface and are loaded before your Terminal loads the shell
environment. Modifying these files allows you to change your preferences
for features like your command prompt, the colors of text, and add
aliases for commands you use all the time.</p>
<blockquote>
<p><strong>NOTE:</strong> These files begin with a dot (<code>.</code>)
which makes it a hidden file. To view all hidden files in your home
directory, you can use:</p>
<p><code>$ ls -al ~/</code></p>
</blockquote>
<div class="section level3">
<h3 id="bashrc-versus--bash_profile">
<code>.bashrc</code> versus <code>.bash_profile</code>
<a name="bashrc"></a>
<a class="anchor" aria-label="anchor" href="#bashrc-versus--bash_profile"></a>
</h3>
<p>You can put configurations in either file, and you can create either
if it doesn’t exist. <strong>But why two different files? What is the
difference?</strong></p>
<p>The difference is that <strong><code>.bash_profile</code> is executed
for login shells, while <code>.bashrc</code> is executed for interactive
non-login shells</strong>. It is helpful to have these separate files
when there are preferences you only want to see on the login and not
every time you open a new terminal window. For example, suppose you
would like to print some lengthy diagnostic information about your
machine (load average, memory usage, current users, etc) - the
<code>.bash_profile</code> would be a good place since you would only
want in displayed once when starting out.</p>
<p>Most of the time you don’t want to maintain two separate
configuration files for login and non-login shells. For example, when
you export a <code>$PATH</code> (as we had done previously), you want it
to apply to both. You can do this by sourcing <code>.bashrc</code> from
within your <code>.bash_profile</code> file. Take a look at your
<code>.bash_profile</code> file, it has already been done for you:</p>
<div class="codewrapper sourceCode" id="cb112">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="ex">$</span> less ~/.bash_profile</span></code></pre>
</div>
<p>You should see the following lines:</p>
<div class="codewrapper sourceCode" id="cb113">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-f</span> ~/.bashrc <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>   <span class="bu">source</span> ~/.bashrc</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a><span class="cf">fi</span></span></code></pre>
</div>
<p>What this means is that if a <code>.bashrc</code> files exist, all
configuration settings will be sourced upon logging in. Any settings you
would like applied to all shell windows (login and interactive) can
simply be added directly to the <code>.bashrc</code> file rather than in
two separate files.</p>
</div>
<div class="section level3">
<h3 id="changing-the-prompt">Changing the prompt<a class="anchor" aria-label="anchor" href="#changing-the-prompt"></a>
</h3>
<p>In your file <code>.bash_profile</code>, you can change your prompt
by adding this:</p>
<div class="codewrapper sourceCode" id="cb114">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="va">PS1</span><span class="op">=</span><span class="st">"\[\033[35m\]\t\[\033[m\]-\[\033[36m\]\u\[\033[m\]@</span><span class="va">$HOST_COLOR</span><span class="st">\h:\[\033[33;1m\]\w\[\033[m\]</span><span class="dt">\$</span><span class="st"> "</span></span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a><span class="bu">export</span> <span class="va">PS1</span></span></code></pre>
</div>
<p>You have yet to learn how to edit text files. Keep in mind that when
you know how to edit files, you can test this trick. After editing the
file, you need to source it or restart your terminal.</p>
<div class="codewrapper sourceCode" id="cb115">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="bu">source</span> ~/.bash_profile</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="aliases">Aliases <a name="alias"></a>
<a class="anchor" aria-label="anchor" href="#aliases"></a>
</h3>
<p>An alias is a short name that the shell translates into another
(usually longer) name or command. They are typically placed in the
<code>.bash_profile</code> or <code>.bashrc</code> startup files so that
they are available to all subshells. You can use the <code>alias</code>
built-in command without any arguments, and the <strong>shell will
display a list of all defined aliases</strong>:</p>
<div class="codewrapper sourceCode" id="cb116">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="ex">$</span> alias</span></code></pre>
</div>
<p>This should return to you the list of aliases that have been set for
you, and you can see <strong>the syntax used for setting an alias
is</strong>:</p>
<div class="codewrapper sourceCode" id="cb117">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="bu">alias</span> aliasname=value</span></code></pre>
</div>
<p>When setting an alias <strong>no spaces are permitted around the
equal sign</strong>. If value contains spaces or tabs, you must enclose
the value within quotation marks. <code>ll</code> is a common alias that
people use, and it is a good example of this:</p>
<div class="codewrapper sourceCode" id="cb118">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="bu">alias</span> ll=<span class="st">'ls -l'</span></span></code></pre>
</div>
<p>Since we have a modifier <code>-l</code> and there is a space
required, the quotations are necessary.</p>
<p>Let’s <strong>setup our own alias</strong>! Every time we want to
start an interactive session we have type out this lengthy command.
Wouldn’t it be great if we could type in a short name instead? Open up
the <code>.bashrc</code> file using <code>vim</code>:</p>
<div class="codewrapper sourceCode" id="cb119">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="ex">$</span> vim ~/.bashrc</span></code></pre>
</div>
<p>Scroll down to the heading
“<code># User specific aliases and functions</code>,” and on the next
line, you can set your alias:</p>
<div class="codewrapper sourceCode" id="cb120">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="bu">alias</span> sq=<span class="st">'squeue --me'</span></span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="symbolic-links">Symbolic links <a name="symlinks"></a>
<a class="anchor" aria-label="anchor" href="#symbolic-links"></a>
</h2>
<hr class="half-width">
<p>A symbolic link is a kind of “file” that is <strong>essentially a
pointer to another file name</strong>. Symbolic links can be made to
directories or across file systems with no restrictions. You can also
make a symbolic link to a name that is not the name of any file.
(Opening this link will fail until a file by that name is created.)
Likewise, if the symbolic link points to an existing file which is later
deleted, the symbolic link continues to point to the same file name even
though the name no longer names any file.</p>
<p>The basic syntax for creating a symlink is:</p>
<div class="codewrapper sourceCode" id="cb121">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> /path/to/file /path/to/symlink</span></code></pre>
</div>
<p>There is a scratch folder under the variable $SCRATCH. You can create
a symbolic link to that location from your $HOME</p>
<p>And then we can symlink the files:</p>
<div class="codewrapper sourceCode" id="cb122">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="ex">$</span> cd</span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a><span class="ex">$</span> ln <span class="at">-s</span> <span class="va">$SCRATCH</span> scratch</span></code></pre>
</div>
<p>Now, if you check the directory where we created the symlinks, you
should see the filenames listed in cyan text followed by an arrow
pointing to the actual file location. (<em>NOTE: If your files are
flashing red text, this is an indication your links are broken so you
might want to double check the paths.</em>)</p>
<div class="codewrapper sourceCode" id="cb123">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="ex">$</span> ll ~/scratch</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="transferring-files-with-rsync">Transferring files with <code>rsync</code> <a name="rsync"></a>
<a class="anchor" aria-label="anchor" href="#transferring-files-with-rsync"></a>
</h2>
<hr class="half-width">
<p>When <strong>transferring large files or a large number of files,
<code>rsync</code> is a better command</strong> to use.
<code>rsync</code> employs a special delta transfer algorithm and a few
optimizations to make the operation a lot faster. <strong>It will check
file sizes and modification timestamps</strong> of both file(s) to be
copied and the destination and skip any further processing if they
match. If the destination file(s) already exists, the delta transfer
algorithm will <strong>make sure only differences between the two are
sent over.</strong></p>
<p>There are many modifiers for the <code>rsync</code> command, but in
the examples below, we only introduce a select few that we commonly use
during file transfers.</p>
<p><strong>Example 1:</strong></p>
<pre><code>rsync -t --progress /path/to/transfer/files/*.c /path/to/destination</code></pre>
<p>This command would transfer all files matching the pattern *.c from
the transfer directory to the destination directory. If any of the files
already exist at the destination, then the rsync remote-update protocol
is used to update the file by sending only the differences.</p>
<p><strong>Example 2:</strong></p>
<pre><code><span><span class="va">rsync</span> <span class="op">-</span><span class="va">avr</span> <span class="op">-</span><span class="op">-</span><span class="va">progress</span> <span class="op">/</span><span class="va">path</span><span class="op">/</span><span class="va">to</span><span class="op">/</span><span class="va">transfer</span><span class="op">/</span><span class="va">directory</span> <span class="op">/</span><span class="va">path</span><span class="op">/</span><span class="va">to</span><span class="op">/</span><span class="va">destination</span></span></code></pre>
<p>This command would recursively transfer all files from the transfer
directory into the destination directory. The files are transferred in
“archive” mode (<code>-a</code>), which ensures that symbolic links,
devices, attributes, permissions, ownerships, etc., are preserved in the
transfer. In both commands, we have additional modifiers for verbosity
so we have an idea of how the transfer is progressing (<code>-v</code>,
<code>--progress</code>)</p>
<blockquote>
<p><strong>NOTE:</strong> A trailing slash on the transfer directory
changes the behavior to avoid creating an additional directory level at
the destination. You can think of a trailing <code>/</code> as meaning
“copy the contents of this directory” as opposed to “copy the directory
by name”.</p>
</blockquote>
<hr>
<p><em>This lesson has been adapted from several sources, including the
materials from the <a href="https://bioinformatics.sph.harvard.edu/" class="external-link">Harvard Chan
Bioinformatics Core (HBC)</a>. These are open-access materials
distributed under the terms of the <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">Creative Commons
Attribution license</a> (CC BY 4.0), which permits unrestricted use,
distribution, and reproduction in any medium, provided the original
author and source are credited.</em></p>
<ul>
<li><em>The materials used in this lesson were also derived from work
that is Copyright © Data Carpentry (<a href="https://datacarpentry.org/" class="external-link uri">https://datacarpentry.org/</a>). All Data Carpentry
instructional material is made available under the <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">Creative Commons
Attribution license</a> (CC BY 4.0).</em></li>
<li><em>Adapted from the lesson by Tracy Teal. Original contributors:
Paul Wilson, Milad Fatenejad, Sasha Wood, and Radhika Khetani for
Software Carpentry (<a href="https://software-carpentry.org/" class="external-link uri">https://software-carpentry.org/</a>)</em></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li><p>Get sufficient familiarity with basic comands such as
<code>ls</code>, <code>cp</code>, <code>cd</code>, <code>pwd</code> and
<code>rm</code></p></li>
<li>
<p>If you want to know extra arguments for command that you know use
the command <code>man</code></p>
<pre><code>~$ man ls</code></pre>
</li>
<li><p>Most Linux/UNIX commands are just programs that have existed for
decades and whose use has been for most part standarized overtime. The
commands that you learn will serve you in the future so it is a fruitful
investment.</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-201-editors"><p>Content from <a href="201-editors.html">Terminal-based Text Editors: nano, emacs and vim</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/201-editors.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“How do I edit text files from the terminal?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Learn about three major editor in Linux/Unix: vim, emacs and
nano”</li>
<li>“Learn the basic key combinations and operation of those
editors”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="terminal-based-text-editors">Terminal-based Text Editors<a class="anchor" aria-label="anchor" href="#terminal-based-text-editors"></a>
</h2>
<hr class="half-width">
<iframe width="560" height="315" src="https://www.youtube.com/embed/S6Qa2raf30o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>During your interaction with the cluster from the command line you
need to deal with text files. As we learn from the previous episode, for
just reading files, we can use the commands <code>cat</code>,
<code>more</code> and <code>less</code>. For modifying text files we
need a different application, a text editor. Notice that on the cluster
we are working with pure text files in contrast with office applications
like Microsoft Word and equivalent free versions like LibreOffice. Those
applications are called “Word Processors” as they not only deal with the
text content but they also are in charge of the control how the text is
presented on screen and on paper. “Word Processors” are not the same as
“Text Editors” and for most cases “Word Processors” are of no use in HPC
clusters.</p>
<p>Text editors work just with the characters, spaces and new lines.
When a file only contain those elements without any information about
formatting, the file is said is in “Plain Text”. There is one important
difference on how Windows and Linux/Linux marks new lines, making
Windows “Text Files” as having some extra “spurious” characters at the
end of each line and text files created on Linux as having no new lines
at all when read with Windows applications like “Notepad”. To solve this
situation, there are a couple of applications on Linux that convert from
one “flavor” of text file into the other. They are “dos2unix” and
“unix2dos”.</p>
<p>There are several terminal-based text editors available on
Linux/Unix. From those we have selected three to present on this episode
for you. They are <strong>nano</strong>, <strong>emacs</strong>, and
<strong>vim</strong>. Your choice of an editor depends mostly on how
much functionality do you want from your editor, how many fingers do you
want to use for a given command, and the learning curve to master it.
There is nothing wrong of using one of those editors over the others.
Beginners of user who rarely edit files would find <strong>nano</strong>
a pretty fine and simple editor for their needs that has basically no
learning curve. If you advance deeper into the use of the cluster and
edit files often your choice will be most likely one between
<strong>emacs</strong> or <strong>vi/vim</strong> with the choice being
mostly a matter of preference as both are full featured editors.</p>
<p><strong>nano</strong> and <strong>emacs</strong> are <em>direct input
editors</em>, ie you start writing directly as soon as you type with the
keyboard. In contrast <strong>vi/vim</strong> is a <em>modal</em>
editor. You type keys to change modes on the editor, some of these keys
allowing you to start typing or return to <em>command mode</em> where
new commands can be entered. In any case there are quite a large number
of commands and key combinations that can be entered on any of those
editors. For this episode we will concentrate our attention on a very
specific set of skills that once learned will give you to work with text
files. The skills are:</p>
<ul>
<li>Open the editor to open a file, save the file that is being edited
or saving the file and leaving the editor.</li>
<li>Move around the file being edited. Going to the beginning, the end
or a specific line.</li>
<li>Copy, cut and paste text on the same file.</li>
<li>Search for a set of characters and use the search and replace
functionality.</li>
</ul>
<p>There is far more to learn in a text editor, each of those skills can
be go deeper into more complex functionality and that is the major
difference between <strong>nano</strong> and the other two editor, the
later giving you far more complexity and power in the skills at the
price of a steeper learning curve.</p>
</section><section><h2 class="section-heading" id="meta-alt-and-option-keys">Meta, Alt and Option keys<a class="anchor" aria-label="anchor" href="#meta-alt-and-option-keys"></a>
</h2>
<hr class="half-width">
<p>On modern keyboards the <kbd>Alt</kbd> key has come to replace the
<kbd>Meta</kbd> key of the old MIT keyboards. Both <strong>nano</strong>
and <strong>emacs</strong> make extensive use of <kbd>Meta</kbd> for
some key combinations. A situation that can be confusing on windows
machines with <kbd>Alt</kbd> and <kbd>Win</kbd> keys and on Mac with the
<kbd>Option</kbd> and <kbd>Command</kbd> keys.</p>
<p>Since the 1990s <kbd>Alt</kbd> has been printed on the
<kbd>Option</kbd> key (⌥ Opt) on most Mac keyboards. Alt is used in
non-Mac software, such as non-macOS Unix and Windows programs, but in
macOS it is always referred as the Option key. The <kbd>Option</kbd>
key’s behavior in macOS differs slightly from that of the Windows
<kbd>Alt</kbd> key (it is used as a modifier rather than to access
pull-down menus, for example).</p>
<p>On Macs Terminal application under the “Edit” &gt; “Use Option as
Meta key”. For <strong>emacs</strong> you can use <kbd>ESC</kbd> as a
replacement of the <kbd>Meta</kbd> key.</p>
<div class="section level3">
<h3 id="nano">Nano<a class="anchor" aria-label="anchor" href="#nano"></a>
</h3>
<p>Nano is a small andfriendly editor with commands that are generally
accessed by using Control (<kbd>Ctrl</kbd>) combined with some other
key.</p>
<div class="section level4">
<h4 id="opening-and-closing-the-editor">Opening and closing the editor<a class="anchor" aria-label="anchor" href="#opening-and-closing-the-editor"></a>
</h4>
<p>You can start editing a file using a command line like this:</p>
<pre><code>$ nano myfile.f90</code></pre>
<p>To leave the editor type <kbd>Ctrl</kbd>+<kbd>X</kbd>, you will be
asked if you want to save your file to disk. Another option is to save
the file with <kbd>Ctrl</kbd>+<kbd>O</kbd> but remaing on the
editor.</p>
</div>
<div class="section level4">
<h4 id="moving-around-the-file">Moving around the file<a class="anchor" aria-label="anchor" href="#moving-around-the-file"></a>
</h4>
<p>On <strong>nano</strong> you can start typing as soon you open the
file and the arrow keys will move you back and for on the same line or
up and down on lines. For large files is always good to learn how to
move to the begining and end of the file. Use
<kbd>Meta</kbd>+<kbd>&lt;/kbd&gt; and <kbd>Meta</kbd>+<kbd>/</kbd> to do
that. Those key combinations are also shown as <code>M-\</code> (first
line) <code>M-/</code> (last line). To move to a specific line and
column number use <kbd>Ctrl</kbd>+<kbd>_</kbd>, shown on the bottom bar
as <code>^_</code></kbd></p>
</div>
<div class="section level4">
<h4 id="copy-cut-and-paste">Copy, cut and paste<a class="anchor" aria-label="anchor" href="#copy-cut-and-paste"></a>
</h4>
<p>The use the internal capabilities of the text editor to copy and
paste starts by selecting the area of text that you want to copy or cut.
Use <kbd>Meta</kbd>+<kbd>A</kbd> to start selecting the area to copy use
<kbd>Meta</kbd>+<kbd>6</kbd> to delete use
<kbd>Meta</kbd>+<kbd>Delete</kbd>, to cut but save the contents
<kbd>Ctrl</kbd>+<kbd>K</kbd> to paste the contents of the region
<kbd>Ctrl</kbd>+<kbd>U</kbd></p>
</div>
<div class="section level4">
<h4 id="search-for-text-and-search-and-replace">Search for text and search and Replace<a class="anchor" aria-label="anchor" href="#search-for-text-and-search-and-replace"></a>
</h4>
<p>To search use <kbd>Ctrl</kbd>+<kbd>W</kbd>, you can repeat the
command to searching for more matches, to search and replace use
<kbd>Ctrl</kbd>+<kbd>&lt;/kbd&gt; enter the text to search and the text
to replace in place.</kbd></p>
</div>
<div class="section level4">
<h4 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h4>
<p>Beyond the quick commands above, there are several commands available
on <strong>nano</strong>, and the list below comes from the help text
that you can see when execute <kbd>Ctrl</kbd>+<kbd>G</kbd>. When you see
the symbol "^", it means to press the Control <kbd>Ctrl</kbd> key; the
symbol "M-" is called Meta, but in most keyboards is identified with the
<kbd>Alt</kbd> key or <kbd>Windows</kbd> key. See above for the
discussion about the use of <kbd>Meta</kbd> key.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">^G</span>  <span class="er">(</span><span class="ex">F1</span><span class="kw">)</span>            <span class="ex">Display</span> this help text</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">^X</span>  <span class="er">(</span><span class="ex">F2</span><span class="kw">)</span>            <span class="ex">Close</span> the current file buffer / Exit from nano</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="ex">^O</span>  <span class="er">(</span><span class="ex">F3</span><span class="kw">)</span>            <span class="ex">Write</span> the current file to disk</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="ex">^J</span>  <span class="er">(</span><span class="ex">F4</span><span class="kw">)</span>            <span class="ex">Justify</span> the current paragraph</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="ex">^R</span>  <span class="er">(</span><span class="ex">F5</span><span class="kw">)</span>            <span class="ex">Insert</span> another file into the current one</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="ex">^W</span>  <span class="er">(</span><span class="ex">F6</span><span class="kw">)</span>            <span class="ex">Search</span> for a string or a regular expression</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="ex">^Y</span>  <span class="er">(</span><span class="ex">F7</span><span class="kw">)</span>            <span class="ex">Move</span> to the previous screen</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="ex">^V</span>  <span class="er">(</span><span class="ex">F8</span><span class="kw">)</span>            <span class="ex">Move</span> to the next screen</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="ex">^K</span>  <span class="er">(</span><span class="ex">F9</span><span class="kw">)</span>            <span class="ex">Cut</span> the current line and store it in the cutbuffer</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="ex">^U</span>  <span class="er">(</span><span class="ex">F10</span><span class="kw">)</span>           <span class="ex">Uncut</span> from the cutbuffer into the current line</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="ex">^C</span>  <span class="er">(</span><span class="ex">F11</span><span class="kw">)</span>           <span class="ex">Display</span> the position of the cursor</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="ex">^T</span>  <span class="er">(</span><span class="ex">F12</span><span class="kw">)</span>           <span class="ex">Invoke</span> the spell checker, if available</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="ex">^_</span>  <span class="er">(</span><span class="ex">F13</span><span class="kw">)</span>   <span class="kw">(</span><span class="ex">M-G</span><span class="kw">)</span>   <span class="ex">Go</span> to line and column number</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="ex">^\ </span> <span class="er">(</span><span class="ex">F14</span><span class="kw">)</span>   <span class="kw">(</span><span class="ex">M-R</span><span class="kw">)</span>   <span class="ex">Replace</span> a string or a regular expression</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="ex">^^</span>  <span class="er">(</span><span class="ex">F15</span><span class="kw">)</span>   <span class="kw">(</span><span class="ex">M-A</span><span class="kw">)</span>   <span class="ex">Mark</span> text at the cursor position</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>    <span class="kw">(</span><span class="ex">F16</span><span class="kw">)</span>   <span class="kw">(</span><span class="ex">M-W</span><span class="kw">)</span>   <span class="ex">Repeat</span> last search</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="ex">M-^</span>         <span class="er">(</span><span class="ex">M-6</span><span class="kw">)</span>   <span class="ex">Copy</span> the current line and store it in the cutbuffer</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="ex">M-}</span>                 Indent the current line</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="ex">M-{</span>                 Unindent the current line</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="ex">^F</span>                  Move forward one character</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="ex">^B</span>                  Move back one character</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="ex">^Space</span>              Move forward one word</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="ex">M-Space</span>             Move back one word</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="ex">^P</span>                  Move to the previous line</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="ex">^N</span>                  Move to the next line</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="ex">^A</span>                  Move to the beginning of the current line</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="ex">^E</span>                  Move to the end of the current line</span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="ex">M-</span><span class="er">(</span>         <span class="kw">(</span><span class="ex">M-9</span><span class="kw">)</span>   <span class="ex">Move</span> to the beginning of the current paragraph</span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="ex">M-</span><span class="kw">)</span>         <span class="kw">(</span><span class="ex">M-0</span><span class="kw">)</span>   <span class="ex">Move</span> to the end of the current paragraph</span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="ex">M-\ </span>        <span class="er">(</span><span class="ex">M-</span><span class="kw">|)</span>   <span class="ex">Move</span> to the first line of the file</span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="ex">M-/</span>         <span class="er">(</span><span class="ex">M-?</span><span class="kw">)</span>   <span class="ex">Move</span> to the last line of the file</span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a><span class="ex">M-]</span>                 Move to the matching bracket</span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a><span class="ex">M--</span>                 Scroll up one line without scrolling the cursor</span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a><span class="ex">M-+</span>         <span class="er">(</span><span class="ex">M-=</span><span class="kw">)</span>   <span class="ex">Scroll</span> down one line without scrolling the cursor</span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a><span class="ex">M-</span><span class="op">&lt;</span>         <span class="er">(</span><span class="ex">M-,</span><span class="kw">)</span>   <span class="ex">Switch</span> to the previous file buffer</span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="ex">M-</span><span class="op">&gt;</span>         <span class="er">(</span><span class="ex">M-.</span><span class="kw">)</span>   <span class="ex">Switch</span> to the next file buffer</span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a><span class="ex">M-V</span>                 Insert the next keystroke verbatim</span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a><span class="ex">^I</span>                  Insert a tab at the cursor position</span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a><span class="ex">^M</span>                  Insert a newline at the cursor position</span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="ex">^D</span>                  Delete the character under the cursor</span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a><span class="ex">^H</span>                  Delete the character to the left of the cursor</span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="ex">M-T</span>                 Cut from the cursor position to the end of the file</span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a><span class="ex">M-J</span>                 Justify the entire file</span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a><span class="ex">M-D</span>                 Count the number of words, lines, and characters</span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a><span class="ex">^L</span>                  Refresh <span class="er">(</span><span class="ex">redraw</span><span class="kw">)</span> <span class="ex">the</span> current screen</span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a><span class="ex">M-X</span>                 Help mode enable/disable</span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a><span class="ex">M-C</span>                 Constant cursor position display enable/disable</span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a><span class="ex">M-O</span>                 Use of one more line for editing enable/disable</span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a><span class="ex">M-S</span>                 Smooth scrolling enable/disable</span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a><span class="ex">M-P</span>                 Whitespace display enable/disable</span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a><span class="ex">M-Y</span>                 Color syntax highlighting enable/disable</span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a><span class="ex">M-H</span>                 Smart home key enable/disable</span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a><span class="ex">M-I</span>                 Auto indent enable/disable</span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a><span class="ex">M-K</span>                 Cut to end enable/disable</span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a><span class="ex">M-L</span>                 Long line wrapping enable/disable</span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a><span class="ex">M-Q</span>                 Conversion of typed tabs to spaces enable/disable</span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a><span class="ex">M-B</span>                 Backup files enable/disable</span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a><span class="ex">M-F</span>                 Multiple file buffers enable/disable</span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a><span class="ex">M-M</span>                 Mouse support enable/disable</span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a><span class="ex">M-N</span>                 No conversion from DOS/Mac format enable/disable</span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a><span class="ex">M-Z</span>                 Suspension enable/disable</span></code></pre>
</div>
</div>
</div>
<div class="section level3">
<h3 id="emacs">Emacs<a class="anchor" aria-label="anchor" href="#emacs"></a>
</h3>
<p>Emacs is an extensible, customizable, open-source text editor.
Together with <strong>vi/vim</strong> is one the most widely used
editors in Linux/Unix environments. There are a big number of commands,
customization and extra modules that can be integrated with Emacs. We
will just briefly cover the basics as we did for
<strong>nano</strong></p>
<div class="section level4">
<h4 id="opening-and-closing-the-editor-1">Opening and closing the editor<a class="anchor" aria-label="anchor" href="#opening-and-closing-the-editor-1"></a>
</h4>
<p>In addition to the terminal-base editor, <strong>emacs</strong> also
has a GUI environment that could be selected by default. To ensure that
you remain in terminal-based version use:</p>
<pre><code>$ emacs -nw data.txt</code></pre>
<p>To leave the editor execute <kbd>Ctrl</kbd>+<kbd>X</kbd>
<kbd>C</kbd>, if you want to save the file to disk use
<kbd>Ctrl</kbd>+<kbd>X</kbd> <kbd>S</kbd>, another representation of the
keys to save and close could be <code>C-x C-s C-x C-c</code>, actually,
the <kbd>Ctrl</kbd> key can be keep pressed while you hit the sequence
<code>x s x c</code> to get the same effect.</p>
</div>
<div class="section level4">
<h4 id="moving-around-the-file-1">Moving around the file<a class="anchor" aria-label="anchor" href="#moving-around-the-file-1"></a>
</h4>
<p>To go to the beginning of the file use
<kbd>Meta</kbd>+<kbd>&lt;</kbd> to the end of the file
<kbd>Meta</kbd>+<kbd>&gt;</kbd>. To go to a given line number use
<kbd>Ctrl</kbd>+<kbd>g</kbd> <kbd>Ctrl</kbd>+<kbd>g</kbd></p>
</div>
<div class="section level4">
<h4 id="copy-cut-and-paste-1">Copy, cut and paste<a class="anchor" aria-label="anchor" href="#copy-cut-and-paste-1"></a>
</h4>
<p>To copy or cut regions of text starts by selecting the area of text
that you want to copy or cut. Use <kbd>Ctrl</kbd>+<kbd>Space</kbd> to
start selecting the area. To copy use <kbd>Meta</kbd>+<kbd>W</kbd> to
delete use <kbd>Ctrl</kbd>+<kbd>K</kbd>, to cut but save the contents
<kbd>Ctrl</kbd>+<kbd>W</kbd>. Finally, to paste the contents of the
region <kbd>Ctrl</kbd>+<kbd>Y</kbd></p>
</div>
<div class="section level4">
<h4 id="search-for-text-and-search-and-replace-1">Search for text and search and Replace<a class="anchor" aria-label="anchor" href="#search-for-text-and-search-and-replace-1"></a>
</h4>
<p>To search use <kbd>Ctrl</kbd>+<kbd>S</kbd>, you can repeat the
command to searching for more matchs, to search and replace use
<kbd>Meta</kbd>+<kbd>%</kbd> enter the text to search and the text to
replace in place.</p>
</div>
</div>
<div class="section level3">
<h3 id="reference-1">Reference<a class="anchor" aria-label="anchor" href="#reference-1"></a>
</h3>
<p>The number of commands for Emacs is large, here the basic list of
commands for editing, moving and searching text.</p>
<p>The best way of learning is keeping at hand a sheet of paper with the
commands For example <a href="https://www.gnu.org/software/emacs/refcards/pdf/refcard.pdf" class="external-link">GNU
Emacs Reference Card</a> can show you most commands that you need.</p>
<p>Below you can see the same 2 page Reference Card as individual
images.</p>
<p><a href="%7B%7B%20page.root%20%7D%7D/fig/refcard-0.png">
<img src="%7B%7B%20page.root%20%7D%7D/fig/refcard-0.png" alt="Emacs Ref Card" class="figure"></a></p>
<p><a href="%7B%7B%20page.root%20%7D%7D/fig/refcard-1.png">
<img src="%7B%7B%20page.root%20%7D%7D/fig/refcard-1.png" alt="Emacs Ref Card" class="figure"></a></p>
</div>
<div class="section level3">
<h3 id="vivim">Vi/Vim<a class="anchor" aria-label="anchor" href="#vivim"></a>
</h3>
<p>The third editor is <strong>vi</strong> and found by default
installed on Linux/Unix systems. The <em>Single UNIX Specification</em>
and <em>POSIX</em> describe <strong>vi</strong>, so every conforming
system must have it. A popular implementation of <strong>vi</strong> is
<strong>vim</strong> that stands as an improved version. On our clusters
we have <strong>vim</strong> installed.</p>
<div class="section level4">
<h4 id="opening-and-closing-the-editor-2">Opening and closing the editor<a class="anchor" aria-label="anchor" href="#opening-and-closing-the-editor-2"></a>
</h4>
<p>You can open a file on <strong>vim</strong> with</p>
<pre><code>$ vim code.py</code></pre>
<p>{: .language-bash }</p>
<p>vi is a modal editor: it operates in either <em>insert mode</em>
(where typed text becomes part of the document) or <em>normal mode</em>
(where keystrokes are interpreted as commands that control the edit
session). For example, typing i while in normal mode switches the editor
to insert mode, but typing i again at this point places an "i" character
in the document. From insert mode, pressing <kbd>ESC</kbd> switches the
editor back to normal mode. On the lines below we ask for pressing the
<kbd>ESC</kbd> in case you are in <em>insert mode</em> to ensure you get
back to <em>normal mode</em></p>
<p>To leave the editor without saving type <kbd>ESC</kbd> follow by
<code>:q!</code>. To leave the editor saving the file type
<kbd>ESC</kbd> follow by <code>:x</code> To just save the file and
continue editing type <kbd>ESC</kbd> follow by <code>:w</code>.</p>
</div>
<div class="section level4">
<h4 id="moving-around-the-file-2">Moving around the file<a class="anchor" aria-label="anchor" href="#moving-around-the-file-2"></a>
</h4>
<p>On vim you can use the arrow keys to move around. In the traditional
<strong>vi</strong> you have to use the following keys (on normal
mode):</p>
<ul>
<li>
<kbd>H</kbd> Left</li>
<li>
<kbd>J</kbd> Down</li>
<li>
<kbd>K</kbd> Up</li>
<li>
<kbd>L</kbd> Right</li>
</ul>
<p>Go to the first line using <kbd>ESC</kbd> follow by <code>:1</code>.
Go to the last line using <kbd>ESC</kbd> follow by <code>:$</code>.</p>
</div>
<div class="section level4">
<h4 id="copy-cut-and-paste-2">Copy, cut and paste<a class="anchor" aria-label="anchor" href="#copy-cut-and-paste-2"></a>
</h4>
<p>To copy areas of text you start by entering in visual mode with
<kbd>v</kbd>, selecting the area of interest and using <kbd>d</kbd> to
delete, <kbd>y</kbd> to copy and <kbd>p</kbd> to paste.</p>
</div>
<div class="section level4">
<h4 id="search-for-text-and-search-and-replace-2">Search for text and search and Replace<a class="anchor" aria-label="anchor" href="#search-for-text-and-search-and-replace-2"></a>
</h4>
<p>To search use <kbd>/</kbd> and the text you want to search, you can
repeat the command to searching for more matches with <kbd>n</kbd>, to
search and replace use
<code>:%s/&lt;search pattern&gt;/&lt;replace text&gt;/g</code> enter the
text to search and the text to replace everywhere. Use
<code>:%s/&lt;search pattern&gt;/&lt;replace text&gt;/gc</code> to ask
for confirmation before each modification.</p>
</div>
</div>
<div class="section level3">
<h3 id="reference-2">Reference<a class="anchor" aria-label="anchor" href="#reference-2"></a>
</h3>
<p>A very beautiful Reference Card for vim can be found here: <a href="https://vimcheatsheet.com/" class="external-link">Vim CheatSheet</a></p>
<p><a href="https://external-preview.redd.it/iigrixvxp5aYN9ox7Gr1dfI_rhLRotWlLsCafjJqjEQ.png?auto=webp&amp;s=1594ddc17408cb9186a73c2a6d1a1bf1e00769dd" class="external-link">
<img src="https://external-preview.redd.it/iigrixvxp5aYN9ox7Gr1dfI_rhLRotWlLsCafjJqjEQ.png?auto=webp&amp;s=1594ddc17408cb9186a73c2a6d1a1bf1e00769dd" alt="Vim Ref Card" class="figure"></a></p>
<blockquote>
<h2 id="exercise-1">Exercise 1</h2>
<p>Select an editor. The challenge is write this code in a file called
<code>Sierpinski.c</code></p>
<pre><code>#include &lt;stdio.h&gt;

#define SIZE (1 &lt;&lt; 5)
int main()
{
    int x, y, i;
    for (y = SIZE - 1; y &gt;= 0; y--, putchar('\n')) {
        for (i = 0; i &lt; y; i++) putchar(' ');
        for (x = 0; x + y &lt; SIZE; x++)
            printf((x &amp; y) ? "  " : "* ");
    }
    return 0;
}
</code></pre>
<p>{: .source}</p>
<p>For those using <strong>vi</strong>, here is the challenge.
<strong>You cannot use the arrow keys</strong>. Not a single time! It is
pretty hard if you are not used to it, but it is a good exercise to
learn the commands.</p>
<p>Another interesting challenge is to write the line
<code>for (y = SIZE - 1; y &gt;= 0; y--, putchar('\n'))</code> and copy
and paste it to &gt; form the other 2 <em>for loops</em> in the code,
and editing only after being copied.</p>
<p>Once you have successfully written the source code, you can see your
hard work in action.</p>
<p>On the terminal screen, execute this:</p>
<pre><code>$ gcc Sierpinski.c -o Sierpinski</code></pre>
<p>This will compile your source code <code>Sierpinski.c</code> in C
into a binary executable called <code>Sierpinski</code>. Execute the
code with:</p>
<pre><code>$ ./Sierpinski</code></pre>
<p>The resulting output is kind of a surprise so I will not post it
here. The original code comes from <a href="https://www.rosettacode.org/wiki/Sierpinski_triangle#C" class="external-link">rosettacode.org</a></p>
<p>{: .challenge}</p>
</blockquote>
<blockquote>
<h2 id="exercise-2-needs-x11">Exercise 2 (Needs X11)</h2>
<p>On the folder
<code>workshops_hands-on/Introduction_HPC/4._Terminal-based_Editors</code>
you will find a Java code on file <code>JuliaSet.java</code>.</p>
<p>For this exercise you need to connect to the cluster with X11
support. On Thorny Flat that will be:</p>
<pre><code>$ ssh -X &lt;username&gt;@ssh.wvu.edu
$ ssh -X &lt;username&gt;@tf.hpc.wvu.edu</code></pre>
<p>Once you are there execute this command to load the Java compiler</p>
<pre><code>$ module load lang/java/jdk1.8.0_201</code></pre>
<p>Once you have loaded the module go to the folder
<code>workshops_hands-on/Introduction_HPC/4._Terminal-based_Editors</code>
and compile &gt; the Java code with this command</p>
<pre><code>$ javac JuliaSet.java</code></pre>
<p>and execute the code with:</p>
<pre><code>$ java JuliaSet</code></pre>
<p>A window should pop up on your screen. Now, use one of the editors
presented on this episode and do the changes mentioned on the source
code to made the code &gt; multithreaded. Repeat the same steps for
compiling and executing the code.</p>
<p>Change a bit the parameters on the code, the size of the window for
example or the constants CX and CY.</p>
<p>{: .challenge}</p>
</blockquote>
<blockquote>
<h2 id="exercise-3">Exercise 3</h2>
<p>On the folder
<code>workshops_hands-on/Introduction_HPC/4._Terminal-based_Editors</code>
there is a script <code>download-covid19.sh</code>. The script will
download an updated compilation of Official Covid-19 cases around the
world. Download the data about Covid 19 <code>owid-covid-data.csv</code>
using the command:</p>
<pre><code>$&gt; sh download-covid19.sh</code></pre>
<p>Open the file <code>owid-covid-data.csv</code> with your favorite
editor. Go to to the first and last line on that file. The file has too
many lines to be scrolled line by line.</p>
<p>Search for the line with the string
<code>United States,2021-06-30</code></p>
<p>{: .challenge}</p>
</blockquote>
<blockquote>
<h2 id="why-vi-was-programmed-to-not-use-the-arrow-keys">Why vi was
programmed to not use the arrow keys?</h2>
<p>From <a href="https://en.wikipedia.org/wiki/Vi" class="external-link">Wikipedia</a> with a
anecdotal story from <a href="https://www.theregister.co.uk/2003/09/11/bill_joys_greatest_gift/" class="external-link">The
register</a></p>
<p>Joy used a Lear Siegler ADM-3A terminal. On this terminal, the Escape
key was at the location now occupied by the Tab key on the widely used
IBM PC keyboard (on the left side of the alphabetic part of the
keyboard, one row above the middle row). This made it a convenient
choice for switching vi modes. Also, the keys h,j,k,l served double duty
as cursor movement keys and were inscribed with arrows, which is why vi
uses them in that way. The ADM-3A had no other cursor keys. Joy
explained that the terse, single character commands and the ability to
type ahead of the display were a result of the slow 300 baud modem he
used when developing the software and that he wanted to be productive
when the screen was painting slower than he could think.</p>
<p><a title="No machine-readable author provided. StuartBrady assumed (based on copyright claims). [CC BY-SA 3.0 (https://creativecommons.org/licenses/by-sa/3.0/)], via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:KB_Terminal_ADM3A.svg" class="external-link"><img width="512" alt="KB Terminal ADM3A" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/KB_Terminal_ADM3A.svg/512px-KB_Terminal_ADM3A.svg.png" class="figure"></a></p>
<p>{: .testimonial}</p>
</blockquote>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“There are three major editor in Linux/Unix: nano, emacs and
vim”</li>
<li>“Once decided for on text editor it is important to the basic key
combinations and operation of your editor of choice”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-202-software"><p>Content from <a href="202-software.html">Software on HPC Clusters: modules, conda and containers</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/202-software.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“What are the options to enable software packages on an HPC
cluster?”</li>
<li>“What are the differences between environment modules, conda, and
apptainer?”</li>
<li>“What are environment modules and how to use them?”</li>
<li>“How do I use and create conda environments?”</li>
<li>“How do I open a shell and execute commands on an
Apptainer/Singularity container?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Learn about the three main options to enable software on HPC
clusters.”</li>
<li>“Load and unload environment modules”</li>
<li>“Activate and change conda environments”</li>
<li>“Get a shell and execute commands inside singularity
containers.”</li>
<li>Explain how to use markdown with The Carpentries Workbench</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1>
<p>Many software packages are being executed on an HPC cluster daily.
Each area of science uses its own set of software packages. Sometimes,
the same software package is used in multiple versions, and those
versions must be available on the same HPC cluster. To solve all these
challenges, several options have been implemented on HPC clusters. The
different options offer various levels of isolation from the host
system, and some of these options are better suited for particular kinds
of software.</p>
<div class="section level2">
<h2 id="environment-modules">Environment Modules<a class="anchor" aria-label="anchor" href="#environment-modules"></a>
</h2>
<p><em>Environment modules</em> are a mechanism that easily enables
software by allowing administrators to install non-regular locations and
the user to adapt his/her environment to access those locations and use
the software installed there. By changing specific variables on the
shell, different versions of packages can be made visible to the shell
or to a script. <em>Environment modules</em> is a software package that
gives the user the ability to change the variables that the shell uses
to find executables and libraries. To better understand how
<em>environment modules</em> do their job it is essential to understand
the concept of variables in the shell and the particular role of special
variables called <em>environment variables</em></p>
<div class="section level3">
<h3 id="shell-variables-and-environment-variables">Shell variables and environment variables<a class="anchor" aria-label="anchor" href="#shell-variables-and-environment-variables"></a>
</h3>
<p>The shell is a programming language in itself. As with any
programming language, it has the ability to define placeholders for
storing values. Those placeholders are called variables and the shell
commands and shell scripts can be made use of them. Shell variables can
be created on the shell using the operator <code>=</code>. For
example:</p>
<pre><code>$ A=10
$ B=20</code></pre>
<p>Environment variables are shell variables that are exported, i.e.,
converted into global variables. The shell and many other command line
programs use a set of variables to control their behavior. Those
variables are called <strong>environment variables</strong> Think about
them as placeholders for information stored within the system that
passes data to programs launched in the shell.</p>
<p>To create an environment variable, you can first to create a variable
and make it and environment variable using the command
<code>export</code> followed by the name of the variable.</p>
<pre><code>$ A=10
$ B=20
$ export A
$ export B</code></pre>
<p>This procedure can be simplified with a single line that defines and
export the variable. Example:</p>
<pre><code>$ export A=10
$ export B=20</code></pre>
<p><strong>Environment Variables</strong> control CLI functionality.
They declare where to search for executable commands, where to search
for libraries, which language display messages to you, how you prompt
looks. Beyond the shell itself, <em>environment variables</em> are use
by many codes to control their own operation.</p>
<p>You can see all the variables currently defined by executing:</p>
<pre><code>$ env</code></pre>
<p>Environment variables are similar to the shell variables that you can
create of the shell. Shell variables can be used to store data and
manipulated during the life of the shell session. However, only
environment variables are visible by child processes created from that
shell. To clarify this consider this script:</p>
<pre><code>#!/bin/bash

echo A= $A
echo B= $B
C=$(( $A + $B ))
echo C= $C</code></pre>
<p>{: .source}</p>
<p>Now create two shell variables and execute the script, do the same
with environment variables and notice that now the script is able to see
the variables.</p>
<p>Some common environment variables commonly use by the shell are:</p>
<table class="table">
<colgroup>
<col width="63%">
<col width="36%">
</colgroup>
<thead><tr class="header">
<th align="left">Environment Variable</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">$USER</td>
<td align="left">Your username</td>
</tr>
<tr class="even">
<td align="left">$HOME</td>
<td align="left">The path to your home directory</td>
</tr>
<tr class="odd">
<td align="left">$PS1</td>
<td align="left">Your prompt</td>
</tr>
<tr class="even">
<td align="left">$PATH</td>
<td align="left">List of locations to search for executable
commands</td>
</tr>
<tr class="odd">
<td align="left">$MANPATH</td>
<td align="left">List of locations to search for manual pages</td>
</tr>
<tr class="even">
<td align="left">$LD_LIBRARY_PATH</td>
<td align="left">List of locations to search for libraries in
runtime</td>
</tr>
<tr class="odd">
<td align="left">$LIBRARY_PATH</td>
<td align="left">List of locations to search for libraries during
compilation (actually during linking)</td>
</tr>
</tbody>
</table>
<p>Those are just a few environment variables of common use. There are
many more. Changing them will change where executables are found, which
libraries are used and how the system behaves in general. That is why
managing the environment variables properly is so important on a
machine, and even more on a HPC cluster, a machine that runs many
different codes with different versions.</p>
<p>Here is where environment modules enter.</p>
</div>
<div class="section level3">
<h3 id="environment-modules-1">Environment Modules<a class="anchor" aria-label="anchor" href="#environment-modules-1"></a>
</h3>
<p>The modules software package allows you to dynamically modify your
user environment by using <strong>modulefiles</strong>.</p>
<p>Each module file contains the information needed to configure the
shell for an application. After the module’s software package is
initialized, the environment can be modified on a per-module basis using
the module command, which interprets module files. Typically, module
files instruct the module command to alter or set shell environment
variables such as <code>PATH</code>, <code>MANPATH</code>, and others.
The module files can be shared by many users on a system, and users can
have their own collection to supplement or replace the shared module
files.</p>
<p>As a user, you can add and remove module files from the current
environment. The environment changes contained in a module file can also
be summarized through the module show command. You are welcome to change
modules in your <code>.bashrc</code> or <code>.cshrc</code>, but be
aware that some modules print information (to standard error) when
loaded. This should be directed to a file or <code>/dev/null</code> when
loaded in an initialization script.</p>
</div>
<div class="section level3">
<h3 id="basic-arguments">Basic arguments<a class="anchor" aria-label="anchor" href="#basic-arguments"></a>
</h3>
<p>The following table lists the most common module command options.</p>
<table class="table">
<colgroup>
<col width="40%">
<col width="59%">
</colgroup>
<thead><tr class="header">
<th align="left">Command</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">module list</td>
<td align="left">Lists modules currently loaded in a user’s
environment.</td>
</tr>
<tr class="even">
<td align="left">module avail</td>
<td align="left">Lists all available modules on a system.</td>
</tr>
<tr class="odd">
<td align="left">module show</td>
<td align="left">Shows environment changes that will be made by loading
a given module.</td>
</tr>
<tr class="even">
<td align="left">module load</td>
<td align="left">Loads a module.</td>
</tr>
<tr class="odd">
<td align="left">module unload</td>
<td align="left">Unloads a module.</td>
</tr>
<tr class="even">
<td align="left">module help</td>
<td align="left">Shows help for a module.</td>
</tr>
<tr class="odd">
<td align="left">module swap</td>
<td align="left">Swaps a currently loaded module for an unloaded
module.</td>
</tr>
</tbody>
</table>
<blockquote>
<h3 id="exercise-using-modulefiles">Exercise: Using modulefiles</h3>
<ol style="list-style-type: decimal">
<li><p>Check the modules that you currently have and clean (purge) your
environment from them. Check again and confirm that no module is
loaded.</p></li>
<li><p>Check which versions of Python, R, and GCC you have from the RHEL
itself. Try to get and idea of how old those three components are. For
python and R, all that you have to do is enter the corresponding command
(<code>R</code> or <code>python</code>). For GCC you need to use
<code>gcc --version</code> and see the date of those programs.</p></li>
<li>
<p>Now let’s get a newer version of those three components by
loading the corresponding modules. Search for the module for Python
3.10.11, R 4.4.1, and GCC 9.3.0 and load the corresponding modules. To
make things easier, you can use check the availability of modules just
in the languages section.</p>
<pre><code>module avail lang</code></pre>
<p>{: .source}</p>
<pre><code>module load lang/python/cpython_3.11.3_gcc122 lang/r/4.4.1_gcc122 lang/gcc/12.2.0 </code></pre>
<p>{: .source}</p>
</li>
<li>
<p>Check again which version of those three components you have now.
Notice that in the case of Python 3, the command python still goes
towards the old Python 2.6.6, as the Python 3.x interpreter is not
backward compatible with Python 2.x the new command is called
<code>python3</code>. Check its version by entering the command.</p>
<pre><code>~$ python3 --version</code></pre>
<p>{: .source}</p>
</li>
<li>
<p>Clean all of the environment</p>
<pre><code>~$ module purge</code></pre>
<p>{: .source}</p>
</li>
<li>
<p>Go back and purge all the modules from your environment. We will
now explore why it is essential to use a recent compiler. Try to compile
the code at
<code>workshops_hands-on/Introduction_HPC/5._Environment_Modules/lambda_c++14.cpp</code>.
Go to the folder and execute:</p>
<pre><code>~$ g++ lambda_c++14.cpp</code></pre>
<p>{: .source}</p>
<p>At this point, you should have received a list of errors, that is
because even if the code is C++ it uses elements of the language that
were not present at that time on C++ Specification. The code actually
uses C++14, and only recent versions of GCC allow for these
declarations. Let’s check how many GCC compilers we have available on
Thorny Flat.</p>
<pre><code>~$ module avail lang/gcc</code></pre>
<p>{: .source}</p>
<p>Now, from that list, start loading and trying to compile the code as
indicated above. Which versions of GCC allow you to compile the code?
Also try the Intel compilers. In the case of the Intel compiler, the
command to compile the code is:</p>
<pre><code>~$ icpc lambda_c++14.cpp</code></pre>
<p>{: .source}</p>
<p>Try with all the Intel compilers. It will fail with some of them.
That is because the default standard for the Intel C++ compiler is not
C++14. You do not need to declare it explicitly, and for Intel Compiler
Suite 2021, but for older versions, the correct command line is:</p>
<pre><code>~$ icpc lambda_c++14.cpp -std=c++14</code></pre>
<p>{: .source}</p>
</li>
</ol>
<p>It should be clearer why modules are an important feature of any HPC
infrastructure, as it allows you to use several compilers, libraries,
and packages in different versions. On a normal computer, you usually
have just one.</p>
<p>{: .source} {: .challenge}</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="conda">Conda<a class="anchor" aria-label="anchor" href="#conda"></a>
</h2>
<p>Conda is an open-source package management system and environment
management system. Conda quickly installs, runs, and updates packages
and their dependencies. Conda easily creates, saves, loads, and switches
between environments. It was created for Python programs, but it can
package and distribute software for any language.</p>
<p>Conda, as a package manager, helps you find and install packages. If
you need a package that requires a different version of Python, you do
not need to switch to a different environment manager because conda is
also an environment manager. With just a few commands, you can set up a
totally separate environment to run that different version of Python
while continuing to run your usual version of Python in your normal
environment.</p>
<p>There are two installers for conda, Anaconda and Miniconda.</p>
<div class="section level3">
<h3 id="anaconda-vs-miniconda">Anaconda vs Miniconda<a class="anchor" aria-label="anchor" href="#anaconda-vs-miniconda"></a>
</h3>
<p>Anaconda is a downloadable, free, open-source, high-performance, and
optimized Python and R distribution. Anaconda includes conda,
conda-build, Python, and 100+ automatically installed, open-source
scientific packages and their dependencies that have been tested to work
well together, including SciPy, NumPy, and many others. Ananconda is
more suited to be installed on a desktop environment as you get, after
installation, a fairly complete environment for scientific
computing.</p>
<p>On the other hand, Miniconda is a minimalistic installer for conda.
Miniconda is a small, bootstrap version of Anaconda that includes only
conda, Python, the packages they depend on, and a small number of other
useful packages, including pip, zlib, and a few others. Miniconda is
more suited for HPC environments where a minimal installation is all
that is needed, and users can create their own environments as
needed.</p>
</div>
<div class="section level3">
<h3 id="activating-conda-on-thorny-flat-and-dolly-sods">Activating Conda on Thorny Flat and Dolly Sods<a class="anchor" aria-label="anchor" href="#activating-conda-on-thorny-flat-and-dolly-sods"></a>
</h3>
<p>On Thorny Flat, the command to activate conda is:</p>
<pre><code>~$ source /shared/software/conda/conda_init.sh</code></pre>
<p>Or you can see the command line trying to load the module for
conda</p>
<pre><code>~$ module load conda</code></pre>
<p>After activation, you are positioned in the <code>base</code>
environment.</p>
<p>When you have activated <code>conda</code>, you are always inside a
conda environment. Initially, you start on the <code>base</code>
environment, and your prompt in the shell will include a prefix in
parentheses indicating the name of the conda environment you are
currently using.</p>
</div>
<div class="section level3">
<h3 id="conda-environments">Conda Environments<a class="anchor" aria-label="anchor" href="#conda-environments"></a>
</h3>
<p>Conda allows you to change your environment easily. It also gives you
tools to create new environments, change from one environment to
another, and install packages and their dependencies. Conda environments
will not interact with other environments, so you can easily keep
different versions of packages just by creating multiple
<code>conda</code> environments and populating those with the various
versions of software you want to use.</p>
<p>When you begin using conda, you already have a default environment
named <code>base</code>. You cannot install packages on the
<code>base</code> environment as that is a centrally managed
environment. You can, however, create new environments for installing
packages. Try to keep separate environments for different packages or
groups of packages. That reduces the chances of incompatibility between
them.</p>
</div>
<div class="section level3">
<h3 id="knowing-which-environments-are-available">Knowing which environments are available<a class="anchor" aria-label="anchor" href="#knowing-which-environments-are-available"></a>
</h3>
<p>At the time of this tutorial (2024), Thorny Flat offers the following
environments centrally installed::</p>
<pre><code>$&gt; conda env list

(base) trcis001:~$ conda env list
# conda environments:
#
base                    * /shared/software/conda
abienv_py36               /shared/software/conda/envs/abienv_py36
abienv_py37               /shared/software/conda/envs/abienv_py37
cutadaptenv               /shared/software/conda/envs/cutadaptenv
genomics_2024             /shared/software/conda/envs/genomics_2024
materials_2024            /shared/software/conda/envs/materials_2024
materials_2024_gcc93      /shared/software/conda/envs/materials_2024_gcc93
materials_discovery       /shared/software/conda/envs/materials_discovery
moose                     /shared/software/conda/envs/moose
neural_gpu                /shared/software/conda/envs/neural_gpu
picrust                   /shared/software/conda/envs/picrust
picrust2                  /shared/software/conda/envs/picrust2
python27                  /shared/software/conda/envs/python27
python35                  /shared/software/conda/envs/python35
python36                  /shared/software/conda/envs/python36
python37                  /shared/software/conda/envs/python37
qiime2-2022.8             /shared/software/conda/envs/qiime2-2022.8
qiime2-2023.2             /shared/software/conda/envs/qiime2-2023.2
qiime2-amplicon-2023.9    /shared/software/conda/envs/qiime2-amplicon-2023.9
qiime2-shotgun-2023.9     /shared/software/conda/envs/qiime2-shotgun-2023.9
qiime2-tiny-2023.9        /shared/software/conda/envs/qiime2-tiny-2023.9
r_4.2                     /shared/software/conda/envs/r_4.2
scipoptsuite              /shared/software/conda/envs/scipoptsuite
sourcetracker2            /shared/software/conda/envs/sourcetracker2
st2_py36                  /shared/software/conda/envs/st2_py36
st2_py37                  /shared/software/conda/envs/st2_py37
tensorflow18-py36         /shared/software/conda/envs/tensorflow18-py36</code></pre>
</div>
<div class="section level3">
<h3 id="activating-an-existing-environment">Activating an existing environment<a class="anchor" aria-label="anchor" href="#activating-an-existing-environment"></a>
</h3>
<p>Suppose that you want to use the environment called “tpd0001”. To
activate this environment, execute::</p>
<pre><code>conda activate tpd0001</code></pre>
</div>
<div class="section level3">
<h3 id="deactivating-the-current-environment">Deactivating the current environment<a class="anchor" aria-label="anchor" href="#deactivating-the-current-environment"></a>
</h3>
<p>The current environment can be deactivated with::</p>
<pre><code>conda deactivate</code></pre>
<p>If you are in the <code>base</code> environment, the deactivation
will not have any effect. You are always at least in the
<code>base</code> environment.</p>
</div>
<div class="section level3">
<h3 id="create-a-new-environment">Create a new environment<a class="anchor" aria-label="anchor" href="#create-a-new-environment"></a>
</h3>
<p>We will name the environment snowflakes and install the package
BioPython. At the Anaconda Prompt or in your terminal window, type the
following::</p>
<pre><code>(base) trcis001:~$ conda create --name snowflakes
Retrieving notices: ...working... done
Channels:
 - https://conda.software.inl.gov/public
 - conda-forge
Platform: linux-64
Collecting package metadata (repodata.json): done
Solving environment: done

## Package Plan ##

  environment location: /users/gufranco/.conda/envs/snowflakes



Proceed ([y]/n)? y

Preparing transaction: done
Verifying transaction: done
Executing transaction: done
#
# To activate this environment, use
#
#     $ conda activate snowflakes
#
# To deactivate an active environment, use
#
#     $ conda deactivate
</code></pre>
<p>From here you can activate your environment and install the packages
of your willing.</p>
<pre><code>(base) trcis001:~$ conda activate snowflakes
(snowflakes) trcis001:~$</code></pre>
<p>or if you want also to install a package you can execute::</p>
<pre><code>conda create --name snowflakes -c bioconda biopython</code></pre>
<p>Conda collects metadata about the package and its dependencies and
produces an installation plan::</p>
<pre><code>Channels:
 - bioconda
 - https://conda.software.inl.gov/public
 - conda-forge
Platform: linux-64
Collecting package metadata (repodata.json): done
Solving environment: done

## Package Plan ##

  environment location: /users/gufranco/.conda/envs/snowflakes

  added / updated specs:
    - biopython


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    biopython-1.70             |      np112py36_1         2.6 MB  bioconda
    ca-certificates-2024.7.4   |       hbcca054_0         151 KB  conda-forge
    ld_impl_linux-64-2.40      |       hf3520f5_7         691 KB  conda-forge
    libgcc-ng-14.1.0           |       h77fa898_0         822 KB  conda-forge
    libgomp-14.1.0             |       h77fa898_0         446 KB  conda-forge
    libpng-1.6.43              |       h2797004_0         281 KB  conda-forge
    libsqlite-3.46.0           |       hde9e2c9_0         845 KB  conda-forge
    libstdcxx-ng-14.1.0        |       hc0a3c3a_0         3.7 MB  conda-forge
    libwebp-base-1.4.0         |       hd590300_0         429 KB  conda-forge
    libzlib-1.2.13             |       h4ab18f5_6          60 KB  conda-forge
    mmtf-python-1.1.3          |     pyhd8ed1ab_0          25 KB  conda-forge
    ncurses-6.5                |       h59595ed_0         867 KB  conda-forge
    numpy-1.12.1               |py36_blas_openblash1522bff_1001         3.8 MB  conda-forge
    reportlab-3.5.68           |   py36h3e18861_0         2.4 MB  conda-forge
    sqlite-3.46.0              |       h6d4b2fc_0         840 KB  conda-forge
    zlib-1.2.13                |       h4ab18f5_6          91 KB  conda-forge
    zstd-1.5.6                 |       ha6fb4c9_0         542 KB  conda-forge
    ------------------------------------------------------------
                                           Total:        18.5 MB

The following NEW packages will be INSTALLED:

  _libgcc_mutex      conda-forge/linux-64::_libgcc_mutex-0.1-conda_forge
  _openmp_mutex      conda-forge/linux-64::_openmp_mutex-4.5-2_gnu
  biopython          bioconda/linux-64::biopython-1.70-np112py36_1
  blas               conda-forge/linux-64::blas-1.1-openblas
  ca-certificates    conda-forge/linux-64::ca-certificates-2024.7.4-hbcca054_0
  freetype           conda-forge/linux-64::freetype-2.12.1-h267a509_2
  jpeg               conda-forge/linux-64::jpeg-9e-h0b41bf4_3
  lcms2              conda-forge/linux-64::lcms2-2.12-hddcbb42_0
  ld_impl_linux-64   conda-forge/linux-64::ld_impl_linux-64-2.40-hf3520f5_7
  lerc               conda-forge/linux-64::lerc-3.0-h9c3ff4c_0
  libdeflate         conda-forge/linux-64::libdeflate-1.10-h7f98852_0
  libffi             conda-forge/linux-64::libffi-3.4.2-h7f98852_5
  libgcc-ng          conda-forge/linux-64::libgcc-ng-14.1.0-h77fa898_0
  libgfortran-ng     conda-forge/linux-64::libgfortran-ng-7.5.0-h14aa051_20
  libgfortran4       conda-forge/linux-64::libgfortran4-7.5.0-h14aa051_20
  libgomp            conda-forge/linux-64::libgomp-14.1.0-h77fa898_0
  libnsl             conda-forge/linux-64::libnsl-2.0.1-hd590300_0
  libpng             conda-forge/linux-64::libpng-1.6.43-h2797004_0
  libsqlite          conda-forge/linux-64::libsqlite-3.46.0-hde9e2c9_0
  libstdcxx-ng       conda-forge/linux-64::libstdcxx-ng-14.1.0-hc0a3c3a_0
  libtiff            conda-forge/linux-64::libtiff-4.3.0-h0fcbabc_4
  libwebp-base       conda-forge/linux-64::libwebp-base-1.4.0-hd590300_0
  libzlib            conda-forge/linux-64::libzlib-1.2.13-h4ab18f5_6
  mmtf-python        conda-forge/noarch::mmtf-python-1.1.3-pyhd8ed1ab_0
  msgpack-python     conda-forge/linux-64::msgpack-python-1.0.2-py36h605e78d_1
  ncurses            conda-forge/linux-64::ncurses-6.5-h59595ed_0
  numpy              conda-forge/linux-64::numpy-1.12.1-py36_blas_openblash1522bff_1001
  olefile            conda-forge/noarch::olefile-0.46-pyh9f0ad1d_1
  openblas           conda-forge/linux-64::openblas-0.3.3-h9ac9557_1001
  openjpeg           conda-forge/linux-64::openjpeg-2.5.0-h7d73246_0
  openssl            conda-forge/linux-64::openssl-1.1.1w-hd590300_0
  pillow             conda-forge/linux-64::pillow-8.3.2-py36h676a545_0
  pip                conda-forge/noarch::pip-21.3.1-pyhd8ed1ab_0
  python             conda-forge/linux-64::python-3.6.15-hb7a2778_0_cpython
  python_abi         conda-forge/linux-64::python_abi-3.6-2_cp36m
  readline           conda-forge/linux-64::readline-8.2-h8228510_1
  reportlab          conda-forge/linux-64::reportlab-3.5.68-py36h3e18861_0
  setuptools         conda-forge/linux-64::setuptools-58.0.4-py36h5fab9bb_2
  sqlite             conda-forge/linux-64::sqlite-3.46.0-h6d4b2fc_0
  tk                 conda-forge/linux-64::tk-8.6.13-noxft_h4845f30_101
  wheel              conda-forge/noarch::wheel-0.37.1-pyhd8ed1ab_0
  xz                 conda-forge/linux-64::xz-5.2.6-h166bdaf_0
  zlib               conda-forge/linux-64::zlib-1.2.13-h4ab18f5_6
  zstd               conda-forge/linux-64::zstd-1.5.6-ha6fb4c9_0


Proceed ([y]/n)?
</code></pre>
<p>{: .}</p>
<p>Conda asks if you want to proceed with the plan::</p>
<pre><code>Proceed ([y]/n)? y
Type "y" and press Enter to proceed.</code></pre>
<p>After that, conda, download, and install the packages, creating a new
environment for you. The final message shows how to activate and
deactivate the environment::</p>
<pre><code>Preparing transaction: done
Verifying transaction: done
Executing transaction: done
#
# To activate this environment, use
#
#     $ conda activate snowflakes
#
# To deactivate an active environment, use
#
#     $ conda deactivate</code></pre>
<p>Each environment is isolated from other conda environments, and that
allows you to keep several environments with different packages on them
or different versions of the same packages. As the message shows, you
activate the environment with::</p>
<pre><code>conda activate snowflakes</code></pre>
<p>Notice that when you activate a new environment, the prompt changes,
adding a prefix in parenthesis to indicate which conda environment you
are using at that moment. To check the environments available,
execute::</p>
<pre><code>conda env list</code></pre>
<p>or::</p>
<pre><code>conda info --envs</code></pre>
</div>
<div class="section level3">
<h3 id="conda-and-python">Conda and Python<a class="anchor" aria-label="anchor" href="#conda-and-python"></a>
</h3>
<p>When you create a new environment, conda installs the same Python
version used to install conda on Thorny Flat (3.9). If you want to use a
different version of Python, for example, Python 2.7, create a new
environment and specify the version of Python that you want::</p>
<pre><code>conda create --name python27 python=2.7</code></pre>
<p>You activate the environment::</p>
<pre><code>conda activate python27</code></pre>
<p>And verify the Python version::</p>
<pre><code>$ python --version
Python 2.7.16 :: Anaconda, Inc.</code></pre>
<p>Conda has packages for versions of python for 2.7, 3.5, 3.6 and
3.7</p>
</div>
<div class="section level3">
<h3 id="managing-packages-and-channels">Managing packages and channels<a class="anchor" aria-label="anchor" href="#managing-packages-and-channels"></a>
</h3>
<p>New packages can be installed to existing conda environments. First
search for packages with::</p>
<pre><code>conda search mkl</code></pre>
<p>Packages are stored in repositories called <strong>channels</strong>.
By default, conda search on the <code>pkgs/main</code> channel only.
However, there are many other packages on several other channels.</p>
<p>The most prominent channels to search for packages are
<strong>intel</strong>, <strong>conda-forge</strong> and
<strong>bioconda</strong> To search for packages there execute::</p>
<pre><code>conda search -c intel mkl

conda search -c conda-forge nitime

conda search -c bioconda blast</code></pre>
<p>Packages can be installed on the current environment with::</p>
<pre><code>conda install -c conda-forge nitime</code></pre>
<p>In this case conda will pick the most recent version of the package
compatible with the packages already present on the current environment.
You can also be very selective on version and build that you want for
the package. First get the list of versions and builds for the package
that you want::</p>
<pre><code>  $ conda search -c intel mkl
  Loading channels: done
  # Name                       Version           Build  Channel
  mkl                         2017.0.3         intel_6  intel
  mkl                         2017.0.4      h4c4d0af_0  pkgs/main
  mkl                         2018.0.0      hb491cac_4  pkgs/main
  mkl                         2018.0.0         intel_4  intel
  mkl                         2018.0.1      h19d6760_4  pkgs/main
  mkl                         2018.0.1         intel_4  intel
  mkl                         2018.0.2               1  pkgs/main
  mkl                         2018.0.2         intel_1  intel
  mkl                         2018.0.3               1  pkgs/main
  mkl                         2018.0.3         intel_1  intel
  mkl                           2019.0             117  pkgs/main
  mkl                           2019.0             118  pkgs/main
  mkl                           2019.0       intel_117  intel
  mkl                           2019.1             144  pkgs/main
  mkl                           2019.1       intel_144  intel
  mkl                           2019.2       intel_187  intel
  mkl                           2019.3             199  pkgs/main
  mkl                           2019.3       intel_199  intel
  mkl                           2019.4             243  pkgs/main
  mkl                           2019.4       intel_243  intel
  mkl                           2019.5       intel_281  intel
  ~~~



Now, install the package declaring the version and build::
</code></pre>
<p>$ conda install -c intel mkl=2019.4=intel_243 Collecting package
metadata (current_repodata.json): done Solving environment: done</p>
</div>
</div>
<div class="section level2">
<h2 id="package-plan">Package Plan<a class="anchor" aria-label="anchor" href="#package-plan"></a>
</h2>
<p>environment location: /users/gufranco/.conda/envs/test</p>
<p>added / updated specs: - mkl==2019.4=intel_243</p>
<p>The following packages will be downloaded:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="ex">package</span>                    <span class="kw">|</span>            <span class="ex">build</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="ex">---------------------------</span><span class="kw">|</span><span class="ex">-----------------</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="ex">intel-openmp-2019.5</span>        <span class="kw">|</span>        <span class="ex">intel_281</span>         888 KB  intel</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a><span class="ex">mkl-2019.4</span>                 <span class="kw">|</span>        <span class="ex">intel_243</span>       204.1 MB  intel</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="ex">tbb-2019.8</span>                 <span class="kw">|</span>        <span class="ex">intel_281</span>         874 KB  intel</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="ex">------------------------------------------------------------</span></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>                                       <span class="ex">Total:</span>       205.8 MB</span></code></pre>
</div>
<p>The following NEW packages will be INSTALLED:</p>
<p>intel-openmp intel/linux-64::intel-openmp-2019.5-intel_281 mkl
intel/linux-64::mkl-2019.4-intel_243 tbb
intel/linux-64::tbb-2019.8-intel_281</p>
<p>Proceed ([y]/n)?</p>
<p>Downloading and Extracting Packages tbb-2019.8 | 874 KB |
####################################################################################################################################
| 100% mkl-2019.4 | 204.1 MB |
####################################################################################################################################
| 100% intel-openmp-2019.5 | 888 KB |
####################################################################################################################################
| 100% Preparing transaction: done Verifying transaction: done Executing
transaction: done</p>
<pre><code>

### Creating a new environment from a YML file

You can create your own environment, one easy way of doing that is via a
YML file that describes the channels and packages that you want on your
environment. The YML file will look like this, for a simple case when
you want one env for bowtie2 (bowtie2.yml)
</code></pre>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="ex">name:</span> thorny-bowtie2</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="ex">channels:</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  <span class="ex">-</span> bioconda</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  <span class="ex">-</span> conda-forge</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>  <span class="ex">-</span> defaults</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a><span class="ex">dependencies:</span></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>  <span class="ex">-</span> bowtie2</span></code></pre>
</div>
<pre><code>

Another example is this YML file for installing a curated set of basic
genomics codes that requires just a few dependencies. (biocore.yml)
</code></pre>
<p>name: biocode channels: - bioconda - conda-forge - defaults
dependencies: - bamtools - bcftools - bedtools - hmmer - muscle - raxml
- samtools - sga - soapdenovo-trans - soapdenovo2 - sra-tools - vcftools
- velvet</p>
<pre><code>

To create an environment from those YML files you can select one
location on your scratch folder
</code></pre>
<p>conda env create -p $SCRATCH/bowtie2 -f bowtie2.yml</p>
<pre><code>

or for the biocore.yml
</code></pre>
<p>conda env create -p $SCRATCH/biocore -f biocore.yml</p>
<pre><code>

By default, new environments are created inside your `$HOME` folder on
`$HOME/.conda`

### Listing the packages inside one environment

Bowtie2 has a number of dependencies (19 dependencies for 1 package)
Notice that only bowtie2 comes from bioconda channel. All other packages
are part of conda-forge, a lower level channel.
</code></pre>
<p>$ conda activate <span class="math inline">\(SCRATCH/bowtie2\)</span>
conda list # packages in environment at /scratch/gufranco/bowtie2: # #
Name Version Build Channel bowtie2 2.3.4.2 py36h2d50403_0 bioconda bzip2
1.0.6 h470a237_2 conda-forge ca-certificates 2018.8.24 ha4d7672_0
conda-forge certifi 2018.8.24 py36_1 conda-forge libffi 3.2.1 hfc679d8_5
conda-forge libgcc-ng 7.2.0 hdf63c60_3 conda-forge libstdcxx-ng 7.2.0
hdf63c60_3 conda-forge ncurses 6.1 hfc679d8_1 conda-forge openssl 1.0.2p
h470a237_0 conda-forge perl 5.26.2 h470a237_0 conda-forge pip 18.0
py36_1 conda-forge python 3.6.6 h5001a0f_0 conda-forge readline 7.0
haf1bffa_1 conda-forge setuptools 40.2.0 py36_0 conda-forge sqlite
3.24.0 h2f33b56_1 conda-forge tk 8.6.8 0 conda-forge wheel 0.31.1 py36_1
conda-forge xz 5.2.4 h470a237_1 conda-forge zlib 1.2.11 h470a237_3
conda-forge</p>
<pre><code>

### Using a conda environment in a submission script

To execute software in a non-interactive job you need to source the main
script, activate the environment that contains the software you need,
execute the the scientific code and deactivate the environment. This is
a simple example showing that for bowtie2
</code></pre>
<p>#!/bin/bash</p>
<p>#SBATCH -J CONDA_JOB #SBATCH -N 1 #SBATCH -c 4 #SBATCH -p standby
#SBATCH -t 4:00:00</p>
<p>source /shared/software/conda/conda_init.sh conda activate
$SCRATCH/bowtie2</p>
<p>bowtie2 …..</p>
<p>conda deactivate</p>
<pre><code>


### Deleting an environment

You can execute this command to remove an environment you own.
</code></pre>
<p>conda remove –all -p $SCRATCH/bowtie2</p>
<pre><code><span></span>
<span></span>
<span><span class="va">or</span></span></code></pre>
<p>conda env remove -n bowtie2</p>
<pre><code>

If the environment is named.

### More documentation

`Conda Documentation &lt;https://conda.io/docs/index.html&gt;`__

[https://conda.io/docs/user-guide/tasks/manage-environments.html\ #
Managing environments]

`Using Bioconda — Bioconda
documentation &lt;https://bioconda.github.io/&gt;`__

`Available packages — Bioconda
documentation &lt;https://bioconda.github.io/conda-recipe_index.html&gt;`__

### Downloading Miniconda

You do not need to install Miniconda on Thorny Flat or Dolly Sods.
However, nothing prevents you from having your version of it if you want.
Miniconda can be downloaded from::
</code></pre>
<p>wget <a href="https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh" class="external-link uri">https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh</a>
sh Miniconda3-latest-Linux-x86_64.sh</p>
<pre><code>

### No installing anything

Just load the module::
</code></pre>
<p>module purge module load genomics/qiime</p>
<pre><code>

This module will load Python 2.7.3 and qiime on top of that.
Conda is a particularly good option to install older packages that could still be available on channels like conda-forge and bioconda.


## Singularity Containers

Containers are a software technology that allows us to keep control of the environment where a given code runs. Consider for example that you want to run a code in such a way the same code runs on several machines or clusters, ensuring that the same libraries are loaded and the same general environment is present. Different clusters could come installed with different compilers, different Linux distributions and different libraries in general. Containers can be used to package entire scientific workflows, software and libraries, and even data and move them to several compute infrastructures with complete reproducibility.

Containers are similar to Virtual Machines, however, the differences are enough to consider them different technologies and those differences are very important for HPC. Virtual Machines take up a lot of system resources. Each Virtual Machine (VM) runs not just a full copy of an operating system, but a virtual copy of all the hardware that the operating system needs to run. This quickly adds up to a lot of precious RAM and CPU cycles, valuable resources for HPC.

In contrast, all that a container requires is enough of an operating system, supporting programs and libraries, and system resources to run a specific program. From the user perspective, a container is in most cases a single file that contains the file system, ie a rather complete Unix filesystem tree with all libraries, executables, and data that are needed for a given workflow or scientific computation.

There are several container solutions, the most popular probably is Docker, however, the main issue with using docker on HPC is security, despite the name, containers do not actually contain the powers of the user who executes code on them. That is why you do not see Docker installed on an HPC cluster. Using dockers requires superuser access something that on shared resources like an HPC cluster is not typically possible.

Singularity offers an alternative solution to Docker, users can run the prepared images that we are offering on our clusters or bring their own.

For more information about Singularity and complete documentation see: https://singularity.lbl.gov/quickstart

### How to use a singularity Image

There are basically two scenarios, interactive execution and job submission.

#### Interactive Job

If you are using Visit or RStudio, programs that uses the X11 forwarding, ensure to connect first to the cluster with X11 forwarding, before asking for an interactive job.
In order to connect into Thorny with X11 forwarding use:
</code></pre>
<p>ssh -X <username><span class="citation">@ssh.wvu.edu</span></username></p>
<pre><code>{: .source}
</code></pre>
<p>ssh -X <username><span class="citation">@tf.hpc.wvu.edu</span></username></p>
<pre><code>{: .source}

Once you have login into the cluster, create an interactive job with the following command line, in this case we are using standby as queue but any other queue is valid.
</code></pre>
<p>salloc -c 4 -p standby</p>
<pre><code>{: .source}


Once you get inside a compute node, load the module:
</code></pre>
<p>module load singularity</p>
<pre><code>{: .source}


After loading the module the command singularity is available for usage, and you can get a shell inside the image with:
</code></pre>
<p>singularity shell /shared/containers/<image name></image></p>
<pre><code>{: .source}


#### Job Submission

In this case you do not need to export X11, just login into Thorny Flat
</code></pre>
<p>ssh <username><span class="citation">@ssh.wvu.edu</span></username></p>
<p>ssh <username><span class="citation">@tf.hpc.wvu.edu</span></username></p>
<pre><code>{: .source}


Once you have login into the cluster, create a submission script ("runjob.pbs" for this example), in this case we are using standby as queue but any other queue is valid.
</code></pre>
<p>#!/bin/sh</p>
<p>#SBATCH -J SINGULARITY_JOB #SBATCH -N 1 #SBATCH -c 4 #SBATCH -p
standby #SBATCH -t 4:00:00</p>
<p>module load singularity</p>
<p>singularity exec /shared/containers/<image name><command_or_script_to_run></command_or_script_to_run></image></p>
<pre><code>{: .source}


Submit your job with
</code></pre>
<p>sbatch runjob.pbs</p>
<pre><code>{: .source}

&gt; ### Exercise 1: Using singularity on the cluster (Interactive)
&gt;
&gt; This exercise propose the use of singularity to access RStudio-server version 2023.12.1-402 and R 4.4.1
&gt;
&gt; Follow the instructions for accessing an interactive session
&gt;
&gt; The image is located at:
&gt;
&gt; ~~~
&gt; /shared/containers/RStudio-server-2023.12.1-402_R-4.4.1_jammy.sif
&gt; ~~~
&gt; {: .source}
&gt; Be sure that you can execute basic R commands. You can get an error message like:
&gt;
&gt;&gt;   WARNING: You are configured to use the CRAN mirror at https://cran.rstudio.com/. This mirror supports secure (HTTPS) downloads however your system is unable to communicate securely with the server (possibly due to out of date certificate files on your system). Falling back to using insecure URL for this mirror.
&gt;
&gt; That is normal and due to the fact that compute nodes have no Internet access.
&gt;
{: .challenge}

&gt; ### Exercise 2: Using singularity on the cluster (Non-interactive)
&gt;
&gt; Create a script that reads a CSV with official statistics of population for US. The file can be downloaded from:
&gt;~~~
&gt;$ wget https://www2.census.gov/programs-surveys/popest/datasets/2010-2018/state/detail/SCPRC-EST2018-18+POP-RES.csv
&gt;~~~
&gt;{: .source}
&gt;
&gt; However, the file is also present in the repository for hands-ons
&gt;~~~
&gt;$ git clone https://github.com/WVUHPC/workshops_hands-on.git
&gt;~~~
&gt;
&gt;
&gt;The folder is `workshops_hands-on/Introduction_HPC/11._Software_Containers_Singularity`. If you are not familiar with R programming, the script is there too. Notice that you cannot write your script to download the CSV file directly from the Census Bureau as the compute  nodes have no Internet access.
&gt; Write a submission script and submit.
&gt;
{: .challenge}

## Advanced topics

### **Modules:** Creating a private repository

The basic procedure is to locate modules on a folder accessible by relevant users and add the variable `MODULEPATH` to your `.bashrc`

`MODULEPATH` controls the path that the module command searches when looking for
modulefiles.
Typically, it is set  to a  default  value by the bootstrap procedure.
`MODULEPATH` can be set using ’module use’ or by the module initialization
script to search group or personal modulefile directories before  or  after
the master modulefile directory.

### **Singularity:** Creating your own images

You can create your own Singularity images and use them on our clusters.
The only constrain is that images can only be created on your own machine as you need root access to create them.

The procedure that we will show will be executed on a remote machine provided by JetStream, it should the same if you have your own Linux machine and you have superuser access to it.

The creation of images is an interactive procedure. You learn how to put pieces together and little by little you build your own recipe for your image.

Lets start with a very clean image with centos.

The minimal recipe will bring an image from Docker with the latest version of CentOS. Lets call the file `centos.bst`
</code></pre>
</div>
</div>
<div class="section level1">
<h1 id="singularity-container-with-centos">Singularity container with centos<a class="anchor" aria-label="anchor" href="#singularity-container-with-centos"></a>
</h1>
</div>
<div class="section level1">
<h1 id="section"></h1>
</div>
<div class="section level1">
<h1 id="this-is-the-bootstrap-file-to-recreate-the-image-">This is the Bootstrap file to recreate the image.<a class="anchor" aria-label="anchor" href="#this-is-the-bootstrap-file-to-recreate-the-image-"></a>
</h1>
</div>
<div class="section level1">
<h1 id="section-1"></h1>
<p>Bootstrap: docker From: centos:latest</p>
<p>%runscript exec echo “The runscript is the containers default runtime
command!”</p>
<p>%files</p>
<p>%environment</p>
<p>%labels AUTHOR <a href="mailto:username@mail.wvu.edu" class="email">username@mail.wvu.edu</a></p>
<p>%post echo “The post section is where you can install, and configure
your container.” mkdir -p /data/bin mkdir -p /gpfs mkdir -p /users mkdir
-p /group mkdir -p /scratch touch /usr/bin/nvidia-smi</p>
<pre><code>{: .source}

A few folders are created that help us to link special folders like `/users`, `/scratch` to the host file system. Other than that the image contains a very small but usable Linux CentOS machine.

We start with a writable sandboxed version, the exact command varies from machine to machine, but assuming that you can do sudo and the command singularity is available for root execute this:
</code></pre>
<p>sudo singularity build –sandbox centos centos.bst</p>
<pre><code></code></pre>
<p>Using container recipe deffile: centos.bst Sanitizing environment
Adding base Singularity environment to container Docker image path:
index.docker.io/library/centos:latest Cache folder set to
/root/.singularity/docker Exploding layer:
sha256:8ba884070f611d31cb2c42eddb691319dc9facf5e0ec67672fcfa135181ab3df.tar.gz
Exploding layer:
sha256:306a59f4aef08d54a38e1747ff77fc446103a3ee3aea83676db59d6d625b02a1.tar.gz
User defined %runscript found! Taking priority. Adding files to
container Adding environment to container Running post scriptlet + echo
‘The post section is where you can install, and configure your
container.’ The post section is where you can install, and configure
your container. + mkdir -p /data/bin + mkdir -p /gpfs + mkdir -p /users
+ mkdir -p /group + mkdir -p /scratch + touch /usr/bin/nvidia-smi Adding
deffile section labels to container Adding runscript Finalizing
Singularity container Calculating final size for metadata… Skipping
checks Singularity container built: centos Cleaning up…</p>
<pre><code>{: .output}

The result will be a folder called `centos`. We can enter into that folder to learn what we need to install the packages for our image.
</code></pre>
<p>sudo singularity shell –writable centos</p>
<pre><code>

For our exercise lets imagine that we want to use a package that opens a window.
In particular, we now that we need a package that is called libgraph to get access to the graphics capabilities. The software is not provided by CentOS itself, so we need to compile it. We need to download, compile and install this package. We learn first how to do it and add that learning to the Bootstrap recipe file.

We need:

1. Download &lt;https://www.mirrorservice.org/sites/download.savannah.gnu.org/releases/libgraph/libgraph-1.0.2.tar.gz&gt;, so we need `wget` for that. This is one package that we need to install from yum.

2. We need compilers, and make. So we have to install `gcc`, `gcc-c++` and `make`

3. The next time to try, you notice that you will also need some extra packages provided by EPEL, devel packages from CentOS and EPEL repositories.
The packages are `SDL-devel` `epel-release` `SDL_image-devel` `compat-guile18-devel` and `guile-devel`.

Trial and error move you from the original recipe to this one (`centos-libgraph.bst`):
</code></pre>
</div>
<div class="section level1">
<h1 id="singularity-container-with-centos-1">Singularity container with centos<a class="anchor" aria-label="anchor" href="#singularity-container-with-centos-1"></a>
</h1>
</div>
<div class="section level1">
<h1 id="section-2"></h1>
</div>
<div class="section level1">
<h1 id="this-is-the-bootstrap-file-to-recreate-the-image--1">This is the Bootstrap file to recreate the image.<a class="anchor" aria-label="anchor" href="#this-is-the-bootstrap-file-to-recreate-the-image--1"></a>
</h1>
</div>
<div class="section level1">
<h1 id="section-3"></h1>
<p>Bootstrap: docker From: centos:latest</p>
<p>%runscript exec echo “The runscript is the containers default runtime
command!”</p>
<p>%files</p>
<p>%environment</p>
<p>%labels AUTHOR <a href="mailto:username@mail.wvu.edu" class="email">username@mail.wvu.edu</a></p>
<p>%post echo “The post section is where you can install, and configure
your container.”</p>
<p>yum -y install wget make gcc gcc-c++ SDL-devel epel-release yum -y
update &amp;&amp; yum -y install SDL_image-devel compat-guile18-devel
guile-devel</p>
<p>mkdir -p /data/bin mkdir -p /gpfs mkdir -p /users mkdir -p /group
mkdir -p /scratch touch /usr/bin/nvidia-smi</p>
<p>cd /data wget <a href="http://www.mirrorservice.org/sites/download.savannah.gnu.org/releases/libgraph/libgraph-1.0.2.tar.gz" class="external-link uri">http://www.mirrorservice.org/sites/download.savannah.gnu.org/releases/libgraph/libgraph-1.0.2.tar.gz</a>
tar -zxvf libgraph-1.0.2.tar.gz cd libgraph-1.0.2 &amp;&amp; ./configure
–prefix=/data &amp;&amp; make &amp;&amp; make install</p>
<pre><code>{: .source}

Notice that we have added a few lines using `yum` to install some packages, we add EPEL on the first line and we use it to install some extra packages on the second line.
</code></pre>
<p>yum -y install wget make gcc gcc-c++ SDL-devel epel-release yum -y
update &amp;&amp; yum -y install SDL_image-devel compat-guile18-devel
guile-devel</p>
<pre><code>{: .source}

Finally, we use `wget` to get the sources and build `libgraph`.
In order to save space on the VM, lets delete the old folder and create a new one with the new recipe.
</code></pre>
<p>sudo rm -rf centos sudo singularity build –sandbox centos
centos-libgraph.bst</p>
<pre><code>

The command takes longer and at the end you get libgraph installed at `/data`
The final step will be use that to test that we are able to use libgraph with our application. The application is a couple of very small codes that use libgraph as dependency.

To achieve this we need.

1. Modify the environment variables `PATH` and `LD_LIBRARY_PATH` to point to the locations where libgraph and our binaries will be located.

2. Copy the sources `circles.c` and `julia.c` to the image and compile it.

The final version of the Bootstrap recipe looks like this `centos-final.bst`
</code></pre>
</div>
<div class="section level1">
<h1 id="singularity-container-with-centos-2">Singularity container with centos<a class="anchor" aria-label="anchor" href="#singularity-container-with-centos-2"></a>
</h1>
</div>
<div class="section level1">
<h1 id="section-4"></h1>
</div>
<div class="section level1">
<h1 id="this-is-the-bootstrap-file-to-recreate-the-image--2">This is the Bootstrap file to recreate the image.<a class="anchor" aria-label="anchor" href="#this-is-the-bootstrap-file-to-recreate-the-image--2"></a>
</h1>
</div>
<div class="section level1">
<h1 id="section-5"></h1>
<p>Bootstrap: docker From: centos:latest</p>
<p>%runscript exec echo “The runscript is the containers default runtime
command!”</p>
<p>%files julia.c circles.c sample.c</p>
<p>%environment SHELL=/bin/bash export SHELL PATH=/data/bin:<span class="math inline">\(PATH
export PATH
LD_LIBRARY_PATH=\)</span>LD_LIBRARY_PATH:/data/lib export
LD_LIBRARY_PATH</p>
<p>%labels AUTHOR <a href="mailto:username@mail.wvu.edu" class="email">username@mail.wvu.edu</a></p>
<p>%post echo “The post section is where you can install, and configure
your container.” yum -y install wget make gcc gcc-c++ SDL-devel
epel-release yum -y update &amp;&amp; yum -y install SDL_image-devel
compat-guile18-devel guile-devel mkdir -p /data/bin mkdir -p /gpfs mkdir
-p /users mkdir -p /group mkdir -p /scratch touch
/usr/bin/nvidia-smi</p>
<p>mv /circles.c /julia.c /sample.c /data</p>
<p>cd /data wget <a href="http://www.mirrorservice.org/sites/download.savannah.gnu.org/releases/libgraph/libgraph-1.0.2.tar.gz" class="external-link uri">http://www.mirrorservice.org/sites/download.savannah.gnu.org/releases/libgraph/libgraph-1.0.2.tar.gz</a>
tar -zxvf libgraph-1.0.2.tar.gz cd libgraph-1.0.2 &amp;&amp; ./configure
–prefix=/data &amp;&amp; make &amp;&amp; make install</p>
<p>cd /data gcc julia.c -o bin/julia -I/data/include -L/data/lib -lgraph
-lm gcc circles.c -o bin/circles -I/data/include -L/data/lib -lgraph -lm
gcc sample.c -o bin/sample -I/data/include -L/data/lib -lgraph -lm</p>
<pre><code>{: .source}

We add a few sample files `sample.c`, `circles.c` and `julia.c` that uses the old `graphics.h` provided by `libgraph`.

The binaries are `sample`, `cicles` and `julia` and they are accessible on the command line.

When you have crafted a good recipe with the codes and data that you need. The last step is to create a final image. The command for that is below, remembering of deleting the `centos` folder to save space.
</code></pre>
<p>sudo rm -rf centos sudo singularity build centos-final.simg
centos-final.bst ```</p>
<p>This is the final image. It is not too big, it contains the packages
that we installed from yum, the sources and binaries for libgraph and
the sources for the couple of example sources that uses libgraph. The
image can be move to any machine with singularity and should be able to
run the codes.</p>
<p>Remember that to see the windows you should have and Xserver running
on your machine and X11 forwarding on your ssh client.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Modules. Use <code>module avail</code> to know all the modules on
the cluster.</li>
<li>Modules. Use <code>module load &lt;module_name&gt;</code> to load a
module.</li>
<li>Conda. Use <code>conda env list</code> to list the available
environments.</li>
<li>Conda. Use <code>conda activate</code> to activate a conda
environment.</li>
<li>Singularity. Use <code>singularity shell &lt;container&gt;</code> to
get a shell inside the container.</li>
<li>Singularity. Use
<code>singularity exec &lt;container&gt; &lt;command&gt;</code> to
execute a command or script inside the container.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div></section><section id="aio-301-slurm"><p>Content from <a href="301-slurm.html">Workload Manager: Slurm</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/301-slurm.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“What is a resource manager, a scheduler, and a workload
manager?”</li>
<li>“How do we submit a job on an HPC cluster?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Submit a job and have it completed successfully.”</li>
<li>“Understand how to make resource requests.”</li>
<li>“Submit an interactive job.”</li>
<li>“Learn the most frequently used SLURM commands”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Imagine for a moment that you need to execute a large simulation and
all that you have is the computer that is in front of you. You will
initiate the simulation by launching the program that will compute it.
You ajust the parameters to avoid overloading the machine with more
concurrent operations than the machine can process efficiently. It is
possible that you cannot do anything else with the computer until the
simulation is finished.</p>
<p>Changing the situation a bit, now you have several computers at your
disposal and you have many simulations to do, maybe the same simulation
but under different physical conditions. You will have to connect to
each computer to start the simulation and periodically monitor the
computers to check if some of them have finished and its ready to run a
new simulation.</p>
<p>Moving to an even more complex scenario. Consider the case of several
users, each wanting to run many simulations like yours and having a
number of computers capable of runing all those simulations.
Coordinating all the work and all the executions could be a daunting
task that can be solved if a program could take care or mapping all the
jobs from all the users to the available resources and monitoring when
one computer can take another job.</p>
<p>All what we have described is the work of two programs, a resource
manager in charge of monitoring the state of a pool of computers and a
scheduler that will assign jobs to the different machines as fairly as
possible for all the users in the cluster. In the case of our cluster
those two roles are managed by a single software called Slurm and the
integration of the resource manager, scheduler with the addition and
accounting and other roles makes Slurm to be called a Workload
Manager.</p>
<p>An HPC system such as Thorny Flat or Dolly Sods has tenths nodes and
more than 100 users. How do we decide who gets what and when? How do we
ensure that a task is run with the resources it needs? This job is
handled by a special piece of software called the scheduler. The
scheduler manages which jobs run where and when on an HPC system.</p>
<figure><img src="fig/queueing_infog.png" alt="blue hexagon with The Carpentries logo in white and text: 'The Carpentries'" class="figure mx-auto d-block"><div class="figcaption">Why do supercomputers use queueing?</div>
</figure><p>The scheduler used on our clusters is SLURM. SLURM is not the only
resource manager or scheduler for HPC systems. Other software packages
offer similar functionality. The exact syntax might change, but the
concepts remain the same.</p>
<p>A Resource Manager takes care of receiving job submissions and
executes those jobs when resources are available, providing the most
efficient conditions for the jobs. On the other hand, a job scheduler is
in charge of associating jobs with the appropriate resources and trying
to maximize an objective function, such as total utilization constrained
by priorities and the best balance between the resources requested and
resources available. As SLURM is taking the dual role of Resource
Manager and Scheduler, SLURM calls itself a Workload Manager, a term
that better embraces the multiple roles taken by this software
package.</p>
<blockquote>
<h2 id="workload-manager-on-wvu-clusters">Workload Manager on WVU
Clusters</h2>
<p>All of our clusters use SLURM today. On Thorny Flat, we have a
compatibility layer so that most Torque/Moab batch scripts will still
work. If you are new to WVU’s HPC clusters, it makes the most sense to
learn the SLURM batch commands. See <a href="https://slurm.schedmd.com/quickstart.html" class="external-link">Slurm Quick Start
Guide</a> for more SLURM information. {: .callout}</p>
</blockquote>
<section><h2 class="section-heading" id="what-is-a-batch-script">What is a Batch Script?<a class="anchor" aria-label="anchor" href="#what-is-a-batch-script"></a>
</h2>
<hr class="half-width">
<p>The most basic use of the scheduler is to run a command
non-interactively. This is also referred to as batch job submission. In
this case, we need to make a script that incorporates some arguments for
SLURM, such as the resources needed and the modules that need to be
loaded.</p>
<p>We will use the <code>sleep.sh</code> job script as an example.</p>
<div class="section level3">
<h3 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<p>Let’s discuss the example SLURM script, <code>sleep.sh</code>. Go to
File Explorer and edit <code>sleep.sh</code></p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> cd <span class="va">$HOME</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> mkdir <span class="ex">SLEEP</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> cd <span class="ex">SLEEP</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> nano <span class="ex">sleep.sh</span></span></code></pre>
</div>
<p>Write the following in the file with your text editor:</p>
<pre><code>#!/bin/bash

#SBATCH --partition=standby
#SBATCH --job-name=test_job
#SBATCH --time=00:03:00
#SBATCH --nodes=1 --ntasks-per-node=2

echo 'This script is running on:'
hostname
echo 'The date is :'
date
sleep 120</code></pre>
<p>Comments in UNIX (denoted by <code>#</code>) are typically ignored.
But there are exceptions. For instance, the special <code>#!</code>
comment at the beginning of scripts specifies what program should be
used to run it (typically <code>/bin/bash</code>). This is required in
SLURM so don’t leave it out! Schedulers like SLURM also have a special
comment used to denote special scheduler-specific options. Though these
comments differ from scheduler to scheduler, SLURM’s special comment is
<code>#SBATCH</code>. Anything following the <code>#SBATCH</code>
comment is interpreted as an instruction to the scheduler.</p>
<p>In our example, we have set the following parameters:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Option</th>
<th>Name</th>
<th>Example Setting</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>--partition</code></td>
<td>queue</td>
<td>standby</td>
<td>See next section for queue info</td>
</tr>
<tr class="even">
<td><code>--job-name</code></td>
<td>jobname</td>
<td>test_script</td>
<td>Name of your script (no spaces, alphanumeric only)</td>
</tr>
<tr class="odd">
<td><code>--time</code></td>
<td>total job time</td>
<td>multiple settings</td>
<td>See next segment</td>
</tr>
<tr class="even">
<td><code>--nodes</code></td>
<td>nodes requested</td>
<td>multiple settings</td>
<td>See next segment</td>
</tr>
<tr class="odd">
<td><code>--ntasks-per-node</code></td>
<td>cores per node</td>
<td>multiple settings</td>
<td>See next segment</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="resource-list">Resource list<a class="anchor" aria-label="anchor" href="#resource-list"></a>
</h3>
<p>A resource list will contain a number of settings that inform the
scheduler what resources to allocate for your job and for how long (wall
time).</p>
<div class="section level4">
<h4 id="walltime">Walltime<a class="anchor" aria-label="anchor" href="#walltime"></a>
</h4>
<p>Walltime is represented by <code>--time=00:03:00</code> in the format
HH:MM:SS. This will be how long the job will run before timing out. If
your job exceeds this time, the scheduler will terminate the job. You
should find a usual runtime for the job and add some more (say 20%) to
it. For example, if a job took approximately 10 hours, the wall time
limit could be set to 12 hours, e.g. “–time=12:00:00”. By setting the
wall time, the scheduler can perform job scheduling more efficiently and
also reduces occasions where errors can leave the job stalled but still
taking up resources for the default much longer wall time limit (for
queue wall time defaults, run <code>squeue</code> command)</p>
<blockquote>
<h2 id="walltime-test-exercise">Walltime test exercise</h2>
<p>Resource requests are typically binding. If you exceed them, your job
will be killed. Let’s use wall time as an example. We will request 30
seconds of wall time, and attempt to run a job for two minutes.</p>
<pre><code>#!/bin/bash

#SBATCH --partition=standby
#SBATCH --job-name=test_job
#SBATCH --time=00:00:30
#SBATCH --nodes=1 --ntasks-per-node=2

echo 'This script is running on:'
hostname
echo 'The date is :'
date
sleep 120
</code></pre>
<p>Submit the job and wait for it to finish. Once it has finished, check
the error log file. In the error file, there will be</p>
<pre><code>This script is running on:
This script is running on:
taicm002.hpc.wvu.edu
The date is :
Thu Jul 20 19:25:21 EDT 2023
slurmstepd: error: *** JOB 453582 ON taicm002 CANCELLED AT 2023-07-20T19:26:33 DUE TO TIME LIMIT ***
</code></pre>
<blockquote>
<h2 id="what-happened">What happened?</h2>
<p>Our job was killed for exceeding the amount of resources it
requested. Although this appears harsh, this is a feature. Strict
adherence to resource requests allows the scheduler to find the best
possible place for your jobs. Even more importantly, it ensures that
another user cannot use more resources than they’ve been given. If
another user messes up and accidentally attempts to use all of the CPUs
or memory on a node, SLURM will either restrain their job to the
requested resources or kill the job outright. Other jobs on the node
will be unaffected. This means that one user cannot mess up the
experience of others, the only jobs affected by a mistake in scheduling
will be their own.</p>
</blockquote>
<p>{: .solution} {: .challenge }</p>
</blockquote>
</div>
<div class="section level4">
<h4 id="compute-resources-and-parameters">Compute Resources and Parameters<a class="anchor" aria-label="anchor" href="#compute-resources-and-parameters"></a>
</h4>
<p>Compute parameters The argument <code>--nodes</code> specifies the
number of nodes (or chunks of resource) required;
<code>--ntasks-per-node</code> indicates the number of CPUs per chunk
required.</p>
<table class="table">
<thead><tr class="header">
<th>nodes</th>
<th>tasks</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>16</td>
<td>32 Processor job, using 2 nodes and 16 processors per node</td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td>32 Processor job, using 4 nodes and 8 processors per node</td>
</tr>
<tr class="odd">
<td>8</td>
<td>28</td>
<td>244 Processor job, using 8 nodes and 28 processor per node</td>
</tr>
<tr class="even">
<td>1</td>
<td>40</td>
<td>40 Processor job, using 1 nodes and 40 processors per node</td>
</tr>
</tbody>
</table>
<p>Each of these parameters has a default setting they will revert to if
not set; however, this means your script may act differently to what you
expect.</p>
<p>You can find more information about these parameters by viewing the
manual page for the <code>sbatch</code> function. This will also show
you what the default settings are.</p>
<pre><code>$&gt; man sbatch</code></pre>
<blockquote>
<h2 id="setting-up-email-notifications">Setting up email
notifications</h2>
<p>Jobs on an HPC system might run for days or even weeks. We probably
have better things to do than constantly check on the status of our job
with <code>squeue</code>. Looking at the <a href="https://slurm.schedmd.com/sbatch.html" class="external-link">online documentation for
<code>sbatch</code></a> (you can also google “sbatch slurm”), can you
set up our test job to send you an email when it finishes?</p>
<p>Hint: you will need to use the <code>--mail-user</code> and
<code>--mail-type</code> options. {: .challenge}</p>
</blockquote>
</div>
</div>
</section><div class="section level1">
<h1 id="running-a-batch-job-two-methods">Running a batch job (two methods)<a class="anchor" aria-label="anchor" href="#running-a-batch-job-two-methods"></a>
</h1>
<div class="section level2">
<h2 id="submit-jobs-with-job-composer-on-ondemand">Submit Jobs with job composer on OnDemand<a class="anchor" aria-label="anchor" href="#submit-jobs-with-job-composer-on-ondemand"></a>
</h2>
<p>OnDemand also has a tool for job creation and submission to the batch
system. The same information as above applies since it still uses the
same underlying queue system. In the Job Composer, you can create a new
location in your home directory for a new job, create or transfer a job
script and input files, edit everything, and submit your job all from
this screen.</p>
<p>We will run this job in the Job Composer by creating a new job from
<em>specified path</em>.</p>
<figure><img src="fig/OOD_job_composer_1.png" alt="blue hexagon with The Carpentries logo in white and text: 'The Carpentries'" class="figure mx-auto d-block"><div class="figcaption">NewJob</div>
</figure><p>You’ll see the Job Options page, like this:</p>
<figure><img src="fig/OOD_job_composer_2.png" alt="blue hexagon with The Carpentries logo in white and text: 'The Carpentries'" class="figure mx-auto d-block"><div class="figcaption">JobOptions</div>
</figure><p>Fill it in as shown. Path is <code>~/SLEEP</code> and then select
Save.</p>
<p>To run the job, select green ‘play’ button.</p>
<p>If the job is successfully submitted, a green bar will appear on the
top of the page.</p>
<p>Also, OnDemand allows you to view the queue for all systems (not just
the one you are on in the shell) under Jobs, select Active Jobs. You can
filter by your jobs, your group’s jobs, and all jobs.</p>
</div>
<div class="section level2">
<h2 id="submitting-jobs-via-the-command-line">Submitting Jobs via the command line<a class="anchor" aria-label="anchor" href="#submitting-jobs-via-the-command-line"></a>
</h2>
<p>To submit this job to the scheduler, we use the <code>sbatch</code>
command.</p>
<pre><code>$&gt; sbatch sleep.sh
Submitted batch job 453594
$&gt;</code></pre>
<p>The number that first appears is your Job ID. When the job is
completed, you will get two files: an Output and an Error file (even if
there is no errors). They will be named {JobName}.o{JobID} and
{JobName}.e{JobID} respectively.</p>
<p>And that’s all we need to do to submit a job. To check on our job’s
status, we use the command <code>squeue</code>.</p>
<pre><code>$&gt; squeue -u $USER
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
            453594   standby test_job gufranco  R       0:34      1 taicm009
</code></pre>
<p>{: .output}</p>
<p>We can see all the details of our job, most importantly if it is in
the “R” or “RUNNING” state. Sometimes our jobs might need to wait in a
queue (“PD”) or have an error. The best way to check our job’s status is
with <code>squeue</code>. It is easiest to view just your own jobs in
the queue with the <code>squeue -u $USER</code>. Otherwise, you get the
entire queue.</p>
</div>
<div class="section level2">
<h2 id="partitions-also-known-as-queues">Partitions (Also known as queues)<a class="anchor" aria-label="anchor" href="#partitions-also-known-as-queues"></a>
</h2>
<p>There are usually a number of available partitions (Other resource
managers call them queues) to use on the HPC clusters. Each cluster has
separate partitions. The same compute node can be associated with
multiple partitions Your job will be routed to the appropriate compute
node based on the list of nodes associated with the partition, the wall
time, and the computational resources requested. To get the list of
partitions on the cluster, execute:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> sinfo <span class="ex">-s</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="ex">PARTITION</span>       AVAIL  TIMELIMIT   NODES<span class="er">(</span><span class="ex">A/I/O/T</span><span class="kw">)</span> <span class="ex">NODELIST</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="ex">standby*</span>           up    4:00:00      94/71/2/167 taicm<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">009</span><span class="pp">]</span>,tarcl100,tarcs<span class="pp">[</span><span class="ss">100,200</span><span class="pp">-</span><span class="ss">206,300</span><span class="pp">-</span><span class="ss">304</span><span class="pp">]</span>,tbdcx001,tbmcs<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">011,100</span><span class="pp">-</span><span class="ss">103</span><span class="pp">]</span>,tbpcm200,tbpcs001,tcbcx100,tcdcx100,tcgcx300,tcocm<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">104</span><span class="pp">]</span>,tcocs<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">064,100</span><span class="pp">]</span>,tcocx<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">003</span><span class="pp">]</span>,tcscm300,tjscl100,tjscm001,tmmcm<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">108</span><span class="pp">]</span>,tngcm200,tpmcm<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">006</span><span class="pp">]</span>,tsacs001,tsdcl<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">002</span><span class="pp">]</span>,tsscl<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">002</span><span class="pp">]</span>,ttmcm<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">101</span><span class="pp">]</span>,tzecl<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">107</span><span class="pp">]</span>,tzecs<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">115</span><span class="pp">]</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="ex">comm_small_day</span>     up 1-00:00:00        59/5/1/65 tcocs<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">064,100</span><span class="pp">]</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="ex">comm_small_week</span>    up 7-00:00:00        59/5/1/65 tcocs<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">064,100</span><span class="pp">]</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="ex">comm_med_day</span>       up 1-00:00:00          5/0/0/5 tcocm<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">104</span><span class="pp">]</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="ex">comm_med_week</span>      up 7-00:00:00          5/0/0/5 tcocm<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">104</span><span class="pp">]</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="ex">comm_xl_week</span>       up 7-00:00:00          3/0/0/3 tcocx<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">003</span><span class="pp">]</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="ex">comm_gpu_inter</span>     up    4:00:00         8/1/2/11 tbegq<span class="pp">[</span><span class="ss">200</span><span class="pp">-</span><span class="ss">202</span><span class="pp">]</span>,tbmgq<span class="pp">[</span><span class="ss">001,100</span><span class="pp">]</span>,tcogq<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">006</span><span class="pp">]</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="ex">comm_gpu_week</span>      up 7-00:00:00          5/0/1/6 tcogq<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">006</span><span class="pp">]</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="ex">aei0001</span>            up   infinite          3/5/1/9 taicm<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">009</span><span class="pp">]</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="ex">alromero</span>           up   infinite        12/2/0/14 tarcl100,tarcs<span class="pp">[</span><span class="ss">100,200</span><span class="pp">-</span><span class="ss">206,300</span><span class="pp">-</span><span class="ss">304</span><span class="pp">]</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="ex">be_gpu</span>             up   infinite          1/1/1/3 tbegq<span class="pp">[</span><span class="ss">200</span><span class="pp">-</span><span class="ss">202</span><span class="pp">]</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="ex">bvpopp</span>             up   infinite          0/1/0/1 tbpcs001</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="ex">cedumitrescu</span>       up   infinite          1/0/0/1 tcdcx100</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="ex">cfb0001</span>            up   infinite          0/1/0/1 tcbcx100</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="ex">cgriffin</span>           up   infinite          1/0/0/1 tcgcx300</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="ex">chemdept</span>           up   infinite          0/4/0/4 tbmcs<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">103</span><span class="pp">]</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="ex">chemdept-gpu</span>       up   infinite          1/0/0/1 tbmgq100</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="ex">cs00048</span>            up   infinite          0/1/0/1 tcscm300</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="ex">jaspeir</span>            up   infinite          0/2/0/2 tjscl100,tjscm001</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="ex">jbmertz</span>            up   infinite        3/14/0/17 tbmcs<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">011,100</span><span class="pp">-</span><span class="ss">103</span><span class="pp">]</span>,tbmgq<span class="pp">[</span><span class="ss">001,100</span><span class="pp">]</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="ex">mamclaughlin</span>       up   infinite          1/8/0/9 tmmcm<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">108</span><span class="pp">]</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="ex">ngarapat</span>           up   infinite          0/1/0/1 tngcm200</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="ex">pmm0026</span>            up   infinite          0/6/0/6 tpmcm<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">006</span><span class="pp">]</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="ex">sbs0016</span>            up   infinite          0/2/0/2 tsscl<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">002</span><span class="pp">]</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="ex">spdifazio</span>          up   infinite          0/2/0/2 tsdcl<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">002</span><span class="pp">]</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="ex">tdmusho</span>            up   infinite          1/5/0/6 taicm<span class="pp">[</span><span class="ss">001</span><span class="pp">-</span><span class="ss">004</span><span class="pp">]</span>,ttmcm<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">101</span><span class="pp">]</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="ex">vyakkerman</span>         up   infinite          1/0/0/1 tsacs001</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="ex">zbetienne</span>          up   infinite        6/18/0/24 tzecl<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">107</span><span class="pp">]</span>,tzecs<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">115</span><span class="pp">]</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="ex">zbetienne_large</span>    up   infinite          6/2/0/8 tzecl<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">107</span><span class="pp">]</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="ex">zbetienne_small</span>    up   infinite        0/16/0/16 tzecs<span class="pp">[</span><span class="ss">100</span><span class="pp">-</span><span class="ss">115</span><span class="pp">]</span></span></code></pre>
</div>
<blockquote>
<h2 id="submitting-resource-requests">Submitting resource requests</h2>
<p>Submit a job that will use 1 node, 4 processors, and 5 minutes of
walltime. {: .challenge}</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="job-environment-variables">Job environment variables<a class="anchor" aria-label="anchor" href="#job-environment-variables"></a>
</h2>
<p>SLURM sets multiple environment variables at submission time. The
following variables are commonly used in command files:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Variable Name</th>
<th>Description</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>$SLURM_JOB_ID</code></td>
<td>Full jobid assigned to this job. Often used to uniquely name output
files for this job, for example: srun - np 16 ./a.out &gt;output.<span class="math inline">\({SLURM_JOB_ID}|
|
`\)</span>SLURM_JOB_NAME<code>|  Name of the job. This can be set using the --job-name option in the SLURM script (or from the command line). The default job name is the name of the SLURM script.| |</code><span class="math inline">\(SLURM_JOB_NUM_NODES` |  Number of nodes allocated
|
|
`\)</span>SLURM_JOB_PARTITION<code>|  Queue job was submitted to.| |</code><span class="math inline">\(SLURM_NTASKS` |  The number of processes
requested|
|
`\)</span>SLURM_SUBMIT_DIR<code>|  The directory from which the batch job was submitted. | |</code>$SLURM_ARRAY_TASK_ID`</td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="canceling-a-job">Canceling a job<a class="anchor" aria-label="anchor" href="#canceling-a-job"></a>
</h2>
<p>Sometimes we’ll make a mistake and need to cancel a job. This can be
done with the <code>qdel</code> command. Let’s submit a job and then
cancel it using its job number.</p>
<pre><code>$&gt; sbatch sleep.sh
Submitted batch job 453599

$&gt; $ squeue -u $USER
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
            453599   standby test_job gufranco  R       0:47      1 tcocs015</code></pre>
<p>Now cancel the job with it’s job number. Absence of any job info
indicates that the job has been successfully canceled.</p>
<pre><code>$&gt; scancel 453599
$&gt; squeue -u $USER
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)</code></pre>
</div>
<div class="section level2">
<h2 id="detailed-information-about-jobs">Detailed information about jobs<a class="anchor" aria-label="anchor" href="#detailed-information-about-jobs"></a>
</h2>
<p>The information provided by the command <code>squeue</code> is
sometimes not enough, and you would like to gather a complete picture of
the state of a particular job. The command <code>scontrol</code>
provides a wealth of information about jobs but also partitions and
nodes. Information about a job:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">$</span> sbatch sleep.sh</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">Submitted</span> batch job 453604</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="ex">$</span> scontrol show job 453604</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="va">JobId</span><span class="op">=</span>453604 <span class="va">JobName</span><span class="op">=</span>test_job</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>   <span class="va">UserId</span><span class="op">=</span>gufranco<span class="kw">(</span><span class="ex">318130</span><span class="kw">)</span> <span class="va">GroupId</span><span class="op">=</span>its-rc-thorny<span class="kw">(</span><span class="ex">1079001</span><span class="kw">)</span> <span class="va">MCS_label</span><span class="op">=</span>N/A</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>   <span class="va">Priority</span><span class="op">=</span>11588 <span class="va">Nice</span><span class="op">=</span>0 <span class="va">Account</span><span class="op">=</span>its-rc-admin <span class="va">QOS</span><span class="op">=</span>normal</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>   <span class="va">JobState</span><span class="op">=</span>RUNNING <span class="va">Reason</span><span class="op">=</span>None <span class="va">Dependency</span><span class="op">=</span><span class="va">(</span>null<span class="va">)</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>   <span class="va">Requeue</span><span class="op">=</span>0 <span class="va">Restarts</span><span class="op">=</span>0 <span class="va">BatchFlag</span><span class="op">=</span>1 <span class="va">Reboot</span><span class="op">=</span>0 <span class="va">ExitCode</span><span class="op">=</span>0:0</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>   <span class="va">RunTime</span><span class="op">=</span>00:00:19 <span class="va">TimeLimit</span><span class="op">=</span>00:04:00 <span class="va">TimeMin</span><span class="op">=</span>N/A</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>   <span class="va">SubmitTime</span><span class="op">=</span>2023-07-20T20:39:15 <span class="va">EligibleTime</span><span class="op">=</span>2023-07-20T20:39:15</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>   <span class="va">AccrueTime</span><span class="op">=</span>2023-07-20T20:39:15</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>   <span class="va">StartTime</span><span class="op">=</span>2023-07-20T20:39:15 <span class="va">EndTime</span><span class="op">=</span>2023-07-20T20:43:15 <span class="va">Deadline</span><span class="op">=</span>N/A</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>   <span class="va">PreemptEligibleTime</span><span class="op">=</span>2023-07-20T20:39:15 <span class="va">PreemptTime</span><span class="op">=</span>None</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>   <span class="va">SuspendTime</span><span class="op">=</span>None <span class="va">SecsPreSuspend</span><span class="op">=</span>0 <span class="va">LastSchedEval</span><span class="op">=</span>2023-07-20T20:39:15 <span class="va">Scheduler</span><span class="op">=</span>Main</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>   <span class="va">Partition</span><span class="op">=</span>standby <span class="ex">AllocNode:Sid=trcis001:31864</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>   <span class="va">ReqNodeList</span><span class="op">=</span><span class="va">(</span>null<span class="va">)</span> <span class="va">ExcNodeList</span><span class="op">=</span><span class="va">(</span>null<span class="va">)</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>   <span class="va">NodeList</span><span class="op">=</span>taicm007</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>   <span class="va">BatchHost</span><span class="op">=</span>taicm007</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>   <span class="va">NumNodes</span><span class="op">=</span>1 <span class="va">NumCPUs</span><span class="op">=</span>2 <span class="va">NumTasks</span><span class="op">=</span>2 <span class="ex">CPUs/Task=1</span> ReqB:S:C:T=0:0:<span class="pp">*</span>:<span class="pp">*</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>   <span class="va">TRES</span><span class="op">=</span>cpu=2,node=1,billing=2</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>   <span class="ex">Socks/Node=*</span> NtasksPerN:B:S:C=2:0:<span class="pp">*</span>:<span class="pp">*</span> CoreSpec=<span class="pp">*</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>   <span class="va">MinCPUsNode</span><span class="op">=</span>2 <span class="va">MinMemoryNode</span><span class="op">=</span>0 <span class="va">MinTmpDiskNode</span><span class="op">=</span>0</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>   <span class="va">Features</span><span class="op">=</span><span class="va">(</span>null<span class="va">)</span> <span class="va">DelayBoot</span><span class="op">=</span>00:00:00</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>   <span class="va">OverSubscribe</span><span class="op">=</span>OK <span class="va">Contiguous</span><span class="op">=</span>0 <span class="va">Licenses</span><span class="op">=</span><span class="va">(</span>null<span class="va">)</span> <span class="va">Network</span><span class="op">=</span><span class="va">(</span>null<span class="va">)</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>   <span class="va">Command</span><span class="op">=</span>/gpfs20/users/gufranco/SLEEP/sleep.sh</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>   <span class="va">WorkDir</span><span class="op">=</span>/gpfs20/users/gufranco/SLEEP</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>   <span class="va">StdErr</span><span class="op">=</span>/gpfs20/users/gufranco/SLEEP/slurm-453604.out</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>   <span class="va">StdIn</span><span class="op">=</span>/dev/null</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>   <span class="va">StdOut</span><span class="op">=</span>/gpfs20/users/gufranco/SLEEP/slurm-453604.out</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>   <span class="va">Power</span><span class="op">=</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="interactive-jobs">Interactive jobs<a class="anchor" aria-label="anchor" href="#interactive-jobs"></a>
</h2>
<p>Sometimes, you will need a lot of resources for interactive use.
Perhaps it’s the first time running an analysis, or we are attempting to
debug something that went wrong with a previous job.</p>
<p>You can also request interactive jobs on OnDemand using the
Interactive Apps menu.</p>
<p>To submit an interactive job requesting 4 cores on the partition
standby and with a wall time of 40 minutes, execute:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> srun <span class="ex">-p</span> standby <span class="at">-t</span> 40:00 <span class="at">-c</span> 4 <span class="at">--pty</span> bash</span></code></pre>
</div>
<p>Another example includes requesting a GPU compute compute,
execute:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> srun <span class="ex">-p</span> comm_gpu_inter <span class="at">-G</span> 1 <span class="at">-t</span> 2:00:00 <span class="at">-c</span> 8 <span class="at">--pty</span> bash</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="job-arrays">Job arrays<a class="anchor" aria-label="anchor" href="#job-arrays"></a>
</h2>
<p>Job arrays offer a mechanism for submitting and managing collections
of similar jobs quickly and easily; job arrays with many tasks can be
submitted from a single submission script. Job arrays are very useful
for testing jobs when one parameter is changed or to execute the same
workflow on a set of samples.</p>
<p>For our example, we will create a folder FIBONACCI and a submission
script called <code>fibo.sh</code></p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> mkdir <span class="ex">FIBONACCI</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> cd <span class="ex">FIBONACCI/</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> nano <span class="ex">fibo.sh</span></span></code></pre>
</div>
<p>Write the content of the submission script as follows:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#SBATCH --partition=standby</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#SBATCH --job-name=test_job</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#SBATCH --time=00:03:30</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#SBATCH --nodes=1 --ntasks-per-node=2</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#SBATCH --array 1-10</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co"># Static input for N</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="va">N</span><span class="op">=</span>10</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co"># First Number of the</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co"># Fibonacci Series</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="va">a</span><span class="op">=</span><span class="va">$SLURM_ARRAY_TASK_ID</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co"># Second Number of the</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co"># Fibonacci Series</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="va">b</span><span class="op">=</span><span class="kw">`</span><span class="fu">expr</span> <span class="va">$SLURM_ARRAY_TASK_ID</span> + 1<span class="kw">`</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"10 first elements in the Fibonacci Sequence."</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Starting with </span><span class="va">$a</span><span class="st"> and </span><span class="va">$b</span><span class="st">"</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="cf">for</span> <span class="kw">((</span> <span class="va">i</span><span class="op">=</span><span class="dv">0</span><span class="kw">;</span> <span class="va">i</span><span class="op">&lt;</span><span class="va">N</span><span class="kw">;</span> <span class="va">i</span><span class="op">++</span> <span class="kw">))</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-n</span> <span class="st">"</span><span class="va">$a</span><span class="st"> "</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>    <span class="va">fn</span><span class="op">=</span><span class="va">$((a</span> <span class="op">+</span> <span class="va">b))</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>    <span class="va">a</span><span class="op">=</span><span class="va">$b</span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>    <span class="va">b</span><span class="op">=</span><span class="va">$fn</span></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a><span class="co"># End of for loop</span></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a><span class="bu">echo</span> <span class="st">""</span></span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a><span class="fu">sleep</span> 60</span></code></pre>
</div>
<p>The array index values on job arrays are specified using the
<code>--array</code> or <code>-a</code> option of the
<code>sbatch</code> command. All the jobs in the job array will have the
same variables except for the environment variable
<code>SLURM_ARRAY_TASK_ID</code> , which is set to its array index
value. This variable can redirect the workflow to a different folder or
execute the simulation with different parameters.</p>
<p>Submit the job array:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> sbatch <span class="ex">fibo.sh</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="ex">Submitted</span> batch job 453632</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> squeue <span class="ex">-u</span> <span class="va">$USER</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>         <span class="ex">JOBID</span> PARTITION     NAME     USER ST       TIME  NODES NODELIST<span class="er">(</span><span class="ex">REASON</span><span class="kw">)</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>      <span class="ex">453632_1</span>   standby test_job gufranco  R       0:03      1 taicm007</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>      <span class="ex">453632_2</span>   standby test_job gufranco  R       0:03      1 taicm007</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>      <span class="ex">453632_3</span>   standby test_job gufranco  R       0:03      1 taicm007</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>      <span class="ex">453632_4</span>   standby test_job gufranco  R       0:03      1 taicm007</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>      <span class="ex">453632_5</span>   standby test_job gufranco  R       0:03      1 taicm007</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>      <span class="ex">453632_6</span>   standby test_job gufranco  R       0:03      1 taicm007</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>      <span class="ex">453632_7</span>   standby test_job gufranco  R       0:03      1 taicm007</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>      <span class="ex">453632_8</span>   standby test_job gufranco  R       0:03      1 taicm007</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>      <span class="ex">453632_9</span>   standby test_job gufranco  R       0:03      1 taicm007</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>     <span class="ex">453632_10</span>   standby test_job gufranco  R       0:03      1 taicm007</span></code></pre>
</div>
<p>The job submission will create ten jobs When the jobs finish, their
output will be in files <code>slurm-XXX</code>. For example:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">$</span><span class="op">&gt;</span> cat <span class="ex">slurm-453632_7.out</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="ex">10</span> first elements in the Fibonacci Sequence</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="ex">Starting</span> with 7 and 8</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="ex">7</span> 8 15 23 38 61 99 160 259 419</span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“The scheduler handles how compute resources are shared between
users.”</li>
<li>“Everything you do should be run through the scheduler.”</li>
<li>“A non-interactive job is expressed as a shell script that is
submitted to the cluster.”</li>
<li>“Try to adjust the wall time to around 10-20% more than the expected
time the job should need.”</li>
<li>“It is a good idea to keep aliases to common torque commands for
easy execution.”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div></section><section id="aio-302-tmux"><p>Content from <a href="302-tmux.html">Terminal Multiplexing: tmux</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/302-tmux.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“What is a Terminal Multiplexer?”</li>
<li>“How can I use tmux?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Learn about Sessions, Windows and Panes”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="terminal-emulation">Terminal Emulation<a class="anchor" aria-label="anchor" href="#terminal-emulation"></a>
</h2>
<hr class="half-width">
<iframe width="560" height="315" src="https://www.youtube.com/embed/f4TosumXhms" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>During your interaction with an HPC cluster, you spend most of your
time in front of a terminal. We have been working on a terminal during
the previous two episodes. Let’s understand what a terminal is before
digging into terminal multiplexing and <em>tmux</em> in particular.</p>
<p>What you have on your computer is called a terminal emulator. In the
old days of mainframes (70s and 80s), people using computers worked on
what were called dumb terminals, monitors with keyboards but no
processing power, all the processing was happening on a remote machine,
the mainframe.</p>
<p>Today, what you have on your side is a perfectly capable computer,
but you are using a terminal emulator and an SSH client to connect to a
remote machine that is the head node of the cluster. On Windows, you
have applications like PuTTy <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/" class="external-link uri">https://www.chiark.greenend.org.uk/~sgtatham/putty/</a> that
will offer an <code>xterm</code> terminal emulator and the SSH client on
the same package. You should realize that the terminal emulator and SSH
client are two different applications. In other Operating Systems like
Linux and MacOS the difference between the terminal emulator and the SSH
client is more clear.</p>
<p>Now, on your computer, connect to one of our HPC clusters using SSH.
You notice that your prompt, the string that indicates that it is ready
to receive commands, shows the name of the head node on our clusters.
Imagine that you are editing a text file using any of the three editors
from our previous episode. If, for some reason, the internet connection
fails, the program that you were using will be closed. Some editors give
you some recovery protection, but in any case, you need to connect
again, change the working directory and other operations before opening
the file, and continue your work.</p>
<p>Another limitation of traditional terminals is that you have just one
place to enter commands. Working with HPC clusters usually involves
working with several jobs and projects, and you would like to write and
submit new jobs, check the status of those jobs that you have already
submitted, and read the output from the jobs that have been finished.
You could open more SSH sessions, but the chances of those sessions
failing due to network issues and managing those extra windows limit
your ability to work effectively on the cluster.</p>
<p>The solution for the two problems above is using a Terminal
Multiplexer, a program that runs on the head node and is detached from
your local terminal session. <em>tmux</em> is such a terminal
multiplexer that it can create multiple emulated terminals.</p>
<p>In this episode we will show you how to create <em>tmux</em> sessions
on the cluster and see the effect of detaching and reattaching to the
session. Next, we will see the four basic concepts in <em>tmux</em>:
Clients, Sessions, Windows and Panes. We will see how to create and move
between them and, finally, a few tricks on how to personalize your
experience on <em>tmux</em>. As you progress on the use of the cluster
<em>tmux</em> will become an important companion for your interaction
with the HPC clusters.</p>
<p><em>tmux</em> lets you switch easily between several virtual
terminals organized in sessions, windows, and panes. One big advantage
of terminal multiplexing is that all those virtual terminals remain
alive when you log out of the system. You can work remotely for a while,
close the connection and reconnect, attach your <code>tmux</code>
session, and continue exactly where you left your work.</p>
</section><section><h2 class="section-heading" id="opening-a-tmux-session-and-client">Opening a <em>tmux</em> Session and Client<a class="anchor" aria-label="anchor" href="#opening-a-tmux-session-and-client"></a>
</h2>
<hr class="half-width">
<p>The first concepts in <em>tmux</em> are client and session. A
<em>tmux</em> session is made of at least one window that holds at least
one pane. We will see about windows and panes later in this episode but
right now, lets see how to work with <em>tmux</em> sessions.</p>
<p>First, connect to the cluster using your terminal emulator and SSH
client. Once you are connected to the head node of the cluster,
execute:</p>
<pre><code><span><span class="va">tmux</span></span></code></pre>
<p>If, for some reason, you lost the connection to the server or you
detached from the multiplexer, all that you have to do to reconnect is
to execute the command:</p>
<pre><code>tmux a</code></pre>
<p>You will see something new here: a green bar on the bottom of your
screen. That is the indication that you are inside a <em>tmux</em>
session. The <em>tmux</em> status line at the bottom of the screen shows
information on the current session. At this point, you have created one
<em>tmux</em> client that is attached to the session that was also
created. Clients and Sessions are separate entities, allowing you to
detach your client from the session and reattach it later. You can also
have several clients attached to the same session, and whatever you do
on one will be visible on the others. At first sessions and client could
be confused, but this exercise will help you understand the
concepts.</p>
<p>You are now on a <em>tmux</em> session. Open <em>nano</em> so you can
see the top bar and the two command bars on the bottom from the nano
session. Write a line like you were writing a text file. All commands
inside a session use a prefix key combination. The prefix combination is
<kbd>Ctrl</kbd>+<kbd>B</kbd>, also referred as <strong>C-b</strong>. You
have to press the <kbd>Ctrl</kbd> key, keep it pressed and press the
<kbd>B</kbd> key followed for any command for <em>tmux</em> to
interpret. The first command will detach a session from the client. Use
the combination <strong>C-b d</strong> to detach the current session
from the client. You will hit the <kbd>Ctrl</kbd> key, keep it pressed,
and press <kbd>B</kbd>, raise both keys, and press <kbd>D</kbd>. You
will see that the nano top and bottom bars disappear, the green
<em>tmux</em> bottom bar also disappears, and you return to your normal
terminal. You can go even further and close your terminal on your
computer to simulate a loss in internet connection. Reconnect again to
the cluster using SSH to return to the head node.</p>
<p>From the head node, we will reattach the session using:</p>
<pre><code>$ tmux a</code></pre>
<p>You will see your session recovering exactly the same as you left
when you detached, and nano should be there with the line that you
wrote. You have created your first <em>tmux</em> session and that
session will persist until you kill the session or the head node is
rebooted, something that happens rarely, usually one or two times per
year. For the most part, you can keep your <em>tmux</em> session
open</p>
<p>You can create several <em>tmux</em> sessions, each one with a given
name, using:</p>
<pre><code>$ tmux new -s &lt;session_name&gt;</code></pre>
<p>Having several sessions is useful if you want a distinctive
collection of windows for different projects, as they are more isolated
than windows on the same session. Changing between sessions is done with
<strong>C-b (</strong> and <strong>C-b )</strong> to move between the
previous and next session. Another way of moving between sessions is
using <strong>C-b w</strong> as we will see next, showing all the
windows across all sessions and allowing you to jump into windows from
different sessions.</p>
<p>Sessions have names, and those names can be changed with <strong>C-b
$</strong></p>
</section><section><h2 class="section-heading" id="windows-and-panes">Windows and Panes<a class="anchor" aria-label="anchor" href="#windows-and-panes"></a>
</h2>
<hr class="half-width">
<p>The next concepts on <em>tmux</em> are windows and panes. A
<em>tmux</em> window is the area that fills the entire space offered by
your local terminal emulator. Windows has the same purpose as
<em>tabs</em> on a browser. When you create your first <em>tmux</em>
session, you also create a single window. <em>tmux</em> windows can be
further divided in what <em>tmux</em> calls panes. You can divide a
single <em>tmux</em> window in multiple panes and you can have several
<em>tmux</em> windows on a single <em>tmux</em> session. As we will see
in a moment, you can have several <em>tmux</em> sessions attached to
<em>tmux</em> clients or detached from them. Each session can hold
several <em>tmux</em> windows and each window will have one or more
<em>tmux</em> panes. On each of those panes, you will have a shell
waiting for your commands. At the end <em>tmux</em> is the equivalent of
a window manager in the world of terminals, with the ability to attach
and detach at will and running commands concurrently.</p>
<p>In case you are not already attached to the <em>tmux</em> session,
enter into the <em>tmux</em> session with:</p>
<pre><code>$ tmux a</code></pre>
<p>You have one window with one pane inside that fills the entire space.
You can create new <em>tmux</em> windows with <strong>C-b c</strong>.
Start creating a few of them. Each new window will appear in the bottom
<em>tmux</em> bar. The first ten are identified with a number from a
digit number from 0 to 9.</p>
<p>Moving between windows is done using the number associated on the
bottom bar of <em>tmux</em>, to move to the first window (with number 0)
use <strong>C-b 0</strong>, similarly for all the first 10 windows. You
can create more windows beyond the first 10, but only for those you can
jump into them using the <strong>C-b <win no></win></strong> combination.
Another way of moving between the previous and next window. Use
<strong>C-b p</strong> and <strong>C-b n</strong> for the previous and
next respectively. You can change the number of a window using
<strong>C-b .</strong></p>
<p>Notice that windows receive names shown on the bottom bar in
<em>tmux</em>. You can change the name of the window using <strong>C-b
,</strong>. This is useful for generating windows with consistent names
for tasks or projects related to the window. You can also use the
different windows connected to different machines so the label could be
useful to identify which machine you are connected to at a given
window.</p>
<p>You can kill the current window with <strong>C-b &amp;</strong> and
see all the windows across all sessions with <strong>C-b w</strong>.
This is another way of moving between windows in different sessions.</p>
<p>The last division in the hierarchy is panes. Panes create new
terminals by dividing the window horizontally or vertically. You can
create new panes using <strong>C-b %</strong> for vertical division or
<strong>C-b “</strong> for horizontal division.</p>
<p>You can move between panes with <strong>C-b o</strong> or use the
arrows to go to the panes in the direction of the arrow, such as
<strong>C-b <left arrow></left></strong></p>
<p>One easy way of organizing the panes is using the predefined layouts,
and <strong>C-b SPACE</strong> will cycle between them. Panes can be
swapped with <strong>C-b {</strong> and <strong>C-b }</strong>. You can
zoom into the current pane to take the whole window using <strong>C-b
z</strong> and execute the same command to return to the previous
layout.</p>
</section><section><h2 class="section-heading" id="copy-mode">Copy mode<a class="anchor" aria-label="anchor" href="#copy-mode"></a>
</h2>
<hr class="half-width">
<p>All the commands above are related to the movement and creation of
sessions, windows, and panes. Inside a pane, you can enter Copy mode if
you want to scroll the lines on the pane or copy and paste lines. The
procedure to use copy mode is as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Press <strong>C-b [</strong> to enter in copy mode.</p></li>
<li><p>Move the start/end of text to highlight.</p></li>
<li><p>Press <strong>C-SPACEBAR</strong> to start selection</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">Start</span> highlighting text. Selected text changes the color and background, so you<span class="st">'ll know if the command worked.</span></span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal">
<li><p>Move to the opposite end of the text to copy.</p></li>
<li><p>Press <strong>ALT-w</strong> to copy selected text into
<em>tmux</em> clipboard.</p></li>
<li><p>Move cursor to opposite <em>tmux</em> pane, or completely
different <em>tmux</em> window. Put the cursor where you want to paste
the text you just copied.</p></li>
<li><p>Press <strong>C-b ]</strong> to paste copied text from
<em>tmux</em> clipboard.</p></li>
</ol>
<p>If you work from a Mac, the ALT key (In macOS called <em>option</em>)
will not work. One alternative is to use vi-copy mode:</p>
<ol style="list-style-type: decimal">
<li><p>Press <strong>C-b :</strong> and write: <strong>setw -g mode-keys
vi</strong></p></li>
<li><p>Now enter in copy mode with <strong>C-b [</strong></p></li>
<li><p>To start selecting the text, use
<strong>SPACEBAR</strong></p></li>
<li><p>Move to the opposite end of the text to copy</p></li>
<li><p>Copy the selection with <strong>ENTER</strong></p></li>
<li><p>Go to the window and pane you want to paste</p></li>
<li><p>Press <strong>C-b ]</strong> to paste copied text from
<em>tmux</em> clipboard.</p></li>
</ol></section><section><h2 class="section-heading" id="final-remarks">Final remarks<a class="anchor" aria-label="anchor" href="#final-remarks"></a>
</h2>
<hr class="half-width">
<p><strong>tmux</strong> is far more than the few commands shown here.
There are many ways to personalize the environment. Some
personalizations involve editing the file $HOME/.tmux.conf</p>
<p>Consider for example, this <strong>.tmux.conf</strong> that changes
several colors in the <em>tmux</em> status bar.</p>
<pre><code>######################
### DESIGN CHANGES ###
######################

# loud or quiet?
set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
setw -g monitor-activity off
set -g bell-action none

#  modes
setw -g clock-mode-colour colour5
setw -g mode-style 'fg=colour1 bg=colour18 bold'

# panes
set -g pane-border-style 'fg=colour19 bg=colour0'
set -g pane-active-border-style 'bg=colour0 fg=colour9'

# statusbar
set -g status-position bottom
set -g status-justify left
set -g status-style 'bg=colour18 fg=colour137 dim'
set -g status-left ''
set -g status-right '#[fg=colour233,bg=colour19] %d/%m #[fg=colour233,bg=colour8] %H:%M:%S '
set -g status-right-length 50
set -g status-left-length 20

setw -g window-status-current-style 'fg=colour1 bg=colour19 bold'
setw -g window-status-current-format ' #I#[fg=colour249]:#[fg=colour255]#W#[fg=colour249]#F '

setw -g window-status-style 'fg=colour9 bg=colour18'
setw -g window-status-format ' #I#[fg=colour237]:#[fg=colour250]#W#[fg=colour244]#F '

setw -g window-status-bell-style 'fg=colour255 bg=colour1 bold'

# messages
set -g message-style 'fg=colour232 bg=colour16 bold'</code></pre>
<p>There are a lot of things that can be changed to everyone’s taste.
There are several <strong>.tmux.conf</strong> files shared on GitHub and
other repositories that customize <code>tmux</code> in several ways.</p>
<blockquote>
<h2 id="exercise-tmux-sessions-windows-and-panes">Exercise: TMUX
Sessions, Windows and Panes</h2>
<p>This exercise will help you familiarize yourself with the three
concepts in TMUX.</p>
<ol style="list-style-type: decimal">
<li><p>Create three sessions on TMUX, and give each of them different
names, either creating the session with the name or using <strong>C-b
$</strong> to rename session names.</p></li>
<li><p>In one of those sessions, create two windows, and in the other,
create three windows. Move between sessions to accomplish this.</p></li>
<li><p>In one of those windows, split the window vertically, on another
horizontally, and on the third one create 3 panes and cycle between the
different layouts using <strong>C-b SPACE</strong></p></li>
<li><p>Detach or close your terminal and reconnect, attach your
sessions, and verify that your windows and panes remain the
same.</p></li>
</ol>
<p>{: .source} {: .challenge}</p>
</blockquote>
<blockquote>
<h2 id="exercise-using-tmux">Exercise: Using tmux</h2>
<p>Using the tables above, follow this simple challenge with tmux</p>
<ol style="list-style-type: decimal">
<li><p>Log in to Thorny Flat and create a <code>tmux</code>
session</p></li>
<li><p>Inside the session, create a new window</p></li>
<li><p>Go back to window 0 and create a horizontal pane, and inside one
of those panes, create a vertical pane.</p></li>
<li><p>Create a big clock pane</p></li>
<li><p>Detach from your current session, close your terminal, and
reconnect. Log in again on Thorny Flat and reattach your
session.</p></li>
<li><p>Now that you are again in your original session create a new
session. You will be automatically redirected there. Leave your session
and check the list of sessions.</p></li>
<li><p>Kill the second session (session ID is 1)</p></li>
</ol>
<p>{: .source} {: .challenge}</p>
</blockquote>
</section><section><h2 class="section-heading" id="reference-of-tmux-commands">Reference of <em>tmux</em> commands<a class="anchor" aria-label="anchor" href="#reference-of-tmux-commands"></a>
</h2>
<hr class="half-width">
<p>In tmux, by default, the prefix is <kbd>Ctrl</kbd>+<kbd>b</kbd>. Use
the prefix followed by one of the options below:</p>
<div class="section level3">
<h3 id="sessions">Sessions<a class="anchor" aria-label="anchor" href="#sessions"></a>
</h3>
<pre><code>    :new&lt;CR&gt;  new session
    s  list sessions
    $  name session</code></pre>
<p>{: .source}</p>
</div>
<div class="section level3">
<h3 id="windows-tabs">Windows (tabs)<a class="anchor" aria-label="anchor" href="#windows-tabs"></a>
</h3>
<pre><code>    c  create window
    w  list windows
    n  next window
    p  previous window
    f  find window
    ,  name window
    &amp;  kill window</code></pre>
<p>{: .source}</p>
</div>
<div class="section level3">
<h3 id="panes-splits">Panes (splits)<a class="anchor" aria-label="anchor" href="#panes-splits"></a>
</h3>
<pre><code>    %  vertical split
    "  horizontal split
    o  swap panes
    q  show pane numbers
    x  kill pane
    +  break pane into window (e.g. to select text by mouse to copy)
    -  restore pane from window
    ⍽  space - toggle between layouts
    q (Show pane numbers, when the numbers show up type the key to goto that pane)
    { (Move the current pane left)
    } (Move the current pane right)
    z toggle pane zoom</code></pre>
<p>{: .source}</p>
</div>
<div class="section level3">
<h3 id="copy-model">Copy model<a class="anchor" aria-label="anchor" href="#copy-model"></a>
</h3>
<pre><code>    [  Copy mode</code></pre>
<p>{: .source}</p>
<p>In copy mode, use these commands to copy a region to the
<em>tmux</em> clipboard.</p>
<pre><code>    Ctrl SPACE  Start Selection
    Alt w       Copy the selection to the clipboard</code></pre>
<p>{: .source}</p>
<p>After this use the command to paste</p>
<pre><code>    ]  Paste from clipboard</code></pre>
<p>{: .source}</p>
</div>
<div class="section level3">
<h3 id="others">Others<a class="anchor" aria-label="anchor" href="#others"></a>
</h3>
<pre><code>    d  detach
    t  big clock
    ?  list shortcuts
    :  prompt</code></pre>
<p>{: .source}</p>
</div>
<div class="section level3">
<h3 id="command-line-arguments-for-tmux">Command line arguments for tmux<a class="anchor" aria-label="anchor" href="#command-line-arguments-for-tmux"></a>
</h3>
<pre><code>    tmux ls                       list sessions
    tmux new                      new session
    tmux rename -t &lt;ID&gt; new_name  rename a session
    tmux kill-session -t &lt;ID&gt;     kill session by target</code></pre>
<p>{: .source}</p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“tmux allows you to keep terminal sessions on the cluster that
persist in case of network disconnection.”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Learn about Sessions, Windows and Panes”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries/workbench-template-md/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries/workbench-template-md/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries/workbench-template-md/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-md/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:gufranco@mail.wvu.edu">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.17.1" class="external-link">sandpaper (0.17.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.7" class="external-link">varnish (1.0.7)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://carpentries.github.io/workbench-template-md/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, hpc",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-md/aio.html",
  "identifier": "https://carpentries.github.io/workbench-template-md/aio.html",
  "dateCreated": "2025-08-13",
  "dateModified": "2025-08-13",
  "datePublished": "2025-08-13"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

